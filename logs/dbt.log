

============================== 2023-05-25 07:41:36.008862 | a1f004f6-9519-47fa-a2a6-4f2ea00d8a96 ==============================
[0m07:41:36.008862 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:41:36.008862 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:41:36.008862 [debug] [MainThread]: Tracking: tracking
[0m07:41:36.025147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F49A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F88EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F91C350>]}
[0m07:41:36.053116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F9507D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F950810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1F950850>]}
[0m07:41:36.053116 [debug] [MainThread]: Flushing usage events
[0m07:41:37.235725 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ROLE_ARN'


============================== 2023-05-25 07:42:31.576138 | 07dadc08-f3d5-4149-b715-94551bcde45a ==============================
[0m07:42:31.576138 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:42:31.576138 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:42:31.576138 [debug] [MainThread]: Tracking: tracking
[0m07:42:31.595312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C0329D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C5CB250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C335310>]}
[0m07:42:31.835070 [debug] [MainThread]: Executing "git --help"
[0m07:42:31.886278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:42:31.886278 [debug] [MainThread]: STDERR: "b''"
[0m07:42:31.902281 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m07:42:31.902281 [debug] [MainThread]: Using glue connection "debug"
[0m07:42:31.902281 [debug] [MainThread]: On debug: select 1 as id
[0m07:42:31.902281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:31.902281 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:42:31.902281 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m07:42:31.902281 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m07:42:34.142707 [error] [MainThread]: Glue adapter: Got an error when attempting to open a GlueSession : Unable to locate credentials
[0m07:42:34.142707 [error] [MainThread]: Glue adapter: Got an error when attempting to open a GlueSession : Database Error
  Unable to locate credentials
[0m07:42:34.142707 [debug] [MainThread]: Glue adapter: Unhandled error while running:
select 1 as id
[0m07:42:34.150663 [debug] [MainThread]: On debug: No close available on handle
[0m07:42:34.154493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1C7C4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1D7E52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1D27A210>]}
[0m07:42:34.154493 [debug] [MainThread]: Flushing usage events
[0m07:42:35.326248 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 07:49:27.618410 | 3f631b0a-8f35-43b5-971a-2c116b460e73 ==============================
[0m07:49:27.618410 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:49:27.618410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:49:27.618410 [debug] [MainThread]: Tracking: tracking
[0m07:49:27.650370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEAE7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEA6A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEA6B8D0>]}
[0m07:49:27.908706 [debug] [MainThread]: Executing "git --help"
[0m07:49:27.989239 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:49:27.989239 [debug] [MainThread]: STDERR: "b''"
[0m07:49:28.020678 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m07:49:28.020678 [debug] [MainThread]: Using glue connection "debug"
[0m07:49:28.020678 [debug] [MainThread]: On debug: select 1 as id
[0m07:49:28.020678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:49:28.020678 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:49:28.020678 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m07:49:28.020678 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m07:49:56.145032 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:49:56.145032 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-ab54be00-9ca6-44cc-9907-04d580db1471
[0m07:50:06.125478 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m07:50:06.125478 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m07:50:06.125478 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m07:50:06.138552 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:50:06.138902 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m07:50:13.832312 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685001006072, 'CompletedOn': 1685001012374}, 'ResponseMetadata': {'RequestId': 'a44ca950-75ed-426a-afd2-d6e5efdf221e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 07:50:13 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'a44ca950-75ed-426a-afd2-d6e5efdf221e'}, 'RetryAttempts': 0}}
[0m07:50:13.832312 [debug] [MainThread]: Glue adapter: status = ok
[0m07:50:13.832312 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m07:50:13.832312 [debug] [MainThread]: SQL status: OK in 46 seconds
[0m07:50:13.832312 [debug] [MainThread]: On debug: Close
[0m07:50:13.832312 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:50:13.832312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEA4F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACE98B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEA3FF10>]}
[0m07:50:13.832312 [debug] [MainThread]: Flushing usage events
[0m07:50:14.896615 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 07:50:51.439007 | c2b98cf4-0394-4006-9e18-6c240bdaaff1 ==============================
[0m07:50:51.439007 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:50:51.439007 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:50:51.439007 [debug] [MainThread]: Tracking: tracking
[0m07:50:51.456008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1A110510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A19FBA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A19E1FDD0>]}
[0m07:50:51.479360 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m07:50:51.487456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:50:51.487456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1A617250>]}
[0m07:50:53.127547 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m07:50:53.138072 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m07:50:53.227992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1A638A50>]}
[0m07:50:53.238990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1AD6B450>]}
[0m07:50:53.238990 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:50:53.240402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1ACB7210>]}
[0m07:50:53.242000 [info ] [MainThread]: 
[0m07:50:53.242000 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:50:53.248823 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m07:50:53.250353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:53.250353 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:50:53.251569 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m07:50:53.251569 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m07:51:11.178895 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:51:11.178895 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:18.329146 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:51:19.628104 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:51:19.636183 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:51:19.637498 [debug] [ThreadPool]: Acquiring new glue connection 'create_poc_curated_dbt_poc_curated_dbt'
[0m07:51:19.637498 [debug] [ThreadPool]: Acquiring new glue connection 'create_poc_curated_dbt_poc_curated_dbt'
[0m07:51:19.637498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:19.637498 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:51:20.737457 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:51:20.738700 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:51:20.738980 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:22.196561 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:51:23.313321 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:51:28.023846 [debug] [ThreadPool]: On create_poc_curated_dbt_poc_curated_dbt: Close
[0m07:51:28.023846 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:51:28.023846 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:51:28.023846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:28.023846 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:51:29.511526 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:51:29.511526 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:51:29.511526 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:30.942505 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:51:32.227910 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:51:32.227910 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:51:32.232929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A199271D0>]}
[0m07:51:32.235851 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:51:32.235851 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:51:32.237712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:32.237712 [info ] [MainThread]: 
[0m07:51:32.311847 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:51:32.311847 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:51:32.311847 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:51:32.311847 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:51:32.317915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:51:32.323186 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 07:51:32.317562 => 2023-05-25 07:51:32.322521
[0m07:51:32.323186 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:51:32.329210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:51:32.329210 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m07:51:33.428135 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m07:51:33.428135 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m07:51:33.428135 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:34.844075 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:36.220107 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:51:36.244193 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:36.260240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m07:51:36.260240 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:51:36.260240 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:51:36.260240 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  ''')
[0m07:51:38.292649 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name \nfrom organizations a \ninner join \nmemberships b \non a.id=b.organization_id \ninner join \npersons c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 8, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: organizations; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias a\n         :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  +- 'SubqueryAlias b\n         :     +- 'UnresolvedRelation [memberships], [], false\n         +- 'SubqueryAlias c\n            +- 'UnresolvedRelation [persons], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: organizations; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias a\n         :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  +- 'SubqueryAlias b\n         :     +- 'UnresolvedRelation [memberships], [], false\n         +- 'SubqueryAlias c\n            +- 'UnresolvedRelation [persons], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685001096180, 'CompletedOn': 1685001097565}, 'ResponseMetadata': {'RequestId': '11fd632b-0bbd-4556-be77-f19cccc147b1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 07:51:37 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2770', 'connection': 'keep-alive', 'x-amzn-requestid': '11fd632b-0bbd-4556-be77-f19cccc147b1'}, 'RetryAttempts': 0}}
[0m07:51:38.308259 [debug] [Thread-1 (]: Glue adapter: status = error
[0m07:51:38.309767 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
      +- 'Join Inner, ('b.person_id = 'c.id)
         :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :- 'SubqueryAlias a
         :  :  +- 'UnresolvedRelation [organizations], [], false
         :  +- 'SubqueryAlias b
         :     +- 'UnresolvedRelation [memberships], [], false
         +- 'SubqueryAlias c
            +- 'UnresolvedRelation [persons], [], false

[0m07:51:38.309767 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
      +- 'Join Inner, ('b.person_id = 'c.id)
         :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :- 'SubqueryAlias a
         :  :  +- 'UnresolvedRelation [organizations], [], false
         :  +- 'SubqueryAlias b
         :     +- 'UnresolvedRelation [memberships], [], false
         +- 'SubqueryAlias c
            +- 'UnresolvedRelation [persons], [], false

[0m07:51:38.309767 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  
[0m07:51:38.314715 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:51:38.314715 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m07:51:38.314715 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:51:38.314715 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m07:51:38.318234 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 07:51:32.323186 => 2023-05-25 07:51:38.318234
[0m07:51:38.393432 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name 
  from organizations a 
  inner join 
  memberships b 
  on a.id=b.organization_id 
  inner join 
  persons c 
  on b.person_id = c.id
    '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Distinct
     +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
        +- 'Join Inner, ('b.person_id = 'c.id)
           :- 'Join Inner, ('a.id = 'b.organization_id)
           :  :- 'SubqueryAlias a
           :  :  +- 'UnresolvedRelation [organizations], [], false
           :  +- 'SubqueryAlias b
           :     +- 'UnresolvedRelation [memberships], [], false
           +- 'SubqueryAlias c
              +- 'UnresolvedRelation [persons], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:51:38.394496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1A12A590>]}
[0m07:51:38.394496 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.08s]
[0m07:51:38.397184 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:51:38.397184 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m07:51:38.397184 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m07:51:38.397184 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m07:51:38.397184 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m07:51:38.402393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m07:51:38.402393 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 07:51:38.397184 => 2023-05-25 07:51:38.402393
[0m07:51:38.402393 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m07:51:38.407538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:38.410064 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m07:51:39.678127 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m07:51:39.678127 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m07:51:39.694290 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:41.360448 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:42.636393 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:42.649335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m07:51:42.649335 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m07:51:42.649335 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
inner join 
events d
on b.organization_id = d.organization_id
  
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:51:42.649335 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
inner join 
events d
on b.organization_id = d.organization_id
  ''')
[0m07:51:44.709911 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name,\nd.name event_name\nfrom organizations a \ninner join \nmemberships b \non a.id=b.organization_id \ninner join \npersons c \non b.person_id = c.id\ninner join \nevents d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 11, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: organizations; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias a\n         :  :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  :  +- 'SubqueryAlias b\n         :  :     +- 'UnresolvedRelation [memberships], [], false\n         :  +- 'SubqueryAlias c\n         :     +- 'UnresolvedRelation [persons], [], false\n         +- 'SubqueryAlias d\n            +- 'UnresolvedRelation [events], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: organizations; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias a\n         :  :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  :  +- 'SubqueryAlias b\n         :  :     +- 'UnresolvedRelation [memberships], [], false\n         :  +- 'SubqueryAlias c\n         :     +- 'UnresolvedRelation [persons], [], false\n         +- 'SubqueryAlias d\n            +- 'UnresolvedRelation [events], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685001102570, 'CompletedOn': 1685001104005}, 'ResponseMetadata': {'RequestId': '618f88b5-b012-46b7-95de-93cc5576905c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 07:51:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3286', 'connection': 'keep-alive', 'x-amzn-requestid': '618f88b5-b012-46b7-95de-93cc5576905c'}, 'RetryAttempts': 0}}
[0m07:51:44.709911 [debug] [Thread-1 (]: Glue adapter: status = error
[0m07:51:44.709911 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
inner join 
events d
on b.organization_id = d.organization_id
  '''), AnalysisException: Table or view not found: organizations; line 19 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]
      +- 'Join Inner, ('b.organization_id = 'd.organization_id)
         :- 'Join Inner, ('b.person_id = 'c.id)
         :  :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :  :- 'SubqueryAlias a
         :  :  :  +- 'UnresolvedRelation [organizations], [], false
         :  :  +- 'SubqueryAlias b
         :  :     +- 'UnresolvedRelation [memberships], [], false
         :  +- 'SubqueryAlias c
         :     +- 'UnresolvedRelation [persons], [], false
         +- 'SubqueryAlias d
            +- 'UnresolvedRelation [events], [], false

[0m07:51:44.715797 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
inner join 
events d
on b.organization_id = d.organization_id
  '''), AnalysisException: Table or view not found: organizations; line 19 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]
      +- 'Join Inner, ('b.organization_id = 'd.organization_id)
         :- 'Join Inner, ('b.person_id = 'c.id)
         :  :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :  :- 'SubqueryAlias a
         :  :  :  +- 'UnresolvedRelation [organizations], [], false
         :  :  +- 'SubqueryAlias b
         :  :     +- 'UnresolvedRelation [memberships], [], false
         :  +- 'SubqueryAlias c
         :     +- 'UnresolvedRelation [persons], [], false
         +- 'SubqueryAlias d
            +- 'UnresolvedRelation [events], [], false

[0m07:51:44.715797 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
inner join 
events d
on b.organization_id = d.organization_id
  
[0m07:51:44.719922 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m07:51:44.719922 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m07:51:44.721958 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m07:51:44.723450 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m07:51:44.723450 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 07:51:38.407538 => 2023-05-25 07:51:44.723450
[0m07:51:44.726803 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name,
  d.name event_name
  from organizations a 
  inner join 
  memberships b 
  on a.id=b.organization_id 
  inner join 
  persons c 
  on b.person_id = c.id
  inner join 
  events d
  on b.organization_id = d.organization_id
    '''), AnalysisException: Table or view not found: organizations; line 19 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists
  +- 'Distinct
     +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]
        +- 'Join Inner, ('b.organization_id = 'd.organization_id)
           :- 'Join Inner, ('b.person_id = 'c.id)
           :  :- 'Join Inner, ('a.id = 'b.organization_id)
           :  :  :- 'SubqueryAlias a
           :  :  :  +- 'UnresolvedRelation [organizations], [], false
           :  :  +- 'SubqueryAlias b
           :  :     +- 'UnresolvedRelation [memberships], [], false
           :  +- 'SubqueryAlias c
           :     +- 'UnresolvedRelation [persons], [], false
           +- 'SubqueryAlias d
              +- 'UnresolvedRelation [events], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m07:51:44.726803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b98cf4-0394-4006-9e18-6c240bdaaff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C9B4AD0>]}
[0m07:51:44.732063 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 6.33s]
[0m07:51:44.732288 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m07:51:44.734852 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:51:44.734852 [debug] [MainThread]: On master: ROLLBACK
[0m07:51:44.734852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:44.737703 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:51:45.856162 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:51:45.856162 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:51:45.856162 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-83068ae6-cc25-4350-87cb-662e22b7309e
[0m07:51:47.478443 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:51:47.478443 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:51:47.478443 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:51:47.478443 [debug] [MainThread]: On master: ROLLBACK
[0m07:51:47.478443 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:51:47.478443 [debug] [MainThread]: On master: Close
[0m07:51:47.478443 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:51:47.493743 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:51:47.980491 [info ] [MainThread]: 
[0m07:51:47.980491 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 54.74 seconds (54.74s).
[0m07:51:47.980491 [debug] [MainThread]: Command end result
[0m07:51:48.003449 [info ] [MainThread]: 
[0m07:51:48.003945 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:51:48.003945 [info ] [MainThread]: 
[0m07:51:48.003945 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:51:48.003945 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:51:48.012364 [error] [MainThread]:   
[0m07:51:48.012364 [error] [MainThread]:     
[0m07:51:48.014266 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:51:48.014266 [error] [MainThread]:     using PARQUET
[0m07:51:48.014266 [error] [MainThread]:   	
[0m07:51:48.014266 [error] [MainThread]:   	
[0m07:51:48.014266 [error] [MainThread]:   	
[0m07:51:48.014266 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m07:51:48.014266 [error] [MainThread]:   	
[0m07:51:48.014266 [error] [MainThread]:   	as
[0m07:51:48.014266 [error] [MainThread]:   	select 
[0m07:51:48.014266 [error] [MainThread]:   distinct 
[0m07:51:48.024697 [error] [MainThread]:   a.name organization_name, 
[0m07:51:48.024697 [error] [MainThread]:   a.type organization_type, 
[0m07:51:48.031636 [error] [MainThread]:   b.role role, 
[0m07:51:48.032729 [error] [MainThread]:   c.name person_name 
[0m07:51:48.032729 [error] [MainThread]:   from organizations a 
[0m07:51:48.032729 [error] [MainThread]:   inner join 
[0m07:51:48.032729 [error] [MainThread]:   memberships b 
[0m07:51:48.032729 [error] [MainThread]:   on a.id=b.organization_id 
[0m07:51:48.037706 [error] [MainThread]:   inner join 
[0m07:51:48.037706 [error] [MainThread]:   persons c 
[0m07:51:48.039466 [error] [MainThread]:   on b.person_id = c.id
[0m07:51:48.039959 [error] [MainThread]:     '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
[0m07:51:48.039959 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:51:48.047706 [error] [MainThread]:   +- 'Distinct
[0m07:51:48.047706 [error] [MainThread]:      +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
[0m07:51:48.050031 [error] [MainThread]:         +- 'Join Inner, ('b.person_id = 'c.id)
[0m07:51:48.050031 [error] [MainThread]:            :- 'Join Inner, ('a.id = 'b.organization_id)
[0m07:51:48.050031 [error] [MainThread]:            :  :- 'SubqueryAlias a
[0m07:51:48.050031 [error] [MainThread]:            :  :  +- 'UnresolvedRelation [organizations], [], false
[0m07:51:48.050031 [error] [MainThread]:            :  +- 'SubqueryAlias b
[0m07:51:48.050031 [error] [MainThread]:            :     +- 'UnresolvedRelation [memberships], [], false
[0m07:51:48.050031 [error] [MainThread]:            +- 'SubqueryAlias c
[0m07:51:48.050031 [error] [MainThread]:               +- 'UnresolvedRelation [persons], [], false
[0m07:51:48.058597 [error] [MainThread]:   
[0m07:51:48.058597 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:51:48.063351 [info ] [MainThread]: 
[0m07:51:48.063351 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m07:51:48.066307 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m07:51:48.066307 [error] [MainThread]:   
[0m07:51:48.068367 [error] [MainThread]:     
[0m07:51:48.068367 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m07:51:48.068367 [error] [MainThread]:     using PARQUET
[0m07:51:48.068367 [error] [MainThread]:   	
[0m07:51:48.072078 [error] [MainThread]:   	
[0m07:51:48.072078 [error] [MainThread]:   	
[0m07:51:48.074199 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m07:51:48.074199 [error] [MainThread]:   	
[0m07:51:48.074199 [error] [MainThread]:   	as
[0m07:51:48.080917 [error] [MainThread]:   	select 
[0m07:51:48.080917 [error] [MainThread]:   distinct 
[0m07:51:48.080917 [error] [MainThread]:   a.name organization_name, 
[0m07:51:48.080917 [error] [MainThread]:   a.type organization_type, 
[0m07:51:48.080917 [error] [MainThread]:   b.role role, 
[0m07:51:48.080917 [error] [MainThread]:   c.name person_name,
[0m07:51:48.080917 [error] [MainThread]:   d.name event_name
[0m07:51:48.080917 [error] [MainThread]:   from organizations a 
[0m07:51:48.080917 [error] [MainThread]:   inner join 
[0m07:51:48.080917 [error] [MainThread]:   memberships b 
[0m07:51:48.080917 [error] [MainThread]:   on a.id=b.organization_id 
[0m07:51:48.092810 [error] [MainThread]:   inner join 
[0m07:51:48.092810 [error] [MainThread]:   persons c 
[0m07:51:48.092810 [error] [MainThread]:   on b.person_id = c.id
[0m07:51:48.092810 [error] [MainThread]:   inner join 
[0m07:51:48.092810 [error] [MainThread]:   events d
[0m07:51:48.092810 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m07:51:48.092810 [error] [MainThread]:     '''), AnalysisException: Table or view not found: organizations; line 19 pos 5;
[0m07:51:48.092810 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists
[0m07:51:48.092810 [error] [MainThread]:   +- 'Distinct
[0m07:51:48.109008 [error] [MainThread]:      +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]
[0m07:51:48.109008 [error] [MainThread]:         +- 'Join Inner, ('b.organization_id = 'd.organization_id)
[0m07:51:48.109008 [error] [MainThread]:            :- 'Join Inner, ('b.person_id = 'c.id)
[0m07:51:48.109008 [error] [MainThread]:            :  :- 'Join Inner, ('a.id = 'b.organization_id)
[0m07:51:48.109008 [error] [MainThread]:            :  :  :- 'SubqueryAlias a
[0m07:51:48.109008 [error] [MainThread]:            :  :  :  +- 'UnresolvedRelation [organizations], [], false
[0m07:51:48.109008 [error] [MainThread]:            :  :  +- 'SubqueryAlias b
[0m07:51:48.109008 [error] [MainThread]:            :  :     +- 'UnresolvedRelation [memberships], [], false
[0m07:51:48.109008 [error] [MainThread]:            :  +- 'SubqueryAlias c
[0m07:51:48.109008 [error] [MainThread]:            :     +- 'UnresolvedRelation [persons], [], false
[0m07:51:48.125550 [error] [MainThread]:            +- 'SubqueryAlias d
[0m07:51:48.125550 [error] [MainThread]:               +- 'UnresolvedRelation [events], [], false
[0m07:51:48.125550 [error] [MainThread]:   
[0m07:51:48.133024 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m07:51:48.133024 [info ] [MainThread]: 
[0m07:51:48.133024 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m07:51:48.133024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B8F3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B964C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1AD696D0>]}
[0m07:51:48.133024 [debug] [MainThread]: Flushing usage events
[0m07:51:49.316455 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:03:56.870392 | 1f824c64-5d0e-468f-b00f-b04a39e0795e ==============================
[0m08:03:56.870392 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:03:56.870392 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:03:56.870392 [debug] [MainThread]: Tracking: tracking
[0m08:03:56.901499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2CF17DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2D42CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2CF177D0>]}
[0m08:03:56.927283 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:03:57.820931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:03:57.820931 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test_event.sql
[0m08:03:57.836948 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m08:03:57.860499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2DA5FF10>]}
[0m08:03:57.882773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2DB58F50>]}
[0m08:03:57.882773 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:03:57.882773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2DA18810>]}
[0m08:03:57.882773 [info ] [MainThread]: 
[0m08:03:57.889277 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:03:57.894426 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m08:03:57.894426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:57.895879 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:03:57.896286 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m08:03:57.896286 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m08:04:16.040107 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:04:16.040107 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a2c11ed-24f8-4a38-a0d7-6eeaad232b94
[0m08:04:24.725303 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:04:26.059058 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m08:04:26.059058 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:04:26.064025 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m08:04:26.064025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:26.064025 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:04:27.276238 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m08:04:27.276238 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:04:27.287644 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a2c11ed-24f8-4a38-a0d7-6eeaad232b94
[0m08:04:28.763150 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:04:30.141048 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m08:04:30.141048 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:04:30.155060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2DBF4DD0>]}
[0m08:04:30.158543 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:04:30.158543 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:04:30.162051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:30.162051 [info ] [MainThread]: 
[0m08:04:30.188127 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m08:04:30.188127 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m08:04:30.188127 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m08:04:30.188127 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m08:04:30.192655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m08:04:30.195833 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 08:04:30.190983 => 2023-05-25 08:04:30.195833
[0m08:04:30.198658 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m08:04:30.209212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:04:30.209212 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:04:31.603190 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:04:31.610025 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:04:31.612801 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a2c11ed-24f8-4a38-a0d7-6eeaad232b94
[0m08:04:33.151512 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:34.357442 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m08:04:34.384643 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:34.384643 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m08:04:34.396322 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:04:34.396828 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m08:04:34.396828 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  
[0m08:04:34.396828 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:34.396828 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:04:34.398560 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:04:34.398777 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:04:34.398982 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  ''')
[0m08:04:36.635612 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name \nfrom organizations a \ninner join \nmemberships b \non a.id=b.organization_id \ninner join \npersons c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: organizations; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias a\n         :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  +- 'SubqueryAlias b\n         :     +- 'UnresolvedRelation [memberships], [], false\n         +- 'SubqueryAlias c\n            +- 'UnresolvedRelation [persons], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: organizations; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias a\n         :  :  +- 'UnresolvedRelation [organizations], [], false\n         :  +- 'SubqueryAlias b\n         :     +- 'UnresolvedRelation [memberships], [], false\n         +- 'SubqueryAlias c\n            +- 'UnresolvedRelation [persons], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685001874335, 'CompletedOn': 1685001875704}, 'ResponseMetadata': {'RequestId': '9aab4b8d-b327-4244-aa6a-4f45473c5f16', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:04:36 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2770', 'connection': 'keep-alive', 'x-amzn-requestid': '9aab4b8d-b327-4244-aa6a-4f45473c5f16'}, 'RetryAttempts': 0}}
[0m08:04:36.635612 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:04:36.642854 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
      +- 'Join Inner, ('b.person_id = 'c.id)
         :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :- 'SubqueryAlias a
         :  :  +- 'UnresolvedRelation [organizations], [], false
         :  +- 'SubqueryAlias b
         :     +- 'UnresolvedRelation [memberships], [], false
         +- 'SubqueryAlias c
            +- 'UnresolvedRelation [persons], [], false

[0m08:04:36.642854 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Distinct
   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
      +- 'Join Inner, ('b.person_id = 'c.id)
         :- 'Join Inner, ('a.id = 'b.organization_id)
         :  :- 'SubqueryAlias a
         :  :  +- 'UnresolvedRelation [organizations], [], false
         :  +- 'SubqueryAlias b
         :     +- 'UnresolvedRelation [memberships], [], false
         +- 'SubqueryAlias c
            +- 'UnresolvedRelation [persons], [], false

[0m08:04:36.642854 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from organizations a 
inner join 
memberships b 
on a.id=b.organization_id 
inner join 
persons c 
on b.person_id = c.id
  
[0m08:04:36.642854 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m08:04:36.642854 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:04:36.642854 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m08:04:36.642854 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:04:36.642854 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 08:04:30.199156 => 2023-05-25 08:04:36.642854
[0m08:04:36.720466 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name 
  from organizations a 
  inner join 
  memberships b 
  on a.id=b.organization_id 
  inner join 
  persons c 
  on b.person_id = c.id
    '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Distinct
     +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
        +- 'Join Inner, ('b.person_id = 'c.id)
           :- 'Join Inner, ('a.id = 'b.organization_id)
           :  :- 'SubqueryAlias a
           :  :  +- 'UnresolvedRelation [organizations], [], false
           :  +- 'SubqueryAlias b
           :     +- 'UnresolvedRelation [memberships], [], false
           +- 'SubqueryAlias c
              +- 'UnresolvedRelation [persons], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:04:36.720466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2E596450>]}
[0m08:04:36.720466 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.53s]
[0m08:04:36.736335 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m08:04:36.736335 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m08:04:36.736335 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m08:04:36.736335 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m08:04:36.736335 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m08:04:36.736335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:04:36.736335 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 08:04:36.736335 => 2023-05-25 08:04:36.736335
[0m08:04:36.736335 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m08:04:36.736335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:36.736335 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:04:38.037054 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:04:38.037054 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:04:38.037054 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a2c11ed-24f8-4a38-a0d7-6eeaad232b94
[0m08:04:39.475931 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:40.709463 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m08:04:40.709463 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:40.709463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:04:40.709463 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:04:40.709463 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m08:04:40.709463 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  
[0m08:04:40.709463 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:04:40.722902 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:04:40.723375 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:04:40.723375 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:04:40.723375 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  ''')
[0m08:04:41.474169 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name,\nd.name event_name\nfrom poc-normalized-legislator.organizations  a \ninner join \npoc-normalized-legislator.memberships  b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events  d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name,\nd.name event_name\nfrom poc-normalized-legislator.organizations  a \n--------^^^\ninner join \npoc-normalized-legislator.memberships  b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events  d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name,\nd.name event_name\nfrom poc-normalized-legislator.organizations  a \n--------^^^\ninner join \npoc-normalized-legislator.memberships  b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events  d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685001880677, 'CompletedOn': 1685001880740}, 'ResponseMetadata': {'RequestId': '54a1d283-32c0-4499-8637-2c0b2b05d29d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:04:41 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3697', 'connection': 'keep-alive', 'x-amzn-requestid': '54a1d283-32c0-4499-8637-2c0b2b05d29d'}, 'RetryAttempts': 0}}
[0m08:04:41.474169 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:04:41.474169 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
--------^^^
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  

[0m08:04:41.477330 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
--------^^^
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  

[0m08:04:41.477330 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name,
d.name event_name
from poc-normalized-legislator.organizations  a 
inner join 
poc-normalized-legislator.memberships  b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events  d
on b.organization_id = d.organization_id
  
[0m08:04:41.477330 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m08:04:41.477330 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:04:41.477330 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m08:04:41.477330 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:04:41.477330 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 08:04:36.736335 => 2023-05-25 08:04:41.477330
[0m08:04:41.493237 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name,
  d.name event_name
  from poc-normalized-legislator.organizations  a 
  inner join 
  poc-normalized-legislator.memberships  b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events  d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name,
  d.name event_name
  from poc-normalized-legislator.organizations  a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships  b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events  d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:04:41.493237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f824c64-5d0e-468f-b00f-b04a39e0795e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2E195AD0>]}
[0m08:04:41.493237 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.76s]
[0m08:04:41.496352 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m08:04:41.496352 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:04:41.496352 [debug] [MainThread]: On master: ROLLBACK
[0m08:04:41.496352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:04:41.496352 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:04:42.669495 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m08:04:42.669495 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:04:42.669495 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a2c11ed-24f8-4a38-a0d7-6eeaad232b94
[0m08:04:44.318293 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:04:44.318293 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:04:44.332423 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:04:44.332423 [debug] [MainThread]: On master: ROLLBACK
[0m08:04:44.332423 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:04:44.332423 [debug] [MainThread]: On master: Close
[0m08:04:44.337748 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:04:44.337748 [debug] [MainThread]: Glue adapter: cleanup called
[0m08:04:44.890910 [info ] [MainThread]: 
[0m08:04:44.890910 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 47.00 seconds (47.00s).
[0m08:04:44.890910 [debug] [MainThread]: Command end result
[0m08:04:44.903297 [info ] [MainThread]: 
[0m08:04:44.903297 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:04:44.903297 [info ] [MainThread]: 
[0m08:04:44.919459 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m08:04:44.919459 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:04:44.919459 [error] [MainThread]:   
[0m08:04:44.925013 [error] [MainThread]:     
[0m08:04:44.925013 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m08:04:44.929016 [error] [MainThread]:     using PARQUET
[0m08:04:44.929016 [error] [MainThread]:   	
[0m08:04:44.929016 [error] [MainThread]:   	
[0m08:04:44.929016 [error] [MainThread]:   	
[0m08:04:44.933033 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:04:44.933033 [error] [MainThread]:   	
[0m08:04:44.933033 [error] [MainThread]:   	as
[0m08:04:44.933033 [error] [MainThread]:   	select 
[0m08:04:44.933033 [error] [MainThread]:   distinct 
[0m08:04:44.933033 [error] [MainThread]:   a.name organization_name, 
[0m08:04:44.939041 [error] [MainThread]:   a.type organization_type, 
[0m08:04:44.940044 [error] [MainThread]:   b.role role, 
[0m08:04:44.940044 [error] [MainThread]:   c.name person_name 
[0m08:04:44.940044 [error] [MainThread]:   from organizations a 
[0m08:04:44.940044 [error] [MainThread]:   inner join 
[0m08:04:44.940044 [error] [MainThread]:   memberships b 
[0m08:04:44.940044 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:04:44.951161 [error] [MainThread]:   inner join 
[0m08:04:44.951161 [error] [MainThread]:   persons c 
[0m08:04:44.954197 [error] [MainThread]:   on b.person_id = c.id
[0m08:04:44.954197 [error] [MainThread]:     '''), AnalysisException: Table or view not found: organizations; line 18 pos 5;
[0m08:04:44.957976 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m08:04:44.957976 [error] [MainThread]:   +- 'Distinct
[0m08:04:44.957976 [error] [MainThread]:      +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]
[0m08:04:44.957976 [error] [MainThread]:         +- 'Join Inner, ('b.person_id = 'c.id)
[0m08:04:44.957976 [error] [MainThread]:            :- 'Join Inner, ('a.id = 'b.organization_id)
[0m08:04:44.957976 [error] [MainThread]:            :  :- 'SubqueryAlias a
[0m08:04:44.957976 [error] [MainThread]:            :  :  +- 'UnresolvedRelation [organizations], [], false
[0m08:04:44.957976 [error] [MainThread]:            :  +- 'SubqueryAlias b
[0m08:04:44.957976 [error] [MainThread]:            :     +- 'UnresolvedRelation [memberships], [], false
[0m08:04:44.957976 [error] [MainThread]:            +- 'SubqueryAlias c
[0m08:04:44.957976 [error] [MainThread]:               +- 'UnresolvedRelation [persons], [], false
[0m08:04:44.974445 [error] [MainThread]:   
[0m08:04:44.974445 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:04:44.974445 [info ] [MainThread]: 
[0m08:04:44.974445 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m08:04:44.974445 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:04:44.986099 [error] [MainThread]:   
[0m08:04:44.986099 [error] [MainThread]:     
[0m08:04:44.986099 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:04:44.989455 [error] [MainThread]:     using PARQUET
[0m08:04:44.989951 [error] [MainThread]:   	
[0m08:04:44.989951 [error] [MainThread]:   	
[0m08:04:44.997469 [error] [MainThread]:   	
[0m08:04:44.997469 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:04:44.997469 [error] [MainThread]:   	
[0m08:04:44.997469 [error] [MainThread]:   	as
[0m08:04:44.997469 [error] [MainThread]:   	select 
[0m08:04:44.997469 [error] [MainThread]:   distinct 
[0m08:04:44.997469 [error] [MainThread]:   a.name organization_name, 
[0m08:04:44.997469 [error] [MainThread]:   a.type organization_type, 
[0m08:04:45.006145 [error] [MainThread]:   b.role role, 
[0m08:04:45.006145 [error] [MainThread]:   c.name person_name,
[0m08:04:45.006145 [error] [MainThread]:   d.name event_name
[0m08:04:45.006145 [error] [MainThread]:   from poc-normalized-legislator.organizations  a 
[0m08:04:45.006145 [error] [MainThread]:   inner join 
[0m08:04:45.006145 [error] [MainThread]:   poc-normalized-legislator.memberships  b 
[0m08:04:45.006145 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:04:45.006145 [error] [MainThread]:   inner join 
[0m08:04:45.006145 [error] [MainThread]:   poc-normalized-legislator.persons c 
[0m08:04:45.006145 [error] [MainThread]:   on b.person_id = c.id
[0m08:04:45.006145 [error] [MainThread]:   inner join 
[0m08:04:45.023029 [error] [MainThread]:   poc-normalized-legislator.events  d
[0m08:04:45.025037 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:04:45.025037 [error] [MainThread]:     '''), ParseException: 
[0m08:04:45.025037 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m08:04:45.025037 [error] [MainThread]:   
[0m08:04:45.025037 [error] [MainThread]:   == SQL ==
[0m08:04:45.025037 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:04:45.025037 [error] [MainThread]:   
[0m08:04:45.025037 [error] [MainThread]:     
[0m08:04:45.025037 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:04:45.025037 [error] [MainThread]:     using PARQUET
[0m08:04:45.039366 [error] [MainThread]:   	
[0m08:04:45.039366 [error] [MainThread]:   	
[0m08:04:45.039366 [error] [MainThread]:   	
[0m08:04:45.039366 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:04:45.039366 [error] [MainThread]:   	
[0m08:04:45.039366 [error] [MainThread]:   	as
[0m08:04:45.039366 [error] [MainThread]:   	select 
[0m08:04:45.039366 [error] [MainThread]:   distinct 
[0m08:04:45.039366 [error] [MainThread]:   a.name organization_name, 
[0m08:04:45.039366 [error] [MainThread]:   a.type organization_type, 
[0m08:04:45.055312 [error] [MainThread]:   b.role role, 
[0m08:04:45.055870 [error] [MainThread]:   c.name person_name,
[0m08:04:45.055870 [error] [MainThread]:   d.name event_name
[0m08:04:45.055870 [error] [MainThread]:   from poc-normalized-legislator.organizations  a 
[0m08:04:45.055870 [error] [MainThread]:   --------^^^
[0m08:04:45.055870 [error] [MainThread]:   inner join 
[0m08:04:45.067349 [error] [MainThread]:   poc-normalized-legislator.memberships  b 
[0m08:04:45.067349 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:04:45.067349 [error] [MainThread]:   inner join 
[0m08:04:45.067349 [error] [MainThread]:   poc-normalized-legislator.persons c 
[0m08:04:45.067349 [error] [MainThread]:   on b.person_id = c.id
[0m08:04:45.067349 [error] [MainThread]:   inner join 
[0m08:04:45.067349 [error] [MainThread]:   poc-normalized-legislator.events  d
[0m08:04:45.067349 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:04:45.067349 [error] [MainThread]:     
[0m08:04:45.067349 [error] [MainThread]:   
[0m08:04:45.067349 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:04:45.067349 [info ] [MainThread]: 
[0m08:04:45.067349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m08:04:45.067349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2D9A7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2F706AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2E63F710>]}
[0m08:04:45.067349 [debug] [MainThread]: Flushing usage events
[0m08:04:46.225548 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:17:28.125452 | 1a3d8217-1da9-4bbb-bb82-89f56562a55d ==============================
[0m08:17:28.125452 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:17:28.125452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m08:17:28.125452 [debug] [MainThread]: Tracking: tracking
[0m08:17:28.142569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24E70B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24E3C6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24E70A350>]}
[0m08:17:28.425041 [debug] [MainThread]: Executing "git --help"
[0m08:17:28.464024 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:17:28.464024 [debug] [MainThread]: STDERR: "b''"
[0m08:17:28.479411 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m08:17:28.479411 [debug] [MainThread]: Using glue connection "debug"
[0m08:17:28.479411 [debug] [MainThread]: On debug: select 1 as id
[0m08:17:28.479411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:17:28.479411 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:17:28.479411 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m08:17:28.479411 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m08:17:57.290063 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:17:57.290063 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-761d57a4-b01e-49e1-8e17-42381d771aa8
[0m08:18:06.074772 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m08:18:06.074772 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m08:18:06.074772 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m08:18:06.074772 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:18:06.080341 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m08:18:12.305357 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685002685992, 'CompletedOn': 1685002690755}, 'ResponseMetadata': {'RequestId': 'aed01195-f151-4dc0-ba38-7cfd3c420fbb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:18:11 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'aed01195-f151-4dc0-ba38-7cfd3c420fbb'}, 'RetryAttempts': 0}}
[0m08:18:12.305357 [debug] [MainThread]: Glue adapter: status = ok
[0m08:18:12.305357 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m08:18:12.310007 [debug] [MainThread]: SQL status: OK in 44 seconds
[0m08:18:12.310007 [debug] [MainThread]: On debug: Close
[0m08:18:12.310007 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:18:12.315120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24EC05ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24E6DF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24F251F90>]}
[0m08:18:12.315120 [debug] [MainThread]: Flushing usage events
[0m08:18:13.557616 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:18:26.322922 | 3d468246-ea97-4025-a13e-0bcba8fa0a2e ==============================
[0m08:18:26.322922 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:18:26.338927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:18:26.338927 [debug] [MainThread]: Tracking: tracking
[0m08:18:26.356596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D94B6CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9480CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D94FFC790>]}
[0m08:18:26.389113 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:18:27.339190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:18:27.339190 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m08:18:27.339190 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test_event.sql
[0m08:18:27.348171 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m08:18:27.372124 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m08:18:27.388664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D94FD8490>]}
[0m08:18:27.405775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D957BC150>]}
[0m08:18:27.405775 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:18:27.405775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D95545590>]}
[0m08:18:27.412500 [info ] [MainThread]: 
[0m08:18:27.412500 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:18:27.412500 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m08:18:27.412500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:27.412500 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:18:27.412500 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m08:18:27.412500 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m08:18:45.830808 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:18:45.830808 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-61292d8a-7918-40cb-b9f0-0ba6dddd109f
[0m08:18:52.978932 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:18:54.503692 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m08:18:54.503692 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:18:54.519563 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m08:18:54.519563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:54.519563 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:18:55.839072 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m08:18:55.839072 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:18:55.839072 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-61292d8a-7918-40cb-b9f0-0ba6dddd109f
[0m08:18:57.496105 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:18:58.735613 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m08:18:58.735613 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:18:58.751897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D95BB6610>]}
[0m08:18:58.751897 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:18:58.751897 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:18:58.751897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:18:58.751897 [info ] [MainThread]: 
[0m08:18:58.768565 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m08:18:58.768565 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m08:18:58.768565 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m08:18:58.768565 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m08:18:58.784715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m08:18:58.786412 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 08:18:58.768565 => 2023-05-25 08:18:58.786412
[0m08:18:58.788103 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m08:18:58.804318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:18:58.804318 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:19:00.248327 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:19:00.248327 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:19:00.248327 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-61292d8a-7918-40cb-b9f0-0ba6dddd109f
[0m08:19:01.755532 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:03.070852 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m08:19:03.176122 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:03.176122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m08:19:03.176122 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:19:03.176122 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m08:19:03.176122 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  
[0m08:19:03.176122 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:03.176122 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:19:03.176122 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:19:03.191875 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:19:03.191875 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  ''')
[0m08:19:03.885945 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name \nfrom poc-normalized-legislator.organizations a \ninner join \npoc-normalized-legislator.memberships b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name \nfrom poc-normalized-legislator.organizations a \n--------^^^\ninner join \npoc-normalized-legislator.memberships b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name organization_name, \na.type organization_type, \nb.role role, \nc.name person_name \nfrom poc-normalized-legislator.organizations a \n--------^^^\ninner join \npoc-normalized-legislator.memberships b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685002743063, 'CompletedOn': 1685002743165}, 'ResponseMetadata': {'RequestId': 'a0633ddd-b19c-4062-87c4-58b7e78e4f0f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:19:03 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3304', 'connection': 'keep-alive', 'x-amzn-requestid': 'a0633ddd-b19c-4062-87c4-58b7e78e4f0f'}, 'RetryAttempts': 0}}
[0m08:19:03.885945 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:19:03.897348 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
--------^^^
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  

[0m08:19:03.897348 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
--------^^^
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  

[0m08:19:03.902820 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name organization_name, 
a.type organization_type, 
b.role role, 
c.name person_name 
from poc-normalized-legislator.organizations a 
inner join 
poc-normalized-legislator.memberships b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons c 
on b.person_id = c.id
  
[0m08:19:03.904153 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m08:19:03.904153 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:19:03.906698 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m08:19:03.906698 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:19:03.906698 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 08:18:58.788103 => 2023-05-25 08:19:03.906698
[0m08:19:03.988455 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name 
  from poc-normalized-legislator.organizations a 
  inner join 
  poc-normalized-legislator.memberships b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name organization_name, 
  a.type organization_type, 
  b.role role, 
  c.name person_name 
  from poc-normalized-legislator.organizations a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:19:03.988455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D961B1910>]}
[0m08:19:04.004061 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.22s]
[0m08:19:04.007142 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m08:19:04.007142 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m08:19:04.007142 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m08:19:04.007142 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m08:19:04.007142 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m08:19:04.022862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:19:04.022862 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 08:19:04.007142 => 2023-05-25 08:19:04.022862
[0m08:19:04.022862 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m08:19:04.022862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:19:04.022862 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:19:05.671193 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:19:05.671193 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:19:05.671193 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-61292d8a-7918-40cb-b9f0-0ba6dddd109f
[0m08:19:07.253632 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:08.746231 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m08:19:08.762292 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:08.762292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:19:08.770958 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:19:08.771454 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m08:19:08.771454 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:19:08.771454 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:19:08.771454 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:19:08.771454 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:19:08.771454 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:19:08.771454 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m08:19:09.578032 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685002748691, 'CompletedOn': 1685002748736}, 'ResponseMetadata': {'RequestId': '6a4eaddc-db10-42c5-a9f5-b335c5c877f5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:19:09 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3769', 'connection': 'keep-alive', 'x-amzn-requestid': '6a4eaddc-db10-42c5-a9f5-b335c5c877f5'}, 'RetryAttempts': 0}}
[0m08:19:09.578032 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:19:09.578032 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:19:09.586012 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:19:09.589994 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:19:09.590445 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m08:19:09.590445 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:19:09.592519 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m08:19:09.594028 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:19:09.594028 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 08:19:04.022862 => 2023-05-25 08:19:09.594028
[0m08:19:09.594028 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:19:09.594028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d468246-ea97-4025-a13e-0bcba8fa0a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D95CFEE50>]}
[0m08:19:09.594028 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 5.59s]
[0m08:19:09.594028 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m08:19:09.594028 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:19:09.594028 [debug] [MainThread]: On master: ROLLBACK
[0m08:19:09.610414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:19:09.610921 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:19:11.118140 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m08:19:11.122082 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:19:11.122848 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-61292d8a-7918-40cb-b9f0-0ba6dddd109f
[0m08:19:12.772271 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:19:12.789347 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:19:12.789347 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:19:12.789347 [debug] [MainThread]: On master: ROLLBACK
[0m08:19:12.789347 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:19:12.789347 [debug] [MainThread]: On master: Close
[0m08:19:12.794289 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:19:12.794289 [debug] [MainThread]: Glue adapter: cleanup called
[0m08:19:13.240712 [info ] [MainThread]: 
[0m08:19:13.240712 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 45.83 seconds (45.83s).
[0m08:19:13.255049 [debug] [MainThread]: Command end result
[0m08:19:13.272123 [info ] [MainThread]: 
[0m08:19:13.272123 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:19:13.277936 [info ] [MainThread]: 
[0m08:19:13.278385 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m08:19:13.278385 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:19:13.278385 [error] [MainThread]:   
[0m08:19:13.285969 [error] [MainThread]:     
[0m08:19:13.289281 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m08:19:13.289778 [error] [MainThread]:     using PARQUET
[0m08:19:13.296777 [error] [MainThread]:   	
[0m08:19:13.296777 [error] [MainThread]:   	
[0m08:19:13.296777 [error] [MainThread]:   	
[0m08:19:13.296777 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:19:13.300897 [error] [MainThread]:   	
[0m08:19:13.303903 [error] [MainThread]:   	as
[0m08:19:13.303903 [error] [MainThread]:   	select 
[0m08:19:13.303903 [error] [MainThread]:   distinct 
[0m08:19:13.303903 [error] [MainThread]:   a.name organization_name, 
[0m08:19:13.303903 [error] [MainThread]:   a.type organization_type, 
[0m08:19:13.320233 [error] [MainThread]:   b.role role, 
[0m08:19:13.320233 [error] [MainThread]:   c.name person_name 
[0m08:19:13.320233 [error] [MainThread]:   from poc-normalized-legislator.organizations a 
[0m08:19:13.320233 [error] [MainThread]:   inner join 
[0m08:19:13.333236 [error] [MainThread]:   poc-normalized-legislator.memberships b 
[0m08:19:13.333236 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:19:13.333236 [error] [MainThread]:   inner join 
[0m08:19:13.340855 [error] [MainThread]:   poc-normalized-legislator.persons c 
[0m08:19:13.343537 [error] [MainThread]:   on b.person_id = c.id
[0m08:19:13.343537 [error] [MainThread]:     '''), ParseException: 
[0m08:19:13.343537 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m08:19:13.343537 [error] [MainThread]:   
[0m08:19:13.354244 [error] [MainThread]:   == SQL ==
[0m08:19:13.354244 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:19:13.354244 [error] [MainThread]:   
[0m08:19:13.354244 [error] [MainThread]:     
[0m08:19:13.354244 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m08:19:13.354244 [error] [MainThread]:     using PARQUET
[0m08:19:13.354244 [error] [MainThread]:   	
[0m08:19:13.354244 [error] [MainThread]:   	
[0m08:19:13.354244 [error] [MainThread]:   	
[0m08:19:13.354244 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:19:13.369978 [error] [MainThread]:   	
[0m08:19:13.370755 [error] [MainThread]:   	as
[0m08:19:13.370755 [error] [MainThread]:   	select 
[0m08:19:13.370755 [error] [MainThread]:   distinct 
[0m08:19:13.381910 [error] [MainThread]:   a.name organization_name, 
[0m08:19:13.381910 [error] [MainThread]:   a.type organization_type, 
[0m08:19:13.381910 [error] [MainThread]:   b.role role, 
[0m08:19:13.381910 [error] [MainThread]:   c.name person_name 
[0m08:19:13.381910 [error] [MainThread]:   from poc-normalized-legislator.organizations a 
[0m08:19:13.381910 [error] [MainThread]:   --------^^^
[0m08:19:13.381910 [error] [MainThread]:   inner join 
[0m08:19:13.381910 [error] [MainThread]:   poc-normalized-legislator.memberships b 
[0m08:19:13.381910 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:19:13.381910 [error] [MainThread]:   inner join 
[0m08:19:13.381910 [error] [MainThread]:   poc-normalized-legislator.persons c 
[0m08:19:13.381910 [error] [MainThread]:   on b.person_id = c.id
[0m08:19:13.381910 [error] [MainThread]:     
[0m08:19:13.398775 [error] [MainThread]:   
[0m08:19:13.399781 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:19:13.401395 [info ] [MainThread]: 
[0m08:19:13.401395 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m08:19:13.409480 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:19:13.411567 [error] [MainThread]:   
[0m08:19:13.411567 [error] [MainThread]:     
[0m08:19:13.411567 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:19:13.411567 [error] [MainThread]:     using PARQUET
[0m08:19:13.411567 [error] [MainThread]:   	
[0m08:19:13.411567 [error] [MainThread]:   	
[0m08:19:13.417527 [error] [MainThread]:   	
[0m08:19:13.417527 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:19:13.419824 [error] [MainThread]:   	
[0m08:19:13.427875 [error] [MainThread]:   	as
[0m08:19:13.427875 [error] [MainThread]:   	select 
[0m08:19:13.427875 [error] [MainThread]:   distinct 
[0m08:19:13.427875 [error] [MainThread]:   a.name as organization_name, 
[0m08:19:13.427875 [error] [MainThread]:   a.type as organization_type, 
[0m08:19:13.427875 [error] [MainThread]:   b.role as role, 
[0m08:19:13.436267 [error] [MainThread]:   c.name as person_name,
[0m08:19:13.440639 [error] [MainThread]:   d.name as event_name
[0m08:19:13.440639 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:19:13.440639 [error] [MainThread]:   inner join 
[0m08:19:13.440639 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:19:13.440639 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:19:13.448642 [error] [MainThread]:   inner join 
[0m08:19:13.453682 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:19:13.454574 [error] [MainThread]:   on b.person_id = c.id
[0m08:19:13.454574 [error] [MainThread]:   inner join 
[0m08:19:13.459191 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:19:13.459191 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:19:13.463116 [error] [MainThread]:     '''), ParseException: 
[0m08:19:13.463116 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m08:19:13.463116 [error] [MainThread]:   
[0m08:19:13.463116 [error] [MainThread]:   == SQL ==
[0m08:19:13.470440 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:19:13.470440 [error] [MainThread]:   
[0m08:19:13.470440 [error] [MainThread]:     
[0m08:19:13.478450 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:19:13.478931 [error] [MainThread]:     using PARQUET
[0m08:19:13.478931 [error] [MainThread]:   	
[0m08:19:13.478931 [error] [MainThread]:   	
[0m08:19:13.478931 [error] [MainThread]:   	
[0m08:19:13.486862 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:19:13.486862 [error] [MainThread]:   	
[0m08:19:13.486862 [error] [MainThread]:   	as
[0m08:19:13.486862 [error] [MainThread]:   	select 
[0m08:19:13.494982 [error] [MainThread]:   distinct 
[0m08:19:13.502873 [error] [MainThread]:   a.name as organization_name, 
[0m08:19:13.502873 [error] [MainThread]:   a.type as organization_type, 
[0m08:19:13.502873 [error] [MainThread]:   b.role as role, 
[0m08:19:13.510869 [error] [MainThread]:   c.name as person_name,
[0m08:19:13.510869 [error] [MainThread]:   d.name as event_name
[0m08:19:13.510869 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:19:13.518864 [error] [MainThread]:   --------^^^
[0m08:19:13.522785 [error] [MainThread]:   inner join 
[0m08:19:13.522785 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:19:13.522785 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:19:13.522785 [error] [MainThread]:   inner join 
[0m08:19:13.522785 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:19:13.531183 [error] [MainThread]:   on b.person_id = c.id
[0m08:19:13.531183 [error] [MainThread]:   inner join 
[0m08:19:13.539175 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:19:13.539175 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:19:13.539175 [error] [MainThread]:     
[0m08:19:13.543580 [error] [MainThread]:   
[0m08:19:13.543580 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:19:13.551945 [info ] [MainThread]: 
[0m08:19:13.551945 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m08:19:13.551945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D972EBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D960FD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9480FBD0>]}
[0m08:19:13.551945 [debug] [MainThread]: Flushing usage events
[0m08:19:14.778475 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:32:22.980361 | 3911232a-fd0f-4ed8-a281-8fe2601c5cbf ==============================
[0m08:32:22.980361 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:32:22.980361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m08:32:22.980361 [debug] [MainThread]: Tracking: tracking
[0m08:32:22.996793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B727AEA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B727862E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B727B1E850>]}
[0m08:32:23.165238 [debug] [MainThread]: Executing "git --help"
[0m08:32:23.200308 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:32:23.200308 [debug] [MainThread]: STDERR: "b''"
[0m08:32:23.200308 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m08:32:23.200308 [debug] [MainThread]: Using glue connection "debug"
[0m08:32:23.200308 [debug] [MainThread]: On debug: select 1 as id
[0m08:32:23.200308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:32:23.200308 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:32:23.200308 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m08:32:23.200308 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m08:32:50.532439 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:32:50.532439 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-b2baa6fd-cab7-46c0-a7bc-9e2748ca699b
[0m08:32:58.900477 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m08:32:58.900477 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m08:32:58.900477 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m08:32:58.900477 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:32:58.900477 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m08:33:03.689163 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685003578847, 'CompletedOn': 1685003582424}, 'ResponseMetadata': {'RequestId': '65cc59e5-8ecc-4c6e-a740-78aa300e4dca', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:33:03 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '65cc59e5-8ecc-4c6e-a740-78aa300e4dca'}, 'RetryAttempts': 0}}
[0m08:33:03.689163 [debug] [MainThread]: Glue adapter: status = ok
[0m08:33:03.689163 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m08:33:03.689163 [debug] [MainThread]: SQL status: OK in 40 seconds
[0m08:33:03.689163 [debug] [MainThread]: On debug: Close
[0m08:33:03.689163 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:33:03.689163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B728329990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B727D5CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B72933EA90>]}
[0m08:33:03.689163 [debug] [MainThread]: Flushing usage events
[0m08:33:04.720302 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:33:29.412471 | 82a88949-d7a7-4d35-bf73-abaea65bf958 ==============================
[0m08:33:29.412471 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:33:29.412471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:33:29.412471 [debug] [MainThread]: Tracking: tracking
[0m08:33:29.432451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A407AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A436A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A4368250>]}
[0m08:33:29.464899 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:33:30.081472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:33:30.081472 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m08:33:30.097454 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m08:33:30.113278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A4EC9150>]}
[0m08:33:30.128992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A4F99110>]}
[0m08:33:30.128992 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:33:30.128992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A4F56A90>]}
[0m08:33:30.132997 [info ] [MainThread]: 
[0m08:33:30.132997 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:33:30.132997 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m08:33:30.132997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:30.132997 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:33:30.132997 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m08:33:30.132997 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m08:33:47.970292 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:33:47.970292 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-d316a9e0-a7db-4be4-9d9e-77445ab8f193
[0m08:33:54.992992 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:33:56.277188 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m08:33:56.277188 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:33:56.277188 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m08:33:56.277188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:56.277188 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:33:57.360487 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m08:33:57.360487 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:33:57.360487 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-d316a9e0-a7db-4be4-9d9e-77445ab8f193
[0m08:33:58.768143 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:33:59.891665 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m08:33:59.892658 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:33:59.894588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A598A010>]}
[0m08:33:59.894588 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:33:59.895580 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:33:59.896663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:33:59.896663 [info ] [MainThread]: 
[0m08:33:59.896663 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m08:33:59.896663 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m08:33:59.906698 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m08:33:59.906698 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m08:33:59.906698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m08:33:59.906698 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 08:33:59.906698 => 2023-05-25 08:33:59.906698
[0m08:33:59.906698 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m08:33:59.906698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:33:59.906698 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:34:01.109211 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:34:01.109719 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:34:01.109719 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-d316a9e0-a7db-4be4-9d9e-77445ab8f193
[0m08:34:02.597494 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:03.814846 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:03.846831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:34:03.846831 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m08:34:03.846831 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:34:03.846831 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m08:34:04.570592 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685003643772, 'CompletedOn': 1685003643863}, 'ResponseMetadata': {'RequestId': '4f9fe0ee-faea-43a6-b7e6-449bbaef8dbb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:34:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3367', 'connection': 'keep-alive', 'x-amzn-requestid': '4f9fe0ee-faea-43a6-b7e6-449bbaef8dbb'}, 'RetryAttempts': 0}}
[0m08:34:04.570592 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:34:04.572586 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m08:34:04.574579 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m08:34:04.575709 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m08:34:04.576212 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m08:34:04.576212 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:34:04.577229 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m08:34:04.578229 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:34:04.578229 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 08:33:59.906698 => 2023-05-25 08:34:04.578229
[0m08:34:04.629824 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:34:04.629824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A59CBC50>]}
[0m08:34:04.629824 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.72s]
[0m08:34:04.645509 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m08:34:04.645509 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m08:34:04.645509 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m08:34:04.645509 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m08:34:04.645509 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m08:34:04.645509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:34:04.645509 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 08:34:04.645509 => 2023-05-25 08:34:04.645509
[0m08:34:04.645509 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m08:34:04.645509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:04.645509 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:34:05.853416 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:34:05.853416 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:34:05.854413 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-d316a9e0-a7db-4be4-9d9e-77445ab8f193
[0m08:34:07.304446 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:08.503751 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m08:34:08.503751 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:08.503751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:34:08.503751 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:34:08.503751 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m08:34:08.503751 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:34:08.503751 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:34:08.503751 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:34:08.519401 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:34:08.519472 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:34:08.519990 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m08:34:09.206614 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685003648424, 'CompletedOn': 1685003648457}, 'ResponseMetadata': {'RequestId': '1e3eeb2c-2e3e-451b-8b74-c5a085fcb9af', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:34:08 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3769', 'connection': 'keep-alive', 'x-amzn-requestid': '1e3eeb2c-2e3e-451b-8b74-c5a085fcb9af'}, 'RetryAttempts': 0}}
[0m08:34:09.206614 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:34:09.206614 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:34:33.113585 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:34:33.114382 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:34:33.115186 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m08:34:33.116416 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:34:33.117161 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m08:34:33.117758 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:34:33.118245 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 08:34:04.645509 => 2023-05-25 08:34:33.118199
[0m08:34:33.120210 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:34:33.120581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a88949-d7a7-4d35-bf73-abaea65bf958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A4E2B4D0>]}
[0m08:34:33.121305 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 28.48s]
[0m08:34:33.130292 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m08:34:33.131663 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:34:33.131981 [debug] [MainThread]: On master: ROLLBACK
[0m08:34:33.132141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:33.132605 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:34:34.362535 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m08:34:34.362535 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:34:34.362535 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-d316a9e0-a7db-4be4-9d9e-77445ab8f193
[0m08:34:35.837200 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:34:35.837200 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:34:35.837200 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:34:35.852861 [debug] [MainThread]: On master: ROLLBACK
[0m08:34:35.852861 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:34:35.852861 [debug] [MainThread]: On master: Close
[0m08:34:35.852861 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:34:35.852861 [debug] [MainThread]: Glue adapter: cleanup called
[0m08:34:36.329949 [info ] [MainThread]: 
[0m08:34:36.329949 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 6.20 seconds (66.20s).
[0m08:34:36.345905 [debug] [MainThread]: Command end result
[0m08:34:36.345905 [info ] [MainThread]: 
[0m08:34:36.345905 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:34:36.345905 [info ] [MainThread]: 
[0m08:34:36.345905 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m08:34:36.345905 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:34:36.345905 [error] [MainThread]:   
[0m08:34:36.345905 [error] [MainThread]:     
[0m08:34:36.345905 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m08:34:36.345905 [error] [MainThread]:     using PARQUET
[0m08:34:36.345905 [error] [MainThread]:   	
[0m08:34:36.345905 [error] [MainThread]:   	
[0m08:34:36.345905 [error] [MainThread]:   	
[0m08:34:36.345905 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:34:36.345905 [error] [MainThread]:   	
[0m08:34:36.361618 [error] [MainThread]:   	as
[0m08:34:36.363671 [error] [MainThread]:   	select 
[0m08:34:36.363671 [error] [MainThread]:   distinct 
[0m08:34:36.363671 [error] [MainThread]:   a.name as organization_name, 
[0m08:34:36.363671 [error] [MainThread]:   a.type as organization_type, 
[0m08:34:36.363671 [error] [MainThread]:   b.role as role, 
[0m08:34:36.363671 [error] [MainThread]:   c.name as person_name 
[0m08:34:36.363671 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:34:36.363671 [error] [MainThread]:   inner join 
[0m08:34:36.363671 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:34:36.363671 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:34:36.363671 [error] [MainThread]:   inner join 
[0m08:34:36.363671 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:34:36.363671 [error] [MainThread]:   on b.person_id = c.id
[0m08:34:36.363671 [error] [MainThread]:     '''), ParseException: 
[0m08:34:36.363671 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m08:34:36.363671 [error] [MainThread]:   
[0m08:34:36.363671 [error] [MainThread]:   == SQL ==
[0m08:34:36.363671 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:34:36.363671 [error] [MainThread]:   
[0m08:34:36.363671 [error] [MainThread]:     
[0m08:34:36.363671 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m08:34:36.363671 [error] [MainThread]:     using PARQUET
[0m08:34:36.363671 [error] [MainThread]:   	
[0m08:34:36.363671 [error] [MainThread]:   	
[0m08:34:36.363671 [error] [MainThread]:   	
[0m08:34:36.363671 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:34:36.377742 [error] [MainThread]:   	
[0m08:34:36.378194 [error] [MainThread]:   	as
[0m08:34:36.378194 [error] [MainThread]:   	select 
[0m08:34:36.378194 [error] [MainThread]:   distinct 
[0m08:34:36.378194 [error] [MainThread]:   a.name as organization_name, 
[0m08:34:36.378194 [error] [MainThread]:   a.type as organization_type, 
[0m08:34:36.378194 [error] [MainThread]:   b.role as role, 
[0m08:34:36.378194 [error] [MainThread]:   c.name as person_name 
[0m08:34:36.378194 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:34:36.378194 [error] [MainThread]:   --------^^^
[0m08:34:36.378194 [error] [MainThread]:   inner join 
[0m08:34:36.378194 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:34:36.378194 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:34:36.378194 [error] [MainThread]:   inner join 
[0m08:34:36.378194 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:34:36.378194 [error] [MainThread]:   on b.person_id = c.id
[0m08:34:36.378194 [error] [MainThread]:     
[0m08:34:36.378194 [error] [MainThread]:   
[0m08:34:36.390916 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:34:36.390916 [info ] [MainThread]: 
[0m08:34:36.390916 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m08:34:36.390916 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:34:36.390916 [error] [MainThread]:   
[0m08:34:36.390916 [error] [MainThread]:     
[0m08:34:36.390916 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:34:36.390916 [error] [MainThread]:     using PARQUET
[0m08:34:36.390916 [error] [MainThread]:   	
[0m08:34:36.390916 [error] [MainThread]:   	
[0m08:34:36.390916 [error] [MainThread]:   	
[0m08:34:36.390916 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:34:36.395110 [error] [MainThread]:   	
[0m08:34:36.396989 [error] [MainThread]:   	as
[0m08:34:36.396989 [error] [MainThread]:   	select 
[0m08:34:36.396989 [error] [MainThread]:   distinct 
[0m08:34:36.396989 [error] [MainThread]:   a.name as organization_name, 
[0m08:34:36.396989 [error] [MainThread]:   a.type as organization_type, 
[0m08:34:36.396989 [error] [MainThread]:   b.role as role, 
[0m08:34:36.396989 [error] [MainThread]:   c.name as person_name,
[0m08:34:36.396989 [error] [MainThread]:   d.name as event_name
[0m08:34:36.396989 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:34:36.396989 [error] [MainThread]:   inner join 
[0m08:34:36.396989 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:34:36.396989 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:34:36.396989 [error] [MainThread]:   inner join 
[0m08:34:36.396989 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:34:36.396989 [error] [MainThread]:   on b.person_id = c.id
[0m08:34:36.396989 [error] [MainThread]:   inner join 
[0m08:34:36.396989 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:34:36.396989 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:34:36.396989 [error] [MainThread]:     '''), ParseException: 
[0m08:34:36.409368 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m08:34:36.409368 [error] [MainThread]:   
[0m08:34:36.410397 [error] [MainThread]:   == SQL ==
[0m08:34:36.410397 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:34:36.410397 [error] [MainThread]:   
[0m08:34:36.410397 [error] [MainThread]:     
[0m08:34:36.410397 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m08:34:36.410397 [error] [MainThread]:     using PARQUET
[0m08:34:36.410397 [error] [MainThread]:   	
[0m08:34:36.410397 [error] [MainThread]:   	
[0m08:34:36.410397 [error] [MainThread]:   	
[0m08:34:36.410397 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:34:36.410397 [error] [MainThread]:   	
[0m08:34:36.410397 [error] [MainThread]:   	as
[0m08:34:36.418829 [error] [MainThread]:   	select 
[0m08:34:36.418829 [error] [MainThread]:   distinct 
[0m08:34:36.418829 [error] [MainThread]:   a.name as organization_name, 
[0m08:34:36.418829 [error] [MainThread]:   a.type as organization_type, 
[0m08:34:36.418829 [error] [MainThread]:   b.role as role, 
[0m08:34:36.418829 [error] [MainThread]:   c.name as person_name,
[0m08:34:36.418829 [error] [MainThread]:   d.name as event_name
[0m08:34:36.418829 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:34:36.418829 [error] [MainThread]:   --------^^^
[0m08:34:36.418829 [error] [MainThread]:   inner join 
[0m08:34:36.418829 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:34:36.418829 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:34:36.418829 [error] [MainThread]:   inner join 
[0m08:34:36.418829 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:34:36.418829 [error] [MainThread]:   on b.person_id = c.id
[0m08:34:36.418829 [error] [MainThread]:   inner join 
[0m08:34:36.418829 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:34:36.418829 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:34:36.418829 [error] [MainThread]:     
[0m08:34:36.418829 [error] [MainThread]:   
[0m08:34:36.418829 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:34:36.425132 [info ] [MainThread]: 
[0m08:34:36.425526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m08:34:36.425526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A5A6F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A5031A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A55206D0>]}
[0m08:34:36.425526 [debug] [MainThread]: Flushing usage events
[0m08:34:37.361655 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:37:24.806648 | e734f5a6-f10d-4789-a812-448e5737b37f ==============================
[0m08:37:24.806648 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:37:24.806648 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m08:37:24.806648 [debug] [MainThread]: Tracking: tracking
[0m08:37:24.821814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C0344D210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C035E1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C034F3FD0>]}
[0m08:37:24.984879 [debug] [MainThread]: Executing "git --help"
[0m08:37:25.022468 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:37:25.022468 [debug] [MainThread]: STDERR: "b''"
[0m08:37:25.038228 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m08:37:25.038228 [debug] [MainThread]: Using glue connection "debug"
[0m08:37:25.038228 [debug] [MainThread]: On debug: select 1 as id
[0m08:37:25.038228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:25.038228 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:37:25.038228 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m08:37:25.038228 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m08:37:48.368551 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:37:48.368551 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-b3e76029-414a-49c3-98f4-7b97c98f870d
[0m08:37:56.935246 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m08:37:56.935246 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m08:37:56.935246 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m08:37:56.935246 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:37:56.935246 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m08:38:03.400992 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685003876898, 'CompletedOn': 1685003882286}, 'ResponseMetadata': {'RequestId': 'f990af09-7318-4293-b8be-2a64510d5d64', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:38:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'f990af09-7318-4293-b8be-2a64510d5d64'}, 'RetryAttempts': 0}}
[0m08:38:03.400992 [debug] [MainThread]: Glue adapter: status = ok
[0m08:38:03.400992 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m08:38:03.400992 [debug] [MainThread]: SQL status: OK in 38 seconds
[0m08:38:03.416624 [debug] [MainThread]: On debug: Close
[0m08:38:03.416624 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:38:03.416624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C0323CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C0351A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C032BB150>]}
[0m08:38:03.416624 [debug] [MainThread]: Flushing usage events
[0m08:38:04.520740 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 08:50:43.363141 | 4c94ef3f-e7b7-4c9a-8f25-b487198cce84 ==============================
[0m08:50:43.363141 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:50:43.363141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:50:43.363141 [debug] [MainThread]: Tracking: tracking
[0m08:50:43.378820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511A992D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B793050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511A97A5D0>]}
[0m08:50:43.395093 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:50:43.395093 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:50:43.410963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B7BA050>]}
[0m08:50:44.619109 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m08:50:44.634811 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m08:50:44.716275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B919750>]}
[0m08:50:44.719322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B8F8310>]}
[0m08:50:44.719322 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:50:44.719322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B821D50>]}
[0m08:50:44.719322 [info ] [MainThread]: 
[0m08:50:44.719322 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:50:44.719322 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m08:50:44.719322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:44.735049 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:50:44.735397 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m08:50:44.735397 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m08:51:02.682111 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:51:02.682111 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4c392750-b144-4e3a-b452-0b7b94da2a3c
[0m08:51:10.968187 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:51:12.202983 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m08:51:12.202983 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:51:12.202983 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m08:51:12.218639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:12.218924 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m08:51:13.323058 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m08:51:13.324046 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m08:51:13.324046 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4c392750-b144-4e3a-b452-0b7b94da2a3c
[0m08:51:14.693115 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m08:51:15.815676 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m08:51:15.831438 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m08:51:15.831438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511BD966D0>]}
[0m08:51:15.831438 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:51:15.831438 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:51:15.831438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:51:15.831438 [info ] [MainThread]: 
[0m08:51:15.847039 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m08:51:15.847039 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m08:51:15.847039 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m08:51:15.847039 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m08:51:15.850055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m08:51:15.850055 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 08:51:15.847039 => 2023-05-25 08:51:15.850055
[0m08:51:15.850055 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m08:51:15.865762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:51:15.865762 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:51:17.082377 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:51:17.082377 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:51:17.082377 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4c392750-b144-4e3a-b452-0b7b94da2a3c
[0m08:51:18.501213 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:19.704657 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m08:51:19.756642 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:19.756642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m08:51:19.756642 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:51:19.756642 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m08:51:19.772472 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m08:51:19.772642 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:19.772642 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:51:19.772642 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:51:19.772642 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:51:19.772642 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m08:51:20.474216 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685004679692, 'CompletedOn': 1685004679789}, 'ResponseMetadata': {'RequestId': 'f442dd11-9ef9-45fc-a1e3-777045ab6fa8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:51:20 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3379', 'connection': 'keep-alive', 'x-amzn-requestid': 'f442dd11-9ef9-45fc-a1e3-777045ab6fa8'}, 'RetryAttempts': 0}}
[0m08:51:20.489799 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:51:20.489799 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m08:51:20.489799 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m08:51:20.489799 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m08:51:20.489799 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m08:51:20.489799 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:51:20.489799 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m08:51:20.489799 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:51:20.489799 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 08:51:15.850055 => 2023-05-25 08:51:20.489799
[0m08:51:20.557820 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:51:20.557820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511B9234D0>]}
[0m08:51:20.557820 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.71s]
[0m08:51:20.573922 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m08:51:20.574933 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m08:51:20.574933 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m08:51:20.574933 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m08:51:20.574933 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m08:51:20.574933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:51:20.574933 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 08:51:20.574933 => 2023-05-25 08:51:20.574933
[0m08:51:20.574933 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m08:51:20.591128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:20.591128 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m08:51:21.852683 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m08:51:21.853681 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m08:51:21.854675 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4c392750-b144-4e3a-b452-0b7b94da2a3c
[0m08:51:23.297023 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:24.428935 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:24.444594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m08:51:24.444594 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m08:51:24.444594 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m08:51:24.444594 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m08:51:25.145753 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685004684378, 'CompletedOn': 1685004684411}, 'ResponseMetadata': {'RequestId': 'b0ff673d-d997-4dd9-949c-cdca1beedcf1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 08:51:24 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3781', 'connection': 'keep-alive', 'x-amzn-requestid': 'b0ff673d-d997-4dd9-949c-cdca1beedcf1'}, 'RetryAttempts': 0}}
[0m08:51:25.145753 [debug] [Thread-1 (]: Glue adapter: status = error
[0m08:51:25.145753 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:51:25.145753 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m08:51:25.155378 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m08:51:25.155378 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m08:51:25.155378 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m08:51:25.155378 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m08:51:25.155378 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m08:51:25.155378 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 08:51:20.574933 => 2023-05-25 08:51:25.155378
[0m08:51:25.155378 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:51:25.155378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c94ef3f-e7b7-4c9a-8f25-b487198cce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511C387BD0>]}
[0m08:51:25.155378 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.58s]
[0m08:51:25.167488 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m08:51:25.167488 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m08:51:25.167488 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:25.167488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:25.167488 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m08:51:26.303459 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m08:51:26.303459 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m08:51:26.303459 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4c392750-b144-4e3a-b452-0b7b94da2a3c
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m08:51:27.775577 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m08:51:27.775577 [debug] [MainThread]: On master: Close
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m08:51:27.775577 [debug] [MainThread]: Glue adapter: cleanup called
[0m08:51:28.208705 [info ] [MainThread]: 
[0m08:51:28.208705 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 43.49 seconds (43.49s).
[0m08:51:28.208705 [debug] [MainThread]: Command end result
[0m08:51:28.225414 [info ] [MainThread]: 
[0m08:51:28.225414 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:51:28.241050 [info ] [MainThread]: 
[0m08:51:28.241050 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m08:51:28.241050 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:51:28.241050 [error] [MainThread]:   
[0m08:51:28.241050 [error] [MainThread]:     
[0m08:51:28.241050 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m08:51:28.241050 [error] [MainThread]:     using PARQUET
[0m08:51:28.241050 [error] [MainThread]:   	
[0m08:51:28.241050 [error] [MainThread]:   	
[0m08:51:28.241050 [error] [MainThread]:   	
[0m08:51:28.241050 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:51:28.241050 [error] [MainThread]:   	
[0m08:51:28.241050 [error] [MainThread]:   	as
[0m08:51:28.257198 [error] [MainThread]:   	select 
[0m08:51:28.257508 [error] [MainThread]:   distinct 
[0m08:51:28.257508 [error] [MainThread]:   a.name as organization_name, 
[0m08:51:28.257508 [error] [MainThread]:   a.type as organization_type, 
[0m08:51:28.257508 [error] [MainThread]:   b.role as role, 
[0m08:51:28.257508 [error] [MainThread]:   c.name as person_name 
[0m08:51:28.257508 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:51:28.257508 [error] [MainThread]:   inner join 
[0m08:51:28.257508 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:51:28.257508 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:51:28.257508 [error] [MainThread]:   inner join 
[0m08:51:28.257508 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:51:28.257508 [error] [MainThread]:   on b.person_id = c.id
[0m08:51:28.257508 [error] [MainThread]:     '''), ParseException: 
[0m08:51:28.257508 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m08:51:28.257508 [error] [MainThread]:   
[0m08:51:28.273151 [error] [MainThread]:   == SQL ==
[0m08:51:28.273939 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m08:51:28.273939 [error] [MainThread]:   
[0m08:51:28.273939 [error] [MainThread]:     
[0m08:51:28.276962 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m08:51:28.276962 [error] [MainThread]:     using PARQUET
[0m08:51:28.276962 [error] [MainThread]:   	
[0m08:51:28.276962 [error] [MainThread]:   	
[0m08:51:28.276962 [error] [MainThread]:   	
[0m08:51:28.276962 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m08:51:28.276962 [error] [MainThread]:   	
[0m08:51:28.276962 [error] [MainThread]:   	as
[0m08:51:28.276962 [error] [MainThread]:   	select 
[0m08:51:28.276962 [error] [MainThread]:   distinct 
[0m08:51:28.276962 [error] [MainThread]:   a.name as organization_name, 
[0m08:51:28.276962 [error] [MainThread]:   a.type as organization_type, 
[0m08:51:28.276962 [error] [MainThread]:   b.role as role, 
[0m08:51:28.276962 [error] [MainThread]:   c.name as person_name 
[0m08:51:28.276962 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:51:28.276962 [error] [MainThread]:   --------^^^
[0m08:51:28.292757 [error] [MainThread]:   inner join 
[0m08:51:28.292757 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:51:28.292757 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:51:28.292757 [error] [MainThread]:   inner join 
[0m08:51:28.292757 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:51:28.292757 [error] [MainThread]:   on b.person_id = c.id
[0m08:51:28.292757 [error] [MainThread]:     
[0m08:51:28.292757 [error] [MainThread]:   
[0m08:51:28.292757 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m08:51:28.292757 [info ] [MainThread]: 
[0m08:51:28.292757 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m08:51:28.292757 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:51:28.292757 [error] [MainThread]:   
[0m08:51:28.292757 [error] [MainThread]:     
[0m08:51:28.292757 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m08:51:28.292757 [error] [MainThread]:     using PARQUET
[0m08:51:28.292757 [error] [MainThread]:   	
[0m08:51:28.292757 [error] [MainThread]:   	
[0m08:51:28.292757 [error] [MainThread]:   	
[0m08:51:28.308975 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:51:28.309901 [error] [MainThread]:   	
[0m08:51:28.309901 [error] [MainThread]:   	as
[0m08:51:28.309901 [error] [MainThread]:   	select 
[0m08:51:28.309901 [error] [MainThread]:   distinct 
[0m08:51:28.309901 [error] [MainThread]:   a.name as organization_name, 
[0m08:51:28.309901 [error] [MainThread]:   a.type as organization_type, 
[0m08:51:28.309901 [error] [MainThread]:   b.role as role, 
[0m08:51:28.309901 [error] [MainThread]:   c.name as person_name,
[0m08:51:28.309901 [error] [MainThread]:   d.name as event_name
[0m08:51:28.309901 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:51:28.309901 [error] [MainThread]:   inner join 
[0m08:51:28.309901 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:51:28.309901 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:51:28.309901 [error] [MainThread]:   inner join 
[0m08:51:28.309901 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:51:28.309901 [error] [MainThread]:   on b.person_id = c.id
[0m08:51:28.309901 [error] [MainThread]:   inner join 
[0m08:51:28.309901 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:51:28.309901 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:51:28.309901 [error] [MainThread]:     '''), ParseException: 
[0m08:51:28.309901 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m08:51:28.309901 [error] [MainThread]:   
[0m08:51:28.309901 [error] [MainThread]:   == SQL ==
[0m08:51:28.309901 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m08:51:28.309901 [error] [MainThread]:   
[0m08:51:28.309901 [error] [MainThread]:     
[0m08:51:28.309901 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m08:51:28.309901 [error] [MainThread]:     using PARQUET
[0m08:51:28.309901 [error] [MainThread]:   	
[0m08:51:28.325680 [error] [MainThread]:   	
[0m08:51:28.326050 [error] [MainThread]:   	
[0m08:51:28.326050 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m08:51:28.326050 [error] [MainThread]:   	
[0m08:51:28.326050 [error] [MainThread]:   	as
[0m08:51:28.326050 [error] [MainThread]:   	select 
[0m08:51:28.326050 [error] [MainThread]:   distinct 
[0m08:51:28.326050 [error] [MainThread]:   a.name as organization_name, 
[0m08:51:28.326050 [error] [MainThread]:   a.type as organization_type, 
[0m08:51:28.326050 [error] [MainThread]:   b.role as role, 
[0m08:51:28.326050 [error] [MainThread]:   c.name as person_name,
[0m08:51:28.326050 [error] [MainThread]:   d.name as event_name
[0m08:51:28.326050 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m08:51:28.326050 [error] [MainThread]:   --------^^^
[0m08:51:28.326050 [error] [MainThread]:   inner join 
[0m08:51:28.326050 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m08:51:28.326050 [error] [MainThread]:   on a.id=b.organization_id 
[0m08:51:28.326050 [error] [MainThread]:   inner join 
[0m08:51:28.326050 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m08:51:28.326050 [error] [MainThread]:   on b.person_id = c.id
[0m08:51:28.326050 [error] [MainThread]:   inner join 
[0m08:51:28.326050 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m08:51:28.326050 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m08:51:28.326050 [error] [MainThread]:     
[0m08:51:28.326050 [error] [MainThread]:   
[0m08:51:28.326050 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m08:51:28.326050 [info ] [MainThread]: 
[0m08:51:28.341825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m08:51:28.342637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511C289A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511C399950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511C3530D0>]}
[0m08:51:28.342637 [debug] [MainThread]: Flushing usage events
[0m08:51:29.425900 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 11:25:50.697949 | fdc2a771-c9ed-4661-8a23-b5ccd15572e9 ==============================
[0m11:25:50.697949 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:25:50.697949 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:50.697949 [debug] [MainThread]: Tracking: tracking
[0m11:25:50.717390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1F1D7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1FF8DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1F46F7D0>]}
[0m11:25:50.748920 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:25:51.668596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:51.668596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:51.681220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1F46F7D0>]}
[0m11:25:51.681220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2002D390>]}
[0m11:25:51.681220 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m11:25:51.681220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1FF442D0>]}
[0m11:25:51.681220 [info ] [MainThread]: 
[0m11:25:51.681220 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m11:25:51.681220 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m11:25:51.697339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:51.697860 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m11:25:51.697860 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m11:25:51.698825 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m11:26:09.887290 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m11:26:09.887290 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f0790a49-c624-4fc5-b7b2-2aac50bfb0c9
[0m11:26:19.147974 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m11:26:21.568458 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m11:26:21.568458 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m11:26:21.568458 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m11:26:21.568458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:21.568458 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m11:26:22.830594 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m11:26:22.830594 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m11:26:22.830594 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f0790a49-c624-4fc5-b7b2-2aac50bfb0c9
[0m11:26:24.318464 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m11:26:25.846950 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m11:26:25.846950 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m11:26:25.849663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1F1BC310>]}
[0m11:26:25.849663 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m11:26:25.849663 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m11:26:25.849663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:25.849663 [info ] [MainThread]: 
[0m11:26:25.854507 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m11:26:25.854507 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m11:26:25.854507 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m11:26:25.854507 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m11:26:25.870523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m11:26:25.870523 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 11:26:25.854507 => 2023-05-25 11:26:25.870523
[0m11:26:25.870523 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m11:26:25.870523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:26:25.886480 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m11:26:26.992398 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m11:26:26.992398 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m11:26:26.992398 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f0790a49-c624-4fc5-b7b2-2aac50bfb0c9
[0m11:26:28.378285 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:29.612665 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m11:26:29.649721 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:29.649721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m11:26:29.649721 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m11:26:29.649721 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m11:26:29.649721 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m11:26:29.649721 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:29.662844 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m11:26:29.662844 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m11:26:29.662844 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:26:29.662844 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m11:26:30.463650 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685013989577, 'CompletedOn': 1685013989679}, 'ResponseMetadata': {'RequestId': '0348eb0f-2415-4d19-baa1-81d682e48b64', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:26:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3379', 'connection': 'keep-alive', 'x-amzn-requestid': '0348eb0f-2415-4d19-baa1-81d682e48b64'}, 'RetryAttempts': 0}}
[0m11:26:30.463650 [debug] [Thread-1 (]: Glue adapter: status = error
[0m11:26:30.474208 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m11:26:30.474208 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m11:26:30.474208 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m11:26:30.474208 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m11:26:30.474208 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m11:26:30.481534 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m11:26:30.481534 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m11:26:30.481534 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 11:26:25.870523 => 2023-05-25 11:26:30.481534
[0m11:26:30.568332 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m11:26:30.568332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA20BA3E90>]}
[0m11:26:30.568332 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.71s]
[0m11:26:30.584112 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m11:26:30.584112 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m11:26:30.584112 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m11:26:30.584112 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m11:26:30.584112 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m11:26:30.584112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m11:26:30.584112 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 11:26:30.584112 => 2023-05-25 11:26:30.584112
[0m11:26:30.584112 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m11:26:30.584112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:30.584112 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m11:26:31.619647 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m11:26:31.619647 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m11:26:31.619647 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f0790a49-c624-4fc5-b7b2-2aac50bfb0c9
[0m11:26:33.000078 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:34.074190 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m11:26:34.079140 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:34.079140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m11:26:34.079140 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m11:26:34.079140 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m11:26:34.084331 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m11:26:34.084813 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:26:34.084813 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m11:26:34.084813 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m11:26:34.084813 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:26:34.084813 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m11:26:34.918937 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685013993994, 'CompletedOn': 1685013994030}, 'ResponseMetadata': {'RequestId': '795c685e-df48-4b69-8cd3-d6c3dd9c8d34', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:26:34 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3781', 'connection': 'keep-alive', 'x-amzn-requestid': '795c685e-df48-4b69-8cd3-d6c3dd9c8d34'}, 'RetryAttempts': 0}}
[0m11:26:34.927161 [debug] [Thread-1 (]: Glue adapter: status = error
[0m11:26:34.927161 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m11:26:34.929045 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m11:26:34.929602 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m11:26:34.930038 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m11:26:34.930038 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m11:26:34.930810 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m11:26:34.931033 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m11:26:34.931419 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 11:26:30.584112 => 2023-05-25 11:26:34.931419
[0m11:26:34.931742 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m11:26:34.931742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc2a771-c9ed-4661-8a23-b5ccd15572e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA20B09D90>]}
[0m11:26:34.934670 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.35s]
[0m11:26:34.935166 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m11:26:34.940038 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m11:26:34.940665 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:34.940665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:34.940665 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m11:26:35.971028 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m11:26:35.971028 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m11:26:35.971028 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f0790a49-c624-4fc5-b7b2-2aac50bfb0c9
[0m11:26:37.353960 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m11:26:37.353960 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m11:26:37.353960 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m11:26:37.356652 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:37.356652 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m11:26:37.356652 [debug] [MainThread]: On master: Close
[0m11:26:37.356652 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m11:26:37.359738 [debug] [MainThread]: Glue adapter: cleanup called
[0m11:26:37.939871 [info ] [MainThread]: 
[0m11:26:37.939871 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 46.26 seconds (46.26s).
[0m11:26:37.945295 [debug] [MainThread]: Command end result
[0m11:26:37.947940 [info ] [MainThread]: 
[0m11:26:37.947940 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:26:37.947940 [info ] [MainThread]: 
[0m11:26:37.958043 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m11:26:37.960076 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m11:26:37.960076 [error] [MainThread]:   
[0m11:26:37.960076 [error] [MainThread]:     
[0m11:26:37.968298 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m11:26:37.968298 [error] [MainThread]:     using PARQUET
[0m11:26:37.968298 [error] [MainThread]:   	
[0m11:26:37.968298 [error] [MainThread]:   	
[0m11:26:37.968298 [error] [MainThread]:   	
[0m11:26:37.972549 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m11:26:37.972549 [error] [MainThread]:   	
[0m11:26:37.974760 [error] [MainThread]:   	as
[0m11:26:37.978288 [error] [MainThread]:   	select 
[0m11:26:37.978288 [error] [MainThread]:   distinct 
[0m11:26:37.978288 [error] [MainThread]:   a.name as organization_name, 
[0m11:26:37.985268 [error] [MainThread]:   a.type as organization_type, 
[0m11:26:37.985268 [error] [MainThread]:   b.role as role, 
[0m11:26:37.985268 [error] [MainThread]:   c.name as person_name 
[0m11:26:37.985268 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:26:37.989663 [error] [MainThread]:   inner join 
[0m11:26:37.990283 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:26:37.997052 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:26:37.997052 [error] [MainThread]:   inner join 
[0m11:26:37.997052 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:26:37.997052 [error] [MainThread]:   on b.person_id = c.id
[0m11:26:37.997052 [error] [MainThread]:     '''), ParseException: 
[0m11:26:38.001482 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m11:26:38.001482 [error] [MainThread]:   
[0m11:26:38.001482 [error] [MainThread]:   == SQL ==
[0m11:26:38.001482 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m11:26:38.001482 [error] [MainThread]:   
[0m11:26:38.001482 [error] [MainThread]:     
[0m11:26:38.001482 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m11:26:38.001482 [error] [MainThread]:     using PARQUET
[0m11:26:38.001482 [error] [MainThread]:   	
[0m11:26:38.001482 [error] [MainThread]:   	
[0m11:26:38.001482 [error] [MainThread]:   	
[0m11:26:38.001482 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m11:26:38.001482 [error] [MainThread]:   	
[0m11:26:38.001482 [error] [MainThread]:   	as
[0m11:26:38.001482 [error] [MainThread]:   	select 
[0m11:26:38.001482 [error] [MainThread]:   distinct 
[0m11:26:38.017277 [error] [MainThread]:   a.name as organization_name, 
[0m11:26:38.017782 [error] [MainThread]:   a.type as organization_type, 
[0m11:26:38.017782 [error] [MainThread]:   b.role as role, 
[0m11:26:38.025376 [error] [MainThread]:   c.name as person_name 
[0m11:26:38.025872 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:26:38.025872 [error] [MainThread]:   --------^^^
[0m11:26:38.025872 [error] [MainThread]:   inner join 
[0m11:26:38.028941 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:26:38.029851 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:26:38.030337 [error] [MainThread]:   inner join 
[0m11:26:38.030337 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:26:38.030337 [error] [MainThread]:   on b.person_id = c.id
[0m11:26:38.030337 [error] [MainThread]:     
[0m11:26:38.030337 [error] [MainThread]:   
[0m11:26:38.030337 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m11:26:38.030337 [info ] [MainThread]: 
[0m11:26:38.030337 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m11:26:38.030337 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m11:26:38.040198 [error] [MainThread]:   
[0m11:26:38.041093 [error] [MainThread]:     
[0m11:26:38.041093 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m11:26:38.050131 [error] [MainThread]:     using PARQUET
[0m11:26:38.050131 [error] [MainThread]:   	
[0m11:26:38.050131 [error] [MainThread]:   	
[0m11:26:38.052571 [error] [MainThread]:   	
[0m11:26:38.052571 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m11:26:38.052571 [error] [MainThread]:   	
[0m11:26:38.052571 [error] [MainThread]:   	as
[0m11:26:38.052571 [error] [MainThread]:   	select 
[0m11:26:38.052571 [error] [MainThread]:   distinct 
[0m11:26:38.058556 [error] [MainThread]:   a.name as organization_name, 
[0m11:26:38.058556 [error] [MainThread]:   a.type as organization_type, 
[0m11:26:38.058556 [error] [MainThread]:   b.role as role, 
[0m11:26:38.058556 [error] [MainThread]:   c.name as person_name,
[0m11:26:38.058556 [error] [MainThread]:   d.name as event_name
[0m11:26:38.058556 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:26:38.069514 [error] [MainThread]:   inner join 
[0m11:26:38.069514 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:26:38.069514 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:26:38.069514 [error] [MainThread]:   inner join 
[0m11:26:38.072724 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:26:38.072724 [error] [MainThread]:   on b.person_id = c.id
[0m11:26:38.072724 [error] [MainThread]:   inner join 
[0m11:26:38.076132 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m11:26:38.078237 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m11:26:38.078237 [error] [MainThread]:     '''), ParseException: 
[0m11:26:38.078237 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m11:26:38.084647 [error] [MainThread]:   
[0m11:26:38.084647 [error] [MainThread]:   == SQL ==
[0m11:26:38.084647 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m11:26:38.084647 [error] [MainThread]:   
[0m11:26:38.084647 [error] [MainThread]:     
[0m11:26:38.084647 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m11:26:38.084647 [error] [MainThread]:     using PARQUET
[0m11:26:38.091318 [error] [MainThread]:   	
[0m11:26:38.091493 [error] [MainThread]:   	
[0m11:26:38.091493 [error] [MainThread]:   	
[0m11:26:38.091493 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m11:26:38.101129 [error] [MainThread]:   	
[0m11:26:38.101129 [error] [MainThread]:   	as
[0m11:26:38.101129 [error] [MainThread]:   	select 
[0m11:26:38.101129 [error] [MainThread]:   distinct 
[0m11:26:38.101129 [error] [MainThread]:   a.name as organization_name, 
[0m11:26:38.101129 [error] [MainThread]:   a.type as organization_type, 
[0m11:26:38.101129 [error] [MainThread]:   b.role as role, 
[0m11:26:38.101129 [error] [MainThread]:   c.name as person_name,
[0m11:26:38.101129 [error] [MainThread]:   d.name as event_name
[0m11:26:38.101129 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:26:38.101129 [error] [MainThread]:   --------^^^
[0m11:26:38.101129 [error] [MainThread]:   inner join 
[0m11:26:38.101129 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:26:38.111674 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:26:38.114143 [error] [MainThread]:   inner join 
[0m11:26:38.114143 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:26:38.114143 [error] [MainThread]:   on b.person_id = c.id
[0m11:26:38.114143 [error] [MainThread]:   inner join 
[0m11:26:38.114143 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m11:26:38.114143 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m11:26:38.114143 [error] [MainThread]:     
[0m11:26:38.114143 [error] [MainThread]:   
[0m11:26:38.114143 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m11:26:38.114143 [info ] [MainThread]: 
[0m11:26:38.114143 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m11:26:38.114143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA20636890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA20616350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2059C910>]}
[0m11:26:38.114143 [debug] [MainThread]: Flushing usage events
[0m11:26:39.243646 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 11:45:41.991207 | bfdf36ae-82d7-4171-a22d-f230c7f75bcd ==============================
[0m11:45:41.991207 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:45:41.996124 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m11:45:41.997117 [debug] [MainThread]: Tracking: tracking
[0m11:45:42.023266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC39A7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC36D3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4184350>]}
[0m11:45:42.580099 [debug] [MainThread]: Executing "git --help"
[0m11:45:42.636004 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:45:42.636998 [debug] [MainThread]: STDERR: "b''"
[0m11:45:42.679684 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m11:45:42.681691 [debug] [MainThread]: Using glue connection "debug"
[0m11:45:42.682715 [debug] [MainThread]: On debug: select 1 as id
[0m11:45:42.683745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:42.683745 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m11:45:42.684667 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m11:45:42.685663 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m11:46:06.323397 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m11:46:06.324372 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-9b9b2710-f461-498c-bb35-b3727434cf94
[0m11:46:14.960312 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m11:46:14.961414 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m11:46:14.962194 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m11:46:14.962719 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:46:14.963071 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m11:46:28.895095 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685015174882, 'CompletedOn': 1685015187432}, 'ResponseMetadata': {'RequestId': '2925d8b7-5cc5-4798-9c91-83feeafdf3ef', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:46:28 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '2925d8b7-5cc5-4798-9c91-83feeafdf3ef'}, 'RetryAttempts': 0}}
[0m11:46:28.896161 [debug] [MainThread]: Glue adapter: status = ok
[0m11:46:28.897087 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m11:46:28.898401 [debug] [MainThread]: SQL status: OK in 46 seconds
[0m11:46:28.900793 [debug] [MainThread]: On debug: Close
[0m11:46:28.901722 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m11:46:28.908695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC517FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC3C55910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC3C55AD0>]}
[0m11:46:28.910693 [debug] [MainThread]: Flushing usage events
[0m11:46:29.887359 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 11:46:41.581737 | c5d221bd-36c2-481a-9c25-125fa35329bc ==============================
[0m11:46:41.581737 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:46:41.584728 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:46:41.584728 [debug] [MainThread]: Tracking: tracking
[0m11:46:41.603820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C95E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C96B9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C92DA950>]}
[0m11:46:41.636138 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:46:41.652165 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:41.653079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA22E410>]}
[0m11:46:43.795510 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m11:46:43.807866 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m11:46:43.918396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA28BE10>]}
[0m11:46:43.925374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA197950>]}
[0m11:46:43.926375 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m11:46:43.927363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C960CFD0>]}
[0m11:46:43.929358 [info ] [MainThread]: 
[0m11:46:43.932354 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m11:46:43.936297 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m11:46:43.937293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.937700 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m11:46:43.937700 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m11:46:43.938512 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m11:47:00.910425 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m11:47:00.911418 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4f7a1611-6dae-4974-a2ef-951ec5d10380
[0m11:47:08.214195 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m11:47:09.286160 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m11:47:09.288178 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m11:47:09.291559 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m11:47:09.292666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:09.293083 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m11:47:10.842818 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m11:47:10.842818 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m11:47:10.843815 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4f7a1611-6dae-4974-a2ef-951ec5d10380
[0m11:47:12.260758 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m11:47:13.307709 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m11:47:13.307709 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m11:47:13.309699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CABB9A90>]}
[0m11:47:13.309699 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m11:47:13.310659 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m11:47:13.311745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:13.312239 [info ] [MainThread]: 
[0m11:47:13.326092 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m11:47:13.328374 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m11:47:13.329414 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m11:47:13.330407 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m11:47:13.335479 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m11:47:13.337385 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 11:47:13.331410 => 2023-05-25 11:47:13.337385
[0m11:47:13.338380 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m11:47:13.351434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:47:13.352431 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m11:47:14.484506 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m11:47:14.485506 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m11:47:14.486504 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4f7a1611-6dae-4974-a2ef-951ec5d10380
[0m11:47:15.955587 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:17.053454 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m11:47:17.095443 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:17.100784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m11:47:17.101772 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m11:47:17.101772 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m11:47:17.102896 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  
[0m11:47:17.102896 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:17.104054 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m11:47:17.104054 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m11:47:17.105091 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:47:17.105091 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  ''')
[0m11:47:17.801938 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH source as (\n    select \n    distinct \n    a.name as organization_name, \n    a.type as organization_type, \n    b.role as role, \n    c.name as person_name \n    from poc-normalized-legislator.organizations as a \n    inner join \n    poc-normalized-legislator.memberships as b \n    on a.id=b.organization_id \n    inner join \n    poc-normalized-legislator.persons as c \n    on b.person_id = c.id\n)\nSELECT *\nFROM source\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH source as (\n    select \n    distinct \n    a.name as organization_name, \n    a.type as organization_type, \n    b.role as role, \n    c.name as person_name \n    from poc-normalized-legislator.organizations as a \n------------^^^\n    inner join \n    poc-normalized-legislator.memberships as b \n    on a.id=b.organization_id \n    inner join \n    poc-normalized-legislator.persons as c \n    on b.person_id = c.id\n)\nSELECT *\nFROM source\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH source as (\n    select \n    distinct \n    a.name as organization_name, \n    a.type as organization_type, \n    b.role as role, \n    c.name as person_name \n    from poc-normalized-legislator.organizations as a \n------------^^^\n    inner join \n    poc-normalized-legislator.memberships as b \n    on a.id=b.organization_id \n    inner join \n    poc-normalized-legislator.persons as c \n    on b.person_id = c.id\n)\nSELECT *\nFROM source\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685015237028, 'CompletedOn': 1685015237143}, 'ResponseMetadata': {'RequestId': '40358f31-4b8d-4755-9d65-9cd897dea8c0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:47:17 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3665', 'connection': 'keep-alive', 'x-amzn-requestid': '40358f31-4b8d-4755-9d65-9cd897dea8c0'}, 'RetryAttempts': 0}}
[0m11:47:17.802936 [debug] [Thread-1 (]: Glue adapter: status = error
[0m11:47:17.803974 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
------------^^^
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  

[0m11:47:17.805995 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
------------^^^
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  

[0m11:47:17.806610 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH source as (
    select 
    distinct 
    a.name as organization_name, 
    a.type as organization_type, 
    b.role as role, 
    c.name as person_name 
    from poc-normalized-legislator.organizations as a 
    inner join 
    poc-normalized-legislator.memberships as b 
    on a.id=b.organization_id 
    inner join 
    poc-normalized-legislator.persons as c 
    on b.person_id = c.id
)
SELECT *
FROM source
  
[0m11:47:17.807629 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m11:47:17.808289 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m11:47:17.808289 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m11:47:17.809450 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m11:47:17.809647 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 11:47:13.339414 => 2023-05-25 11:47:17.809647
[0m11:47:17.895221 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH source as (
      select 
      distinct 
      a.name as organization_name, 
      a.type as organization_type, 
      b.role as role, 
      c.name as person_name 
      from poc-normalized-legislator.organizations as a 
      inner join 
      poc-normalized-legislator.memberships as b 
      on a.id=b.organization_id 
      inner join 
      poc-normalized-legislator.persons as c 
      on b.person_id = c.id
  )
  SELECT *
  FROM source
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH source as (
      select 
      distinct 
      a.name as organization_name, 
      a.type as organization_type, 
      b.role as role, 
      c.name as person_name 
      from poc-normalized-legislator.organizations as a 
  ------------^^^
      inner join 
      poc-normalized-legislator.memberships as b 
      on a.id=b.organization_id 
      inner join 
      poc-normalized-legislator.persons as c 
      on b.person_id = c.id
  )
  SELECT *
  FROM source
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m11:47:17.896254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA17CF10>]}
[0m11:47:17.896254 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.57s]
[0m11:47:17.901278 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m11:47:17.902198 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m11:47:17.904282 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m11:47:17.906378 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m11:47:17.906378 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m11:47:17.914339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m11:47:17.915419 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 11:47:17.908347 => 2023-05-25 11:47:17.915419
[0m11:47:17.916330 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m11:47:17.919402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:17.920316 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m11:47:18.990121 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m11:47:18.991118 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m11:47:18.991118 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4f7a1611-6dae-4974-a2ef-951ec5d10380
[0m11:47:20.325111 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:21.384927 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m11:47:21.399090 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:21.400171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m11:47:21.402086 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m11:47:21.402086 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m11:47:21.402086 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m11:47:21.403312 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m11:47:21.403312 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m11:47:21.404359 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m11:47:21.404359 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:47:21.405353 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m11:47:22.087349 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685015241310, 'CompletedOn': 1685015241344}, 'ResponseMetadata': {'RequestId': '0dca2010-ec6f-4471-9e9e-1fdb97d2ec3f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:47:21 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3769', 'connection': 'keep-alive', 'x-amzn-requestid': '0dca2010-ec6f-4471-9e9e-1fdb97d2ec3f'}, 'RetryAttempts': 0}}
[0m11:47:22.087349 [debug] [Thread-1 (]: Glue adapter: status = error
[0m11:47:22.088429 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m11:47:22.090111 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m11:47:22.090841 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m11:47:22.092094 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m11:47:22.092593 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m11:47:22.093385 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m11:47:22.093385 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m11:47:22.094885 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 11:47:17.917326 => 2023-05-25 11:47:22.094815
[0m11:47:22.098649 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m11:47:22.099826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d221bd-36c2-481a-9c25-125fa35329bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA79A950>]}
[0m11:47:22.100643 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.19s]
[0m11:47:22.103021 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m11:47:22.105068 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m11:47:22.106855 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:22.107355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:22.107355 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m11:47:23.087591 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m11:47:23.087591 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m11:47:23.087591 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-4f7a1611-6dae-4974-a2ef-951ec5d10380
[0m11:47:24.423650 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m11:47:24.424779 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m11:47:24.425705 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m11:47:24.425705 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:24.426735 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m11:47:24.427885 [debug] [MainThread]: On master: Close
[0m11:47:24.427885 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m11:47:24.429697 [debug] [MainThread]: Glue adapter: cleanup called
[0m11:47:24.889121 [info ] [MainThread]: 
[0m11:47:24.891086 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 40.96 seconds (40.96s).
[0m11:47:24.895081 [debug] [MainThread]: Command end result
[0m11:47:24.904451 [info ] [MainThread]: 
[0m11:47:24.904658 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:47:24.908764 [info ] [MainThread]: 
[0m11:47:24.909779 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m11:47:24.910755 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m11:47:24.911748 [error] [MainThread]:   
[0m11:47:24.912745 [error] [MainThread]:     
[0m11:47:24.913872 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m11:47:24.918897 [error] [MainThread]:     using PARQUET
[0m11:47:24.924092 [error] [MainThread]:   	
[0m11:47:24.925093 [error] [MainThread]:   	
[0m11:47:24.929298 [error] [MainThread]:   	
[0m11:47:24.931718 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m11:47:24.932725 [error] [MainThread]:   	
[0m11:47:24.937187 [error] [MainThread]:   	as
[0m11:47:24.939190 [error] [MainThread]:   	WITH source as (
[0m11:47:24.940390 [error] [MainThread]:       select 
[0m11:47:24.941546 [error] [MainThread]:       distinct 
[0m11:47:24.943562 [error] [MainThread]:       a.name as organization_name, 
[0m11:47:24.945371 [error] [MainThread]:       a.type as organization_type, 
[0m11:47:24.953759 [error] [MainThread]:       b.role as role, 
[0m11:47:24.962673 [error] [MainThread]:       c.name as person_name 
[0m11:47:24.963648 [error] [MainThread]:       from poc-normalized-legislator.organizations as a 
[0m11:47:24.964642 [error] [MainThread]:       inner join 
[0m11:47:24.965645 [error] [MainThread]:       poc-normalized-legislator.memberships as b 
[0m11:47:24.966636 [error] [MainThread]:       on a.id=b.organization_id 
[0m11:47:24.967639 [error] [MainThread]:       inner join 
[0m11:47:24.970637 [error] [MainThread]:       poc-normalized-legislator.persons as c 
[0m11:47:24.977116 [error] [MainThread]:       on b.person_id = c.id
[0m11:47:24.984085 [error] [MainThread]:   )
[0m11:47:24.985208 [error] [MainThread]:   SELECT *
[0m11:47:24.986122 [error] [MainThread]:   FROM source
[0m11:47:24.987090 [error] [MainThread]:     '''), ParseException: 
[0m11:47:24.988110 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 12)
[0m11:47:24.989071 [error] [MainThread]:   
[0m11:47:24.990066 [error] [MainThread]:   == SQL ==
[0m11:47:24.994107 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m11:47:24.995052 [error] [MainThread]:   
[0m11:47:25.001085 [error] [MainThread]:     
[0m11:47:25.003050 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m11:47:25.004019 [error] [MainThread]:     using PARQUET
[0m11:47:25.005017 [error] [MainThread]:   	
[0m11:47:25.006014 [error] [MainThread]:   	
[0m11:47:25.007416 [error] [MainThread]:   	
[0m11:47:25.010723 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m11:47:25.016696 [error] [MainThread]:   	
[0m11:47:25.017693 [error] [MainThread]:   	as
[0m11:47:25.018705 [error] [MainThread]:   	WITH source as (
[0m11:47:25.019686 [error] [MainThread]:       select 
[0m11:47:25.020685 [error] [MainThread]:       distinct 
[0m11:47:25.021737 [error] [MainThread]:       a.name as organization_name, 
[0m11:47:25.023795 [error] [MainThread]:       a.type as organization_type, 
[0m11:47:25.033676 [error] [MainThread]:       b.role as role, 
[0m11:47:25.035633 [error] [MainThread]:       c.name as person_name 
[0m11:47:25.036634 [error] [MainThread]:       from poc-normalized-legislator.organizations as a 
[0m11:47:25.037408 [error] [MainThread]:   ------------^^^
[0m11:47:25.039631 [error] [MainThread]:       inner join 
[0m11:47:25.044689 [error] [MainThread]:       poc-normalized-legislator.memberships as b 
[0m11:47:25.046685 [error] [MainThread]:       on a.id=b.organization_id 
[0m11:47:25.050640 [error] [MainThread]:       inner join 
[0m11:47:25.052004 [error] [MainThread]:       poc-normalized-legislator.persons as c 
[0m11:47:25.052549 [error] [MainThread]:       on b.person_id = c.id
[0m11:47:25.053552 [error] [MainThread]:   )
[0m11:47:25.054541 [error] [MainThread]:   SELECT *
[0m11:47:25.063513 [error] [MainThread]:   FROM source
[0m11:47:25.064312 [error] [MainThread]:     
[0m11:47:25.065332 [error] [MainThread]:   
[0m11:47:25.066312 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m11:47:25.067314 [info ] [MainThread]: 
[0m11:47:25.068323 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m11:47:25.069410 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m11:47:25.070455 [error] [MainThread]:   
[0m11:47:25.078416 [error] [MainThread]:     
[0m11:47:25.079469 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m11:47:25.080547 [error] [MainThread]:     using PARQUET
[0m11:47:25.081419 [error] [MainThread]:   	
[0m11:47:25.082404 [error] [MainThread]:   	
[0m11:47:25.083399 [error] [MainThread]:   	
[0m11:47:25.084413 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m11:47:25.085393 [error] [MainThread]:   	
[0m11:47:25.086765 [error] [MainThread]:   	as
[0m11:47:25.090122 [error] [MainThread]:   	select 
[0m11:47:25.095101 [error] [MainThread]:   distinct 
[0m11:47:25.098439 [error] [MainThread]:   a.name as organization_name, 
[0m11:47:25.099437 [error] [MainThread]:   a.type as organization_type, 
[0m11:47:25.100504 [error] [MainThread]:   b.role as role, 
[0m11:47:25.104812 [error] [MainThread]:   c.name as person_name,
[0m11:47:25.113552 [error] [MainThread]:   d.name as event_name
[0m11:47:25.114548 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:47:25.115546 [error] [MainThread]:   inner join 
[0m11:47:25.117538 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:47:25.118535 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:47:25.119566 [error] [MainThread]:   inner join 
[0m11:47:25.120223 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:47:25.121368 [error] [MainThread]:   on b.person_id = c.id
[0m11:47:25.122642 [error] [MainThread]:   inner join 
[0m11:47:25.123677 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m11:47:25.125743 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m11:47:25.133065 [error] [MainThread]:     '''), ParseException: 
[0m11:47:25.136098 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m11:47:25.140449 [error] [MainThread]:   
[0m11:47:25.141423 [error] [MainThread]:   == SQL ==
[0m11:47:25.143439 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m11:47:25.144428 [error] [MainThread]:   
[0m11:47:25.145429 [error] [MainThread]:     
[0m11:47:25.146432 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m11:47:25.147427 [error] [MainThread]:     using PARQUET
[0m11:47:25.148419 [error] [MainThread]:   	
[0m11:47:25.154421 [error] [MainThread]:   	
[0m11:47:25.160399 [error] [MainThread]:   	
[0m11:47:25.161477 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m11:47:25.162419 [error] [MainThread]:   	
[0m11:47:25.163390 [error] [MainThread]:   	as
[0m11:47:25.165027 [error] [MainThread]:   	select 
[0m11:47:25.167026 [error] [MainThread]:   distinct 
[0m11:47:25.172500 [error] [MainThread]:   a.name as organization_name, 
[0m11:47:25.173480 [error] [MainThread]:   a.type as organization_type, 
[0m11:47:25.174477 [error] [MainThread]:   b.role as role, 
[0m11:47:25.175478 [error] [MainThread]:   c.name as person_name,
[0m11:47:25.177478 [error] [MainThread]:   d.name as event_name
[0m11:47:25.178303 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m11:47:25.179497 [error] [MainThread]:   --------^^^
[0m11:47:25.180716 [error] [MainThread]:   inner join 
[0m11:47:25.187699 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m11:47:25.188711 [error] [MainThread]:   on a.id=b.organization_id 
[0m11:47:25.190892 [error] [MainThread]:   inner join 
[0m11:47:25.192030 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m11:47:25.192030 [error] [MainThread]:   on b.person_id = c.id
[0m11:47:25.193026 [error] [MainThread]:   inner join 
[0m11:47:25.194102 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m11:47:25.195020 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m11:47:25.200151 [error] [MainThread]:     
[0m11:47:25.203910 [error] [MainThread]:   
[0m11:47:25.204712 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m11:47:25.205494 [info ] [MainThread]: 
[0m11:47:25.206537 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m11:47:25.207568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CABD9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CA1D9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CACEC0D0>]}
[0m11:47:25.208725 [debug] [MainThread]: Flushing usage events
[0m11:47:26.264200 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 11:52:45.323741 | 7e0ddc4a-e453-4d0c-80fe-6878326149ab ==============================
[0m11:52:45.323741 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:52:45.327277 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m11:52:45.328276 [debug] [MainThread]: Tracking: tracking
[0m11:52:45.348545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA9F22AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA8FC2AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA73013D0>]}
[0m11:52:45.642709 [debug] [MainThread]: Executing "git --help"
[0m11:52:45.694669 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:52:45.695767 [debug] [MainThread]: STDERR: "b''"
[0m11:52:45.730096 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m11:52:45.731087 [debug] [MainThread]: Using glue connection "debug"
[0m11:52:45.731087 [debug] [MainThread]: On debug: select 1 as id
[0m11:52:45.731087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:45.732083 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m11:52:45.732460 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m11:52:45.732460 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m11:53:08.586822 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m11:53:08.587800 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bf1be5e9-4dba-4a71-8764-078fbf7130f7
[0m11:53:16.873700 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m11:53:16.875213 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m11:53:16.876146 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m11:53:16.877174 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m11:53:16.877701 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m11:53:22.912000 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685015596786, 'CompletedOn': 1685015601331}, 'ResponseMetadata': {'RequestId': '815bfe65-207f-4287-9157-1f1c5fe2c67f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 11:53:22 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '815bfe65-207f-4287-9157-1f1c5fe2c67f'}, 'RetryAttempts': 0}}
[0m11:53:22.912995 [debug] [MainThread]: Glue adapter: status = ok
[0m11:53:22.913919 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m11:53:22.913919 [debug] [MainThread]: SQL status: OK in 37 seconds
[0m11:53:22.916980 [debug] [MainThread]: On debug: Close
[0m11:53:22.916980 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m11:53:22.926952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA9F83F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAA41D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA9F2C290>]}
[0m11:53:22.928948 [debug] [MainThread]: Flushing usage events
[0m11:53:23.940897 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 11:53:32.475573 | 96d6911a-fc59-4996-8a5d-d1afb87a076a ==============================
[0m11:53:32.475573 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:53:32.477571 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:53:32.478558 [debug] [MainThread]: Tracking: tracking
[0m11:53:32.498073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029482512910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294816D76D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294825135D0>]}
[0m11:53:32.530714 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m11:53:32.612817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948263C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948263C690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948263C2D0>]}
[0m11:53:32.613814 [debug] [MainThread]: Flushing usage events
[0m11:53:33.686518 [debug] [MainThread]: Glue adapter: cleanup called
[0m11:53:33.687575 [debug] [MainThread]: Glue adapter: connection not yet initialized
[0m11:53:33.687575 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtgluepoc: source_tables.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: data_source
    5  |     schema: `poc-normalized-legislator`
    6  | 
    7  |     tables:
    8  |       - name: `organizations`
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 5, column 13


============================== 2023-05-25 11:59:28.379427 | efe3fce5-e86e-4d4f-9b8f-fb14398784f9 ==============================
[0m11:59:28.379427 [info ] [MainThread]: Running with dbt=1.4.6
[0m11:59:28.382506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m11:59:28.382506 [debug] [MainThread]: Tracking: tracking
[0m11:59:28.402739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E71BF0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E70FB190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E71BD650>]}
[0m11:59:28.673830 [debug] [MainThread]: Executing "git --help"
[0m11:59:28.724233 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:59:28.725545 [debug] [MainThread]: STDERR: "b''"
[0m11:59:28.764621 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m11:59:28.764621 [debug] [MainThread]: Using glue connection "debug"
[0m11:59:28.765619 [debug] [MainThread]: On debug: select 1 as id
[0m11:59:28.765619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:28.766628 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m11:59:28.767612 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m11:59:28.767612 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m11:59:51.356936 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m11:59:51.356936 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-39ffdc23-3bc0-4359-80ef-aec723f2d033
[0m12:00:00.984730 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m12:00:00.985686 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m12:00:00.986754 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m12:00:00.986754 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:00:00.987586 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m12:00:07.216214 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685016000927, 'CompletedOn': 1685016005802}, 'ResponseMetadata': {'RequestId': '2a9f334e-f787-4b59-82c3-d811a3586e9e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:00:06 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '2a9f334e-f787-4b59-82c3-d811a3586e9e'}, 'RetryAttempts': 0}}
[0m12:00:07.216214 [debug] [MainThread]: Glue adapter: status = ok
[0m12:00:07.217212 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m12:00:07.217212 [debug] [MainThread]: SQL status: OK in 38 seconds
[0m12:00:07.218948 [debug] [MainThread]: On debug: Close
[0m12:00:07.218948 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:00:07.226099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E7FE3F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E7FE31D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E8007690>]}
[0m12:00:07.228089 [debug] [MainThread]: Flushing usage events
[0m12:00:08.101627 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:00:29.787360 | 5c3c331d-f79f-410b-ada2-220e26814a01 ==============================
[0m12:00:29.787360 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:00:29.789327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:00:29.789327 [debug] [MainThread]: Tracking: tracking
[0m12:00:29.804128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585026C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585B39450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585B33E90>]}
[0m12:00:29.820416 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:00:29.827357 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:00:29.827357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585C5E8D0>]}
[0m12:00:31.309011 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m12:00:31.318128 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m12:00:31.405028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5850E29D0>]}
[0m12:00:31.412004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585C46290>]}
[0m12:00:31.412004 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m12:00:31.413001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585B7C6D0>]}
[0m12:00:31.414002 [info ] [MainThread]: 
[0m12:00:31.415993 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:00:31.418980 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m12:00:31.418980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:31.419977 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:00:31.419977 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:00:31.419977 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:00:48.324108 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:00:48.325117 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bdbc44db-3933-4981-91f1-2e897dec469a
[0m12:00:54.992359 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:00:56.036524 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m12:00:56.037532 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:00:56.038517 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m12:00:56.039514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:56.039514 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:00:57.067394 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m12:00:57.067394 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:00:57.067394 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bdbc44db-3933-4981-91f1-2e897dec469a
[0m12:00:58.459461 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:00:59.477020 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m12:00:59.478008 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:00:59.480004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D584FCEE10>]}
[0m12:00:59.480927 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:00:59.480927 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:00:59.481935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:59.482918 [info ] [MainThread]: 
[0m12:00:59.489893 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m12:00:59.490898 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m12:00:59.491886 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m12:00:59.491886 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m12:00:59.494885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m12:00:59.495889 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 12:00:59.491886 => 2023-05-25 12:00:59.495889
[0m12:00:59.495889 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m12:00:59.503846 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:59.503846 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:01:00.553237 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:01:00.554238 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:01:00.555239 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bdbc44db-3933-4981-91f1-2e897dec469a
[0m12:01:01.885667 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:03.003675 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m12:01:03.036677 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:03.041208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m12:01:03.042205 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:01:03.042205 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m12:01:03.043202 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:01:03.043202 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:03.043202 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:01:03.044201 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:01:03.044201 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:01:03.044201 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m12:01:03.705084 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685016062958, 'CompletedOn': 1685016063076}, 'ResponseMetadata': {'RequestId': '90c65506-0c6e-430a-a218-4b5239f635e5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:01:03 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3379', 'connection': 'keep-alive', 'x-amzn-requestid': '90c65506-0c6e-430a-a218-4b5239f635e5'}, 'RetryAttempts': 0}}
[0m12:01:03.705084 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:01:03.707076 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:01:03.708100 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:01:03.709066 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:01:03.709066 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m12:01:03.709066 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:01:03.710163 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m12:01:03.711158 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:01:03.711158 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 12:00:59.495889 => 2023-05-25 12:01:03.711158
[0m12:01:03.781191 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:01:03.781191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5861D8490>]}
[0m12:01:03.782196 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.29s]
[0m12:01:03.784186 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m12:01:03.784980 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m12:01:03.784980 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m12:01:03.789406 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m12:01:03.789406 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m12:01:03.793401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:01:03.795385 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 12:01:03.790412 => 2023-05-25 12:01:03.795385
[0m12:01:03.796054 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m12:01:03.797365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:03.799369 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:01:05.087903 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:01:05.088907 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:01:05.089822 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bdbc44db-3933-4981-91f1-2e897dec469a
[0m12:01:06.431496 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:07.496497 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m12:01:07.502665 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:07.504178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:01:07.505104 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:01:07.506100 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m12:01:07.506100 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:01:07.506100 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:01:07.506100 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:01:07.507097 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:01:07.507326 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:01:07.507326 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m12:01:08.159563 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685016067416, 'CompletedOn': 1685016067452}, 'ResponseMetadata': {'RequestId': '186722b7-4420-4fa5-bc88-7c0faa07e000', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:01:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3781', 'connection': 'keep-alive', 'x-amzn-requestid': '186722b7-4420-4fa5-bc88-7c0faa07e000'}, 'RetryAttempts': 0}}
[0m12:01:08.159563 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:01:08.160533 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:01:08.161474 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:01:08.161474 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:01:08.162470 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m12:01:08.163463 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:01:08.163463 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m12:01:08.163463 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:01:08.164526 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 12:01:03.796054 => 2023-05-25 12:01:08.164459
[0m12:01:08.166576 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:01:08.166576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3c331d-f79f-410b-ada2-220e26814a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D585005A90>]}
[0m12:01:08.167572 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.38s]
[0m12:01:08.167572 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m12:01:08.170679 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:01:08.171676 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:08.171676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:08.171676 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:01:09.209571 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m12:01:09.210567 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:01:09.211491 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-bdbc44db-3933-4981-91f1-2e897dec469a
[0m12:01:10.557509 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:01:10.557509 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:01:10.558512 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:01:10.559502 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:10.559502 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:01:10.559502 [debug] [MainThread]: On master: Close
[0m12:01:10.559502 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:01:10.560499 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:01:10.991366 [info ] [MainThread]: 
[0m12:01:10.993421 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 39.58 seconds (39.58s).
[0m12:01:10.996659 [debug] [MainThread]: Command end result
[0m12:01:11.004642 [info ] [MainThread]: 
[0m12:01:11.005629 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:01:11.006629 [info ] [MainThread]: 
[0m12:01:11.006629 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m12:01:11.007623 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:01:11.007623 [error] [MainThread]:   
[0m12:01:11.008717 [error] [MainThread]:     
[0m12:01:11.013213 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m12:01:11.014244 [error] [MainThread]:     using PARQUET
[0m12:01:11.015205 [error] [MainThread]:   	
[0m12:01:11.015697 [error] [MainThread]:   	
[0m12:01:11.015697 [error] [MainThread]:   	
[0m12:01:11.015697 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:01:11.016744 [error] [MainThread]:   	
[0m12:01:11.016744 [error] [MainThread]:   	as
[0m12:01:11.017740 [error] [MainThread]:   	select 
[0m12:01:11.017740 [error] [MainThread]:   distinct 
[0m12:01:11.018809 [error] [MainThread]:   a.name as organization_name, 
[0m12:01:11.018809 [error] [MainThread]:   a.type as organization_type, 
[0m12:01:11.020003 [error] [MainThread]:   b.role as role, 
[0m12:01:11.021991 [error] [MainThread]:   c.name as person_name 
[0m12:01:11.021991 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:01:11.022989 [error] [MainThread]:   inner join 
[0m12:01:11.022989 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:01:11.023984 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:01:11.028976 [error] [MainThread]:   inner join 
[0m12:01:11.029967 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:01:11.029967 [error] [MainThread]:   on b.person_id = c.id
[0m12:01:11.030962 [error] [MainThread]:     '''), ParseException: 
[0m12:01:11.031641 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m12:01:11.031641 [error] [MainThread]:   
[0m12:01:11.032640 [error] [MainThread]:   == SQL ==
[0m12:01:11.032640 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:01:11.033651 [error] [MainThread]:   
[0m12:01:11.033651 [error] [MainThread]:     
[0m12:01:11.034634 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m12:01:11.034634 [error] [MainThread]:     using PARQUET
[0m12:01:11.035669 [error] [MainThread]:   	
[0m12:01:11.035669 [error] [MainThread]:   	
[0m12:01:11.036738 [error] [MainThread]:   	
[0m12:01:11.037725 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:01:11.037725 [error] [MainThread]:   	
[0m12:01:11.038619 [error] [MainThread]:   	as
[0m12:01:11.038619 [error] [MainThread]:   	select 
[0m12:01:11.039677 [error] [MainThread]:   distinct 
[0m12:01:11.044168 [error] [MainThread]:   a.name as organization_name, 
[0m12:01:11.044168 [error] [MainThread]:   a.type as organization_type, 
[0m12:01:11.045384 [error] [MainThread]:   b.role as role, 
[0m12:01:11.045881 [error] [MainThread]:   c.name as person_name 
[0m12:01:11.045881 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:01:11.045881 [error] [MainThread]:   --------^^^
[0m12:01:11.046882 [error] [MainThread]:   inner join 
[0m12:01:11.046882 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:01:11.046882 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:01:11.047880 [error] [MainThread]:   inner join 
[0m12:01:11.047880 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:01:11.048876 [error] [MainThread]:   on b.person_id = c.id
[0m12:01:11.048876 [error] [MainThread]:     
[0m12:01:11.049873 [error] [MainThread]:   
[0m12:01:11.049873 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:01:11.049873 [info ] [MainThread]: 
[0m12:01:11.050955 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m12:01:11.050955 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:01:11.051984 [error] [MainThread]:   
[0m12:01:11.051984 [error] [MainThread]:     
[0m12:01:11.052925 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m12:01:11.053989 [error] [MainThread]:     using PARQUET
[0m12:01:11.053989 [error] [MainThread]:   	
[0m12:01:11.054985 [error] [MainThread]:   	
[0m12:01:11.058972 [error] [MainThread]:   	
[0m12:01:11.059969 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:01:11.059969 [error] [MainThread]:   	
[0m12:01:11.059969 [error] [MainThread]:   	as
[0m12:01:11.060966 [error] [MainThread]:   	select 
[0m12:01:11.060966 [error] [MainThread]:   distinct 
[0m12:01:11.061962 [error] [MainThread]:   a.name as organization_name, 
[0m12:01:11.061962 [error] [MainThread]:   a.type as organization_type, 
[0m12:01:11.061962 [error] [MainThread]:   b.role as role, 
[0m12:01:11.062959 [error] [MainThread]:   c.name as person_name,
[0m12:01:11.062959 [error] [MainThread]:   d.name as event_name
[0m12:01:11.062959 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:01:11.063955 [error] [MainThread]:   inner join 
[0m12:01:11.063955 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:01:11.063955 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:01:11.063955 [error] [MainThread]:   inner join 
[0m12:01:11.064952 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:01:11.064952 [error] [MainThread]:   on b.person_id = c.id
[0m12:01:11.065949 [error] [MainThread]:   inner join 
[0m12:01:11.065949 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:01:11.065949 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:01:11.066946 [error] [MainThread]:     '''), ParseException: 
[0m12:01:11.066946 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m12:01:11.066946 [error] [MainThread]:   
[0m12:01:11.067942 [error] [MainThread]:   == SQL ==
[0m12:01:11.067942 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:01:11.067942 [error] [MainThread]:   
[0m12:01:11.068939 [error] [MainThread]:     
[0m12:01:11.068939 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m12:01:11.069936 [error] [MainThread]:     using PARQUET
[0m12:01:11.070933 [error] [MainThread]:   	
[0m12:01:11.075919 [error] [MainThread]:   	
[0m12:01:11.076912 [error] [MainThread]:   	
[0m12:01:11.076912 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:01:11.076912 [error] [MainThread]:   	
[0m12:01:11.077908 [error] [MainThread]:   	as
[0m12:01:11.077908 [error] [MainThread]:   	select 
[0m12:01:11.077908 [error] [MainThread]:   distinct 
[0m12:01:11.078905 [error] [MainThread]:   a.name as organization_name, 
[0m12:01:11.078905 [error] [MainThread]:   a.type as organization_type, 
[0m12:01:11.078905 [error] [MainThread]:   b.role as role, 
[0m12:01:11.079902 [error] [MainThread]:   c.name as person_name,
[0m12:01:11.079902 [error] [MainThread]:   d.name as event_name
[0m12:01:11.079902 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:01:11.080901 [error] [MainThread]:   --------^^^
[0m12:01:11.080901 [error] [MainThread]:   inner join 
[0m12:01:11.081895 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:01:11.081895 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:01:11.081895 [error] [MainThread]:   inner join 
[0m12:01:11.082892 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:01:11.083090 [error] [MainThread]:   on b.person_id = c.id
[0m12:01:11.083090 [error] [MainThread]:   inner join 
[0m12:01:11.083090 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:01:11.084090 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:01:11.084090 [error] [MainThread]:     
[0m12:01:11.084090 [error] [MainThread]:   
[0m12:01:11.084090 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:01:11.085086 [info ] [MainThread]: 
[0m12:01:11.085582 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:01:11.086704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D587816190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D587815610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D587816110>]}
[0m12:01:11.086704 [debug] [MainThread]: Flushing usage events
[0m12:01:12.077618 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:07:00.569574 | 655c0935-b16c-4a26-bede-0571c15df695 ==============================
[0m12:07:00.569574 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:07:00.572562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m12:07:00.572562 [debug] [MainThread]: Tracking: tracking
[0m12:07:00.590727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B792C86E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7931D3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B792C87410>]}
[0m12:07:00.601048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7929A3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B792C7EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7929CABD0>]}
[0m12:07:00.602044 [debug] [MainThread]: Flushing usage events


============================== 2023-05-25 12:07:09.832445 | 2ca9d3ea-07f6-4e37-9894-58c3abaf7a28 ==============================
[0m12:07:09.832445 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:07:09.834437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:07:09.834437 [debug] [MainThread]: Tracking: tracking
[0m12:07:09.849757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D74FF6B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B26E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B16010>]}
[0m12:07:09.870834 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:07:09.871824 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:07:09.872820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B43A90>]}
[0m12:07:11.384155 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m12:07:11.394119 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m12:07:11.481458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75BD0D50>]}
[0m12:07:11.488798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75C43990>]}
[0m12:07:11.488798 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m12:07:11.489794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B59610>]}
[0m12:07:11.491795 [info ] [MainThread]: 
[0m12:07:11.493783 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:07:11.495782 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m12:07:11.495782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:11.496778 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:07:11.496778 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:07:11.496778 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:07:39.658782 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:07:39.660728 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-c1c6bc11-7213-4f96-aedd-c21e15f4faa3
[0m12:07:48.111643 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:07:49.186159 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m12:07:49.187156 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:07:49.191146 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m12:07:49.192142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:49.192142 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:07:50.241634 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m12:07:50.241634 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:07:50.242629 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-c1c6bc11-7213-4f96-aedd-c21e15f4faa3
[0m12:07:51.667238 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:07:52.724587 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m12:07:52.725582 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:07:52.726753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D76589510>]}
[0m12:07:52.727948 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:07:52.727948 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:07:52.729505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:52.729505 [info ] [MainThread]: 
[0m12:07:52.737806 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m12:07:52.738803 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m12:07:52.739801 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m12:07:52.739801 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m12:07:52.742799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m12:07:52.745844 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 12:07:52.739801 => 2023-05-25 12:07:52.745844
[0m12:07:52.746925 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m12:07:52.755971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:07:52.755971 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:07:53.803310 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:07:53.803310 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:07:53.803310 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-c1c6bc11-7213-4f96-aedd-c21e15f4faa3
[0m12:07:55.142487 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:07:56.244901 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m12:07:56.275261 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:07:56.279248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m12:07:56.281241 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:07:56.281241 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m12:07:56.282255 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:07:56.282255 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:07:56.282255 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:07:56.282255 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:07:56.283235 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:07:56.283235 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m12:07:56.969900 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685016476202, 'CompletedOn': 1685016476302}, 'ResponseMetadata': {'RequestId': '99439519-58ac-468e-869b-ecc7acb98b1f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:07:56 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3367', 'connection': 'keep-alive', 'x-amzn-requestid': '99439519-58ac-468e-869b-ecc7acb98b1f'}, 'RetryAttempts': 0}}
[0m12:07:56.969900 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:07:56.971892 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:07:56.972964 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:07:56.972964 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:07:56.973931 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m12:07:56.973931 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:07:56.974934 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m12:07:56.974934 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:07:56.974934 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 12:07:52.746925 => 2023-05-25 12:07:56.974934
[0m12:07:57.040570 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:07:57.040570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D766BE9D0>]}
[0m12:07:57.041483 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.30s]
[0m12:07:57.042478 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m12:07:57.043475 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m12:07:57.043475 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m12:07:57.045098 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m12:07:57.045098 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m12:07:57.048123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:07:57.049201 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 12:07:57.045098 => 2023-05-25 12:07:57.049201
[0m12:07:57.050124 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m12:07:57.052964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:57.053885 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:07:58.071475 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:07:58.071475 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:07:58.072475 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-c1c6bc11-7213-4f96-aedd-c21e15f4faa3
[0m12:08:00.726894 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:08:01.835867 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m12:08:01.840850 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:08:01.841847 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:08:01.842843 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:08:01.842843 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m12:08:01.842843 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:08:01.843840 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:08:01.843840 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:08:01.843840 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:08:01.843840 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:08:01.844837 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m12:08:02.550445 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685016481770, 'CompletedOn': 1685016481803}, 'ResponseMetadata': {'RequestId': '32391121-7776-4ceb-b74f-069574db063b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:08:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3769', 'connection': 'keep-alive', 'x-amzn-requestid': '32391121-7776-4ceb-b74f-069574db063b'}, 'RetryAttempts': 0}}
[0m12:08:02.550445 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:08:02.551505 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:08:02.552512 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:08:02.552512 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:08:02.552512 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m12:08:02.552512 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:08:02.553502 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m12:08:02.553798 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:08:02.553981 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 12:07:57.050124 => 2023-05-25 12:08:02.553981
[0m12:08:02.555997 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:08:02.555997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca9d3ea-07f6-4e37-9894-58c3abaf7a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75C1A1D0>]}
[0m12:08:02.556996 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 5.51s]
[0m12:08:02.558987 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m12:08:02.559974 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:08:02.560971 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:02.560971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:02.560971 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:08:03.568481 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m12:08:03.568481 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:08:03.568481 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-c1c6bc11-7213-4f96-aedd-c21e15f4faa3
[0m12:08:04.899502 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:08:04.899502 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:08:04.899502 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:08:04.901158 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:04.901625 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:08:04.901854 [debug] [MainThread]: On master: Close
[0m12:08:04.901854 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:08:04.902895 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:08:05.340188 [info ] [MainThread]: 
[0m12:08:05.341187 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 53.85 seconds (53.85s).
[0m12:08:05.343178 [debug] [MainThread]: Command end result
[0m12:08:05.350220 [info ] [MainThread]: 
[0m12:08:05.351370 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:08:05.351370 [info ] [MainThread]: 
[0m12:08:05.352370 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m12:08:05.352370 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:08:05.353367 [error] [MainThread]:   
[0m12:08:05.353886 [error] [MainThread]:     
[0m12:08:05.353886 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m12:08:05.354916 [error] [MainThread]:     using PARQUET
[0m12:08:05.355414 [error] [MainThread]:   	
[0m12:08:05.355414 [error] [MainThread]:   	
[0m12:08:05.356122 [error] [MainThread]:   	
[0m12:08:05.356122 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:08:05.357176 [error] [MainThread]:   	
[0m12:08:05.358174 [error] [MainThread]:   	as
[0m12:08:05.358174 [error] [MainThread]:   	select 
[0m12:08:05.359171 [error] [MainThread]:   distinct 
[0m12:08:05.359783 [error] [MainThread]:   a.name as organization_name, 
[0m12:08:05.359783 [error] [MainThread]:   a.type as organization_type, 
[0m12:08:05.360978 [error] [MainThread]:   b.role as role, 
[0m12:08:05.360978 [error] [MainThread]:   c.name as person_name 
[0m12:08:05.360978 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:08:05.361974 [error] [MainThread]:   inner join 
[0m12:08:05.361974 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:08:05.362970 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:08:05.369204 [error] [MainThread]:   inner join 
[0m12:08:05.370202 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:08:05.371198 [error] [MainThread]:   on b.person_id = c.id
[0m12:08:05.371198 [error] [MainThread]:     '''), ParseException: 
[0m12:08:05.371921 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m12:08:05.371921 [error] [MainThread]:   
[0m12:08:05.372929 [error] [MainThread]:   == SQL ==
[0m12:08:05.372929 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:08:05.374055 [error] [MainThread]:   
[0m12:08:05.374902 [error] [MainThread]:     
[0m12:08:05.375105 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m12:08:05.375105 [error] [MainThread]:     using PARQUET
[0m12:08:05.376299 [error] [MainThread]:   	
[0m12:08:05.376299 [error] [MainThread]:   	
[0m12:08:05.376852 [error] [MainThread]:   	
[0m12:08:05.377447 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:08:05.377447 [error] [MainThread]:   	
[0m12:08:05.378288 [error] [MainThread]:   	as
[0m12:08:05.378436 [error] [MainThread]:   	select 
[0m12:08:05.378436 [error] [MainThread]:   distinct 
[0m12:08:05.384169 [error] [MainThread]:   a.name as organization_name, 
[0m12:08:05.385233 [error] [MainThread]:   a.type as organization_type, 
[0m12:08:05.385233 [error] [MainThread]:   b.role as role, 
[0m12:08:05.385233 [error] [MainThread]:   c.name as person_name 
[0m12:08:05.386711 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:08:05.386711 [error] [MainThread]:   --------^^^
[0m12:08:05.387708 [error] [MainThread]:   inner join 
[0m12:08:05.388348 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:08:05.388348 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:08:05.389356 [error] [MainThread]:   inner join 
[0m12:08:05.389356 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:08:05.389356 [error] [MainThread]:   on b.person_id = c.id
[0m12:08:05.390377 [error] [MainThread]:     
[0m12:08:05.390377 [error] [MainThread]:   
[0m12:08:05.391351 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:08:05.391351 [info ] [MainThread]: 
[0m12:08:05.392349 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m12:08:05.392967 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:08:05.392967 [error] [MainThread]:   
[0m12:08:05.392967 [error] [MainThread]:     
[0m12:08:05.394093 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m12:08:05.398434 [error] [MainThread]:     using PARQUET
[0m12:08:05.399432 [error] [MainThread]:   	
[0m12:08:05.400752 [error] [MainThread]:   	
[0m12:08:05.401250 [error] [MainThread]:   	
[0m12:08:05.401750 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:08:05.401750 [error] [MainThread]:   	
[0m12:08:05.402678 [error] [MainThread]:   	as
[0m12:08:05.402831 [error] [MainThread]:   	select 
[0m12:08:05.402831 [error] [MainThread]:   distinct 
[0m12:08:05.403848 [error] [MainThread]:   a.name as organization_name, 
[0m12:08:05.403848 [error] [MainThread]:   a.type as organization_type, 
[0m12:08:05.404410 [error] [MainThread]:   b.role as role, 
[0m12:08:05.404410 [error] [MainThread]:   c.name as person_name,
[0m12:08:05.405439 [error] [MainThread]:   d.name as event_name
[0m12:08:05.405439 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:08:05.405439 [error] [MainThread]:   inner join 
[0m12:08:05.406433 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:08:05.406433 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:08:05.406433 [error] [MainThread]:   inner join 
[0m12:08:05.407429 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:08:05.407429 [error] [MainThread]:   on b.person_id = c.id
[0m12:08:05.408427 [error] [MainThread]:   inner join 
[0m12:08:05.408919 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:08:05.408919 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:08:05.413967 [error] [MainThread]:     '''), ParseException: 
[0m12:08:05.414975 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m12:08:05.414975 [error] [MainThread]:   
[0m12:08:05.415968 [error] [MainThread]:   == SQL ==
[0m12:08:05.415968 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:08:05.417055 [error] [MainThread]:   
[0m12:08:05.417055 [error] [MainThread]:     
[0m12:08:05.418227 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m12:08:05.418227 [error] [MainThread]:     using PARQUET
[0m12:08:05.419238 [error] [MainThread]:   	
[0m12:08:05.419238 [error] [MainThread]:   	
[0m12:08:05.420236 [error] [MainThread]:   	
[0m12:08:05.420236 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:08:05.420236 [error] [MainThread]:   	
[0m12:08:05.421232 [error] [MainThread]:   	as
[0m12:08:05.421232 [error] [MainThread]:   	select 
[0m12:08:05.422229 [error] [MainThread]:   distinct 
[0m12:08:05.422435 [error] [MainThread]:   a.name as organization_name, 
[0m12:08:05.423471 [error] [MainThread]:   a.type as organization_type, 
[0m12:08:05.423471 [error] [MainThread]:   b.role as role, 
[0m12:08:05.423471 [error] [MainThread]:   c.name as person_name,
[0m12:08:05.424467 [error] [MainThread]:   d.name as event_name
[0m12:08:05.424467 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:08:05.425716 [error] [MainThread]:   --------^^^
[0m12:08:05.429822 [error] [MainThread]:   inner join 
[0m12:08:05.430823 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:08:05.430823 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:08:05.431815 [error] [MainThread]:   inner join 
[0m12:08:05.431815 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:08:05.431815 [error] [MainThread]:   on b.person_id = c.id
[0m12:08:05.432810 [error] [MainThread]:   inner join 
[0m12:08:05.432810 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:08:05.433644 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:08:05.433644 [error] [MainThread]:     
[0m12:08:05.434569 [error] [MainThread]:   
[0m12:08:05.434793 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:08:05.435664 [info ] [MainThread]: 
[0m12:08:05.435664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:08:05.435664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75BFBF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B98090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D75B9AC10>]}
[0m12:08:05.435664 [debug] [MainThread]: Flushing usage events
[0m12:08:06.803550 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:44:06.704670 | 2dcae0ab-5af5-4ba9-8574-1e71eae3b34b ==============================
[0m12:44:06.704670 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:44:06.704670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m12:44:06.704670 [debug] [MainThread]: Tracking: tracking
[0m12:44:06.714422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027148C4E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027148D1A710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271493E2110>]}
[0m12:44:06.926040 [debug] [MainThread]: Executing "git --help"
[0m12:44:06.963263 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:44:06.963263 [debug] [MainThread]: STDERR: "b''"
[0m12:44:06.973984 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m12:44:06.973984 [debug] [MainThread]: Using glue connection "debug"
[0m12:44:06.973984 [debug] [MainThread]: On debug: select 1 as id
[0m12:44:06.973984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:06.973984 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:44:06.973984 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:44:06.973984 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:44:29.886216 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:44:29.886216 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-c222d812-cdc6-4970-bff2-0bed6b1166d4
[0m12:44:39.443777 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m12:44:39.443777 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m12:44:39.443777 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m12:44:39.443777 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:44:39.443777 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m12:44:44.116484 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685018679363, 'CompletedOn': 1685018683663}, 'ResponseMetadata': {'RequestId': '53ec980d-028b-4da7-9f97-fc5798f2dcc8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:44:43 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '53ec980d-028b-4da7-9f97-fc5798f2dcc8'}, 'RetryAttempts': 0}}
[0m12:44:44.116484 [debug] [MainThread]: Glue adapter: status = ok
[0m12:44:44.116484 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m12:44:44.116484 [debug] [MainThread]: SQL status: OK in 37 seconds
[0m12:44:44.116484 [debug] [MainThread]: On debug: Close
[0m12:44:44.132321 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:44:44.132321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027148C4D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714A3E7A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027148992FD0>]}
[0m12:44:44.132321 [debug] [MainThread]: Flushing usage events
[0m12:44:45.235649 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:44:55.664202 | b109bd98-03ac-4c7e-87b6-71c6ac3293c5 ==============================
[0m12:44:55.664202 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:44:55.664202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:44:55.664202 [debug] [MainThread]: Tracking: tracking
[0m12:44:55.679937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0621F80D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E061749C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E061BD9910>]}
[0m12:44:55.703997 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:44:55.719697 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:44:55.719697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0616DBB50>]}
[0m12:44:56.888034 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m12:44:56.903736 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m12:44:56.982254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E06237B9D0>]}
[0m12:44:56.988460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0622ECB90>]}
[0m12:44:56.988460 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m12:44:56.988460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0622835D0>]}
[0m12:44:56.988460 [info ] [MainThread]: 
[0m12:44:56.988460 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:44:56.988460 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m12:44:56.988460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:56.988460 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:44:56.988460 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:44:56.988460 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:45:14.363187 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:45:14.363187 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5a232f31-26d4-4759-9a51-5a767483d96e
[0m12:45:25.187045 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:45:26.357779 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m12:45:26.357779 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:45:26.357779 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m12:45:26.357779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:26.357779 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:45:27.346785 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m12:45:27.346785 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:45:27.346785 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5a232f31-26d4-4759-9a51-5a767483d96e
[0m12:45:31.302346 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:45:32.389856 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m12:45:32.389856 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:45:32.389856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E06230E6D0>]}
[0m12:45:32.389856 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:32.389856 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:45:32.389856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:32.389856 [info ] [MainThread]: 
[0m12:45:32.405365 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m12:45:32.405365 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m12:45:32.405365 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m12:45:32.405365 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m12:45:32.405365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m12:45:32.405365 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 12:45:32.405365 => 2023-05-25 12:45:32.405365
[0m12:45:32.421246 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m12:45:32.421246 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:32.421246 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:45:33.456771 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:45:33.456771 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:45:33.456771 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5a232f31-26d4-4759-9a51-5a767483d96e
[0m12:45:37.490588 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:38.609280 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:38.640652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:38.640652 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m12:45:38.640652 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:38.640652 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685018738565, 'CompletedOn': 1685018738765}, 'ResponseMetadata': {'RequestId': 'f1c9c093-d1f0-4501-a73d-2aa7e8dbdf70', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:45:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3367', 'connection': 'keep-alive', 'x-amzn-requestid': 'f1c9c093-d1f0-4501-a73d-2aa7e8dbdf70'}, 'RetryAttempts': 0}}
[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:45:39.333318 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  

[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m12:45:39.333318 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:45:39.333318 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m12:45:39.333318 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:45:39.333318 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 12:45:32.421246 => 2023-05-25 12:45:39.333318
[0m12:45:39.396325 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:45:39.396325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E062CB4F10>]}
[0m12:45:39.396325 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.99s]
[0m12:45:39.396325 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m12:45:39.396325 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m12:45:39.396325 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m12:45:39.396325 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m12:45:39.396325 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m12:45:39.412140 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:45:39.412140 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 12:45:39.396325 => 2023-05-25 12:45:39.412140
[0m12:45:39.412140 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m12:45:39.412140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:39.412140 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:45:40.463857 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:45:40.463857 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:45:40.463857 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5a232f31-26d4-4759-9a51-5a767483d96e
[0m12:45:44.805595 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:46.271435 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m12:45:46.276418 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:46.277415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:45:46.278409 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:46.278409 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m12:45:46.279413 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:45:46.279413 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:45:46.279413 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:45:46.279413 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:46.280400 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:46.280400 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', 'pyspark.sql.utils.ParseException: \nPossibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n\n']}, 'Progress': 1.0, 'StartedOn': 1685018746200, 'CompletedOn': 1685018746318}, 'ResponseMetadata': {'RequestId': 'ca135e05-cd3e-42ae-a121-a968d5b8f1fe', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:45:46 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3769', 'connection': 'keep-alive', 'x-amzn-requestid': 'ca135e05-cd3e-42ae-a121-a968d5b8f1fe'}, 'RetryAttempts': 0}}
[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:45:46.957708 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: 
Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)

== SQL ==
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
--------^^^
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  

[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m12:45:46.957708 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:45:46.957708 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m12:45:46.957708 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:45:46.957708 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 12:45:39.412140 => 2023-05-25 12:45:46.957708
[0m12:45:46.957708 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: 
  Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
  
  == SQL ==
  /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  --------^^^
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:45:46.957708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b109bd98-03ac-4c7e-87b6-71c6ac3293c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E06282CF10>]}
[0m12:45:46.957708 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 7.56s]
[0m12:45:46.957708 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m12:45:46.973197 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:45:46.973197 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:46.973197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:46.973197 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:45:47.976306 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m12:45:47.976306 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:45:47.976306 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5a232f31-26d4-4759-9a51-5a767483d96e
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:45:52.002393 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:45:52.002393 [debug] [MainThread]: On master: Close
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:45:52.002393 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:45:52.426112 [info ] [MainThread]: 
[0m12:45:52.426112 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 55.44 seconds (55.44s).
[0m12:45:52.426112 [debug] [MainThread]: Command end result
[0m12:45:52.442000 [info ] [MainThread]: 
[0m12:45:52.442000 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:45:52.442000 [info ] [MainThread]: 
[0m12:45:52.442000 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m12:45:52.442000 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:45:52.442000 [error] [MainThread]:   
[0m12:45:52.442000 [error] [MainThread]:     
[0m12:45:52.442000 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m12:45:52.442000 [error] [MainThread]:     using PARQUET
[0m12:45:52.442000 [error] [MainThread]:   	
[0m12:45:52.442000 [error] [MainThread]:   	
[0m12:45:52.442000 [error] [MainThread]:   	
[0m12:45:52.442000 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:45:52.442000 [error] [MainThread]:   	
[0m12:45:52.442000 [error] [MainThread]:   	as
[0m12:45:52.442000 [error] [MainThread]:   	select 
[0m12:45:52.442000 [error] [MainThread]:   distinct 
[0m12:45:52.442000 [error] [MainThread]:   a.name as organization_name, 
[0m12:45:52.442000 [error] [MainThread]:   a.type as organization_type, 
[0m12:45:52.442000 [error] [MainThread]:   b.role as role, 
[0m12:45:52.442000 [error] [MainThread]:   c.name as person_name 
[0m12:45:52.442000 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:45:52.442000 [error] [MainThread]:   inner join 
[0m12:45:52.442000 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:45:52.442000 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:45:52.457668 [error] [MainThread]:   inner join 
[0m12:45:52.457668 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:45:52.457668 [error] [MainThread]:   on b.person_id = c.id
[0m12:45:52.457668 [error] [MainThread]:     '''), ParseException: 
[0m12:45:52.457668 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 18, pos 8)
[0m12:45:52.457668 [error] [MainThread]:   
[0m12:45:52.457668 [error] [MainThread]:   == SQL ==
[0m12:45:52.457668 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:45:52.457668 [error] [MainThread]:   
[0m12:45:52.457668 [error] [MainThread]:     
[0m12:45:52.466188 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m12:45:52.466188 [error] [MainThread]:     using PARQUET
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	as
[0m12:45:52.466188 [error] [MainThread]:   	select 
[0m12:45:52.466188 [error] [MainThread]:   distinct 
[0m12:45:52.466188 [error] [MainThread]:   a.name as organization_name, 
[0m12:45:52.466188 [error] [MainThread]:   a.type as organization_type, 
[0m12:45:52.466188 [error] [MainThread]:   b.role as role, 
[0m12:45:52.466188 [error] [MainThread]:   c.name as person_name 
[0m12:45:52.466188 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:45:52.466188 [error] [MainThread]:   --------^^^
[0m12:45:52.466188 [error] [MainThread]:   inner join 
[0m12:45:52.466188 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:45:52.466188 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:45:52.466188 [error] [MainThread]:   inner join 
[0m12:45:52.466188 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:45:52.466188 [error] [MainThread]:   on b.person_id = c.id
[0m12:45:52.466188 [error] [MainThread]:     
[0m12:45:52.466188 [error] [MainThread]:   
[0m12:45:52.466188 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:45:52.466188 [info ] [MainThread]: 
[0m12:45:52.466188 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m12:45:52.466188 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:45:52.466188 [error] [MainThread]:   
[0m12:45:52.466188 [error] [MainThread]:     
[0m12:45:52.466188 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m12:45:52.466188 [error] [MainThread]:     using PARQUET
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	
[0m12:45:52.466188 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:45:52.481555 [error] [MainThread]:   	
[0m12:45:52.488152 [error] [MainThread]:   	as
[0m12:45:52.488152 [error] [MainThread]:   	select 
[0m12:45:52.488152 [error] [MainThread]:   distinct 
[0m12:45:52.489720 [error] [MainThread]:   a.name as organization_name, 
[0m12:45:52.490218 [error] [MainThread]:   a.type as organization_type, 
[0m12:45:52.490218 [error] [MainThread]:   b.role as role, 
[0m12:45:52.490218 [error] [MainThread]:   c.name as person_name,
[0m12:45:52.490218 [error] [MainThread]:   d.name as event_name
[0m12:45:52.492023 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:45:52.492519 [error] [MainThread]:   inner join 
[0m12:45:52.492996 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:45:52.492996 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:45:52.493776 [error] [MainThread]:   inner join 
[0m12:45:52.494234 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:45:52.494800 [error] [MainThread]:   on b.person_id = c.id
[0m12:45:52.495325 [error] [MainThread]:   inner join 
[0m12:45:52.495325 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:45:52.499841 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:45:52.502831 [error] [MainThread]:     '''), ParseException: 
[0m12:45:52.502831 [error] [MainThread]:   Possibly unquoted identifier poc-normalized-legislator detected. Please consider quoting it with back-quotes as `poc-normalized-legislator`(line 19, pos 8)
[0m12:45:52.503838 [error] [MainThread]:   
[0m12:45:52.503838 [error] [MainThread]:   == SQL ==
[0m12:45:52.504830 [error] [MainThread]:   /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:45:52.504830 [error] [MainThread]:   
[0m12:45:52.505827 [error] [MainThread]:     
[0m12:45:52.506759 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m12:45:52.506759 [error] [MainThread]:     using PARQUET
[0m12:45:52.507256 [error] [MainThread]:   	
[0m12:45:52.507256 [error] [MainThread]:   	
[0m12:45:52.508055 [error] [MainThread]:   	
[0m12:45:52.508689 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:45:52.508857 [error] [MainThread]:   	
[0m12:45:52.508857 [error] [MainThread]:   	as
[0m12:45:52.509878 [error] [MainThread]:   	select 
[0m12:45:52.509878 [error] [MainThread]:   distinct 
[0m12:45:52.510415 [error] [MainThread]:   a.name as organization_name, 
[0m12:45:52.511024 [error] [MainThread]:   a.type as organization_type, 
[0m12:45:52.511238 [error] [MainThread]:   b.role as role, 
[0m12:45:52.511238 [error] [MainThread]:   c.name as person_name,
[0m12:45:52.516400 [error] [MainThread]:   d.name as event_name
[0m12:45:52.518394 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m12:45:52.518394 [error] [MainThread]:   --------^^^
[0m12:45:52.519387 [error] [MainThread]:   inner join 
[0m12:45:52.520384 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m12:45:52.520384 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:45:52.521396 [error] [MainThread]:   inner join 
[0m12:45:52.522377 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m12:45:52.522377 [error] [MainThread]:   on b.person_id = c.id
[0m12:45:52.523074 [error] [MainThread]:   inner join 
[0m12:45:52.523258 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m12:45:52.523949 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:45:52.523949 [error] [MainThread]:     
[0m12:45:52.523949 [error] [MainThread]:   
[0m12:45:52.524987 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:45:52.524987 [info ] [MainThread]: 
[0m12:45:52.525990 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:45:52.526836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E062891E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E062DDC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0627B0910>]}
[0m12:45:52.526836 [debug] [MainThread]: Flushing usage events
[0m12:45:53.608632 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:48:58.807884 | 59b29f66-f9c8-455b-ab9e-a2fd94b53a8b ==============================
[0m12:48:58.807884 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:48:58.807884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:48:58.807884 [debug] [MainThread]: Tracking: tracking
[0m12:48:58.812993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207863E3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207860CF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207863B2B50>]}
[0m12:48:58.828298 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:48:58.891467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:58.891467 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m12:48:58.891467 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m12:48:58.907409 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m12:48:58.927980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207870BA990>]}
[0m12:48:58.950688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020786F7AC50>]}
[0m12:48:58.951515 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m12:48:58.951515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020786168CD0>]}
[0m12:48:58.951515 [info ] [MainThread]: 
[0m12:48:58.955338 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:48:58.957328 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m12:48:58.957328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:58.958330 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:48:58.958330 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:48:58.959392 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:49:21.680717 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:49:21.680717 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14de68df-e2b8-42a0-a855-8c5b0562bd07
[0m12:49:31.369835 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:49:32.431954 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m12:49:32.431954 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:49:32.431954 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m12:49:32.431954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:32.431954 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:49:33.426842 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m12:49:33.426842 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:49:33.426842 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14de68df-e2b8-42a0-a855-8c5b0562bd07
[0m12:49:37.515637 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:49:38.638984 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m12:49:38.638984 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:49:38.654698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207860CE410>]}
[0m12:49:38.654698 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:49:38.654698 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:49:38.654698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:38.654698 [info ] [MainThread]: 
[0m12:49:38.654698 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m12:49:38.654698 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m12:49:38.654698 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m12:49:38.654698 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m12:49:38.654698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m12:49:38.654698 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 12:49:38.654698 => 2023-05-25 12:49:38.654698
[0m12:49:38.654698 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m12:49:38.670560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:38.670560 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:49:39.738920 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:49:39.738920 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:49:39.738920 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14de68df-e2b8-42a0-a855-8c5b0562bd07
[0m12:49:43.880193 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:45.098240 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m12:49:45.129614 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:45.129614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m12:49:45.129614 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:49:45.135664 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m12:49:45.135664 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m12:49:45.135664 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:45.135664 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:49:45.135664 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:49:45.135664 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:49:45.135664 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  ''')
[0m12:49:48.503634 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685018985082, 'CompletedOn': 1685018987161}, 'ResponseMetadata': {'RequestId': '2f35d4fe-1cee-4be1-bb22-fb89cc3b901b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:49:48 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4623', 'connection': 'keep-alive', 'x-amzn-requestid': '2f35d4fe-1cee-4be1-bb22-fb89cc3b901b'}, 'RetryAttempts': 0}}
[0m12:49:48.506090 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:49:48.506090 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:49:48.506090 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:49:48.506090 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m12:49:48.506090 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m12:49:48.506090 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:49:48.506090 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m12:49:48.506090 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:49:48.506090 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 12:49:38.654698 => 2023-05-25 12:49:48.506090
[0m12:49:48.561033 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
    '''), Py4JError: An error occurred while calling o89.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:49:48.561033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078709F750>]}
[0m12:49:48.561033 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 9.91s]
[0m12:49:48.561033 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m12:49:48.561033 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m12:49:48.561033 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m12:49:48.561033 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m12:49:48.561033 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m12:49:48.576946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:49:48.576946 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 12:49:48.576946 => 2023-05-25 12:49:48.576946
[0m12:49:48.576946 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m12:49:48.576946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:48.576946 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:49:49.611272 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:49:49.611272 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:49:49.611272 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14de68df-e2b8-42a0-a855-8c5b0562bd07
[0m12:49:53.611797 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:54.749986 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m12:49:54.756109 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:54.756109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:49:54.757112 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:49:54.758103 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m12:49:54.758103 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m12:49:54.758103 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:49:54.759104 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:49:54.759104 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:49:54.759104 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:49:54.760108 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  ''')
[0m12:49:58.068435 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\ninner join \n`poc-normalized-legislator`.`events` as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685018994670, 'CompletedOn': 1685018996637}, 'ResponseMetadata': {'RequestId': 'b1ef625b-4132-4380-a044-7897e361323c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:49:57 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4761', 'connection': 'keep-alive', 'x-amzn-requestid': 'b1ef625b-4132-4380-a044-7897e361323c'}, 'RetryAttempts': 0}}
[0m12:49:58.068435 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:49:58.069432 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:49:58.071479 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:49:58.071975 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m12:49:58.072539 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m12:49:58.072539 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:49:58.073278 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m12:49:58.073278 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:49:58.073278 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 12:49:48.576946 => 2023-05-25 12:49:58.073278
[0m12:49:58.076257 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
  inner join 
  `poc-normalized-legislator`.`events` as d
  on b.organization_id = d.organization_id
    '''), Py4JError: An error occurred while calling o97.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:49:58.076257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b29f66-f9c8-455b-ab9e-a2fd94b53a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020787AA6D10>]}
[0m12:49:58.077411 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 9.52s]
[0m12:49:58.077914 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m12:49:58.080051 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:49:58.080051 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:58.080051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:58.080051 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:49:59.068307 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m12:49:59.068307 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:49:59.068307 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14de68df-e2b8-42a0-a855-8c5b0562bd07
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:50:03.026913 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:50:03.026913 [debug] [MainThread]: On master: Close
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:50:03.026913 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:50:03.442644 [info ] [MainThread]: 
[0m12:50:03.442644 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 4.49 seconds (64.49s).
[0m12:50:03.458365 [debug] [MainThread]: Command end result
[0m12:50:03.458365 [info ] [MainThread]: 
[0m12:50:03.474746 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:50:03.474746 [info ] [MainThread]: 
[0m12:50:03.474746 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m12:50:03.479565 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:50:03.479565 [error] [MainThread]:   
[0m12:50:03.479565 [error] [MainThread]:     
[0m12:50:03.479565 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m12:50:03.479565 [error] [MainThread]:     using PARQUET
[0m12:50:03.479565 [error] [MainThread]:   	
[0m12:50:03.479565 [error] [MainThread]:   	
[0m12:50:03.479565 [error] [MainThread]:   	
[0m12:50:03.479565 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:50:03.479565 [error] [MainThread]:   	
[0m12:50:03.479565 [error] [MainThread]:   	as
[0m12:50:03.479565 [error] [MainThread]:   	select 
[0m12:50:03.479565 [error] [MainThread]:   distinct 
[0m12:50:03.479565 [error] [MainThread]:   a.name as organization_name, 
[0m12:50:03.479565 [error] [MainThread]:   a.type as organization_type, 
[0m12:50:03.479565 [error] [MainThread]:   b.role as role, 
[0m12:50:03.479565 [error] [MainThread]:   c.name as person_name 
[0m12:50:03.479565 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m12:50:03.479565 [error] [MainThread]:   inner join 
[0m12:50:03.479565 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m12:50:03.479565 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:50:03.479565 [error] [MainThread]:   inner join 
[0m12:50:03.479565 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m12:50:03.479565 [error] [MainThread]:   on b.person_id = c.id
[0m12:50:03.479565 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o89.toString. Trace:
[0m12:50:03.479565 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m12:50:03.479565 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m12:50:03.479565 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m12:50:03.479565 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m12:50:03.479565 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m12:50:03.479565 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m12:50:03.479565 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m12:50:03.495375 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m12:50:03.495375 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m12:50:03.495375 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m12:50:03.495375 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m12:50:03.502067 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m12:50:03.502067 [error] [MainThread]:   
[0m12:50:03.502067 [error] [MainThread]:   
[0m12:50:03.502067 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:50:03.502067 [info ] [MainThread]: 
[0m12:50:03.502067 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m12:50:03.502067 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:50:03.502067 [error] [MainThread]:   
[0m12:50:03.502067 [error] [MainThread]:     
[0m12:50:03.502067 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m12:50:03.502067 [error] [MainThread]:     using PARQUET
[0m12:50:03.502067 [error] [MainThread]:   	
[0m12:50:03.502067 [error] [MainThread]:   	
[0m12:50:03.502067 [error] [MainThread]:   	
[0m12:50:03.502067 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:50:03.502067 [error] [MainThread]:   	
[0m12:50:03.502067 [error] [MainThread]:   	as
[0m12:50:03.502067 [error] [MainThread]:   	select 
[0m12:50:03.502067 [error] [MainThread]:   distinct 
[0m12:50:03.502067 [error] [MainThread]:   a.name as organization_name, 
[0m12:50:03.502067 [error] [MainThread]:   a.type as organization_type, 
[0m12:50:03.502067 [error] [MainThread]:   b.role as role, 
[0m12:50:03.502067 [error] [MainThread]:   c.name as person_name,
[0m12:50:03.502067 [error] [MainThread]:   d.name as event_name
[0m12:50:03.502067 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m12:50:03.502067 [error] [MainThread]:   inner join 
[0m12:50:03.502067 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m12:50:03.502067 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:50:03.502067 [error] [MainThread]:   inner join 
[0m12:50:03.502067 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m12:50:03.502067 [error] [MainThread]:   on b.person_id = c.id
[0m12:50:03.502067 [error] [MainThread]:   inner join 
[0m12:50:03.502067 [error] [MainThread]:   `poc-normalized-legislator`.`events` as d
[0m12:50:03.502067 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:50:03.502067 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o97.toString. Trace:
[0m12:50:03.502067 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m12:50:03.502067 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m12:50:03.502067 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m12:50:03.502067 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m12:50:03.502067 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m12:50:03.502067 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m12:50:03.502067 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m12:50:03.502067 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m12:50:03.502067 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m12:50:03.517766 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m12:50:03.517766 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m12:50:03.517766 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m12:50:03.517766 [error] [MainThread]:   
[0m12:50:03.517766 [error] [MainThread]:   
[0m12:50:03.517766 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:50:03.517766 [info ] [MainThread]: 
[0m12:50:03.517766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:50:03.517766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020786F11C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020787B8B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020786F90750>]}
[0m12:50:03.517766 [debug] [MainThread]: Flushing usage events
[0m12:50:04.614594 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 12:52:38.521870 | f534c806-940a-4a39-8838-e369c5e679fe ==============================
[0m12:52:38.521870 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:52:38.521870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbt-core\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:52:38.521870 [debug] [MainThread]: Tracking: tracking
[0m12:52:38.538071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0C919450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0C0969D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0BB1A550>]}
[0m12:52:38.554062 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:52:38.580872 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:52:38.581384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0BB2D9D0>]}
[0m12:52:39.740009 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m12:52:39.740009 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m12:52:39.824715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0C988650>]}
[0m12:52:39.824715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0CA53790>]}
[0m12:52:39.824715 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m12:52:39.824715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0C0969D0>]}
[0m12:52:39.841117 [info ] [MainThread]: 
[0m12:52:39.841721 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:52:39.841721 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m12:52:39.841721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:39.841721 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:52:39.841721 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:52:39.841721 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:53:02.135347 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:53:02.135347 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b5c626a1-4bed-4523-86df-e64ffdfa668c
[0m12:53:14.266674 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:53:15.349828 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m12:53:15.349828 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:53:15.349828 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m12:53:15.349828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:15.349828 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:53:16.389361 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m12:53:16.389361 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m12:53:16.389361 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b5c626a1-4bed-4523-86df-e64ffdfa668c
[0m12:53:20.464352 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m12:53:21.546808 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m12:53:21.562689 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:53:21.563119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0BD3DED0>]}
[0m12:53:21.563119 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:53:21.563119 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:53:21.563119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:21.563119 [info ] [MainThread]: 
[0m12:53:21.563119 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test
[0m12:53:21.563119 [info ] [Thread-1 (]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m12:53:21.563119 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m12:53:21.563119 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m12:53:21.563119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m12:53:21.563119 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 12:53:21.563119 => 2023-05-25 12:53:21.563119
[0m12:53:21.579097 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test
[0m12:53:21.579855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:53:21.579855 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:53:22.621000 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:53:22.621000 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:53:22.637123 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b5c626a1-4bed-4523-86df-e64ffdfa668c
[0m12:53:26.709710 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:27.779882 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m12:53:27.795759 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:27.811467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:53:27.815971 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m12:53:27.815971 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:53:27.815971 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  ''')
[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685019207786, 'CompletedOn': 1685019209886}, 'ResponseMetadata': {'RequestId': 'e4803936-299f-4f78-a1ee-ce2489814ece', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:53:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4627', 'connection': 'keep-alive', 'x-amzn-requestid': 'e4803936-299f-4f78-a1ee-ce2489814ece'}, 'RetryAttempts': 0}}
[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:53:31.240314 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m12:53:31.240314 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:53:31.240314 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test: Close
[0m12:53:31.240314 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:53:31.240314 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 12:53:21.579177 => 2023-05-25 12:53:31.240314
[0m12:53:31.240314 [debug] [Thread-1 (]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
    '''), Py4JError: An error occurred while calling o89.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:53:31.240314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0D463250>]}
[0m12:53:31.256094 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 9.68s]
[0m12:53:31.256094 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test
[0m12:53:31.256094 [debug] [Thread-1 (]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m12:53:31.256094 [info ] [Thread-1 (]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m12:53:31.256094 [debug] [Thread-1 (]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m12:53:31.256094 [debug] [Thread-1 (]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m12:53:31.256094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:53:31.256094 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 12:53:31.256094 => 2023-05-25 12:53:31.256094
[0m12:53:31.256094 [debug] [Thread-1 (]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m12:53:31.256094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:31.256094 [debug] [Thread-1 (]: Glue adapter: GlueConnection connect called
[0m12:53:32.244942 [debug] [Thread-1 (]: Glue adapter: Existing session with status : READY
[0m12:53:32.244942 [debug] [Thread-1 (]: Glue adapter: GlueConnection _init_session called
[0m12:53:32.244942 [debug] [Thread-1 (]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b5c626a1-4bed-4523-86df-e64ffdfa668c
[0m12:53:36.231214 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:37.270645 [debug] [Thread-1 (]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m12:53:37.270645 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:37.270645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m12:53:37.270645 [debug] [Thread-1 (]: Glue adapter: NotImplemented: add_begin_query
[0m12:53:37.286410 [debug] [Thread-1 (]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m12:53:37.286907 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m12:53:37.287406 [debug] [Thread-1 (]: Glue adapter: GlueConnection cursor called
[0m12:53:37.287406 [debug] [Thread-1 (]: Glue adapter: GlueCursor execute called
[0m12:53:37.287406 [debug] [Thread-1 (]: Glue adapter: GlueCursor remove_comments_header called
[0m12:53:37.287406 [debug] [Thread-1 (]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:53:37.287406 [debug] [Thread-1 (]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  ''')
[0m12:53:40.531809 [debug] [Thread-1 (]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\ninner join \n`poc-normalized-legislator`.`events` as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685019217192, 'CompletedOn': 1685019219159}, 'ResponseMetadata': {'RequestId': '0cf73959-b41f-43a6-98f8-104afab0b2fc', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 12:53:40 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4765', 'connection': 'keep-alive', 'x-amzn-requestid': '0cf73959-b41f-43a6-98f8-104afab0b2fc'}, 'RetryAttempts': 0}}
[0m12:53:40.531809 [debug] [Thread-1 (]: Glue adapter: status = error
[0m12:53:40.532837 [error] [Thread-1 (]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:53:40.533724 [debug] [Thread-1 (]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m12:53:40.533724 [debug] [Thread-1 (]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m12:53:40.534720 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m12:53:40.534720 [debug] [Thread-1 (]: Glue adapter: NotImplemented: rollback
[0m12:53:40.534720 [debug] [Thread-1 (]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m12:53:40.535754 [debug] [Thread-1 (]: Glue adapter: NotImplemented: close
[0m12:53:40.535754 [debug] [Thread-1 (]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 12:53:31.256094 => 2023-05-25 12:53:40.535754
[0m12:53:40.537806 [debug] [Thread-1 (]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
  inner join 
  `poc-normalized-legislator`.`events` as d
  on b.organization_id = d.organization_id
    '''), Py4JError: An error occurred while calling o97.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:53:40.538742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f534c806-940a-4a39-8838-e369c5e679fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0D510A10>]}
[0m12:53:40.539704 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 9.28s]
[0m12:53:40.540932 [debug] [Thread-1 (]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m12:53:40.542044 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:53:40.542044 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:40.543152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:40.543152 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:53:41.712440 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m12:53:41.712440 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:53:41.712440 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b5c626a1-4bed-4523-86df-e64ffdfa668c
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:53:45.655811 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:53:45.655811 [debug] [MainThread]: On master: Close
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:53:45.655811 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:53:46.072204 [info ] [MainThread]: 
[0m12:53:46.072204 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 6.23 seconds (66.23s).
[0m12:53:46.072204 [debug] [MainThread]: Command end result
[0m12:53:46.087894 [info ] [MainThread]: 
[0m12:53:46.087894 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:53:46.087894 [info ] [MainThread]: 
[0m12:53:46.087894 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m12:53:46.087894 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m12:53:46.087894 [error] [MainThread]:   
[0m12:53:46.087894 [error] [MainThread]:     
[0m12:53:46.087894 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m12:53:46.087894 [error] [MainThread]:     using PARQUET
[0m12:53:46.087894 [error] [MainThread]:   	
[0m12:53:46.087894 [error] [MainThread]:   	
[0m12:53:46.087894 [error] [MainThread]:   	
[0m12:53:46.087894 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m12:53:46.087894 [error] [MainThread]:   	
[0m12:53:46.087894 [error] [MainThread]:   	as
[0m12:53:46.087894 [error] [MainThread]:   	select 
[0m12:53:46.087894 [error] [MainThread]:   distinct 
[0m12:53:46.087894 [error] [MainThread]:   a.name as organization_name, 
[0m12:53:46.087894 [error] [MainThread]:   a.type as organization_type, 
[0m12:53:46.087894 [error] [MainThread]:   b.role as role, 
[0m12:53:46.087894 [error] [MainThread]:   c.name as person_name 
[0m12:53:46.087894 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m12:53:46.087894 [error] [MainThread]:   inner join 
[0m12:53:46.103974 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m12:53:46.103974 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:53:46.103974 [error] [MainThread]:   inner join 
[0m12:53:46.103974 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m12:53:46.103974 [error] [MainThread]:   on b.person_id = c.id
[0m12:53:46.103974 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o89.toString. Trace:
[0m12:53:46.110910 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m12:53:46.110910 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m12:53:46.110910 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m12:53:46.110910 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m12:53:46.110910 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m12:53:46.110910 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m12:53:46.110910 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m12:53:46.110910 [error] [MainThread]:   
[0m12:53:46.110910 [error] [MainThread]:   
[0m12:53:46.110910 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m12:53:46.110910 [info ] [MainThread]: 
[0m12:53:46.110910 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m12:53:46.110910 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m12:53:46.110910 [error] [MainThread]:   
[0m12:53:46.110910 [error] [MainThread]:     
[0m12:53:46.110910 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m12:53:46.119356 [error] [MainThread]:     using PARQUET
[0m12:53:46.119356 [error] [MainThread]:   	
[0m12:53:46.119356 [error] [MainThread]:   	
[0m12:53:46.119356 [error] [MainThread]:   	
[0m12:53:46.119356 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m12:53:46.119356 [error] [MainThread]:   	
[0m12:53:46.119356 [error] [MainThread]:   	as
[0m12:53:46.119356 [error] [MainThread]:   	select 
[0m12:53:46.119356 [error] [MainThread]:   distinct 
[0m12:53:46.119356 [error] [MainThread]:   a.name as organization_name, 
[0m12:53:46.119356 [error] [MainThread]:   a.type as organization_type, 
[0m12:53:46.119356 [error] [MainThread]:   b.role as role, 
[0m12:53:46.127591 [error] [MainThread]:   c.name as person_name,
[0m12:53:46.127591 [error] [MainThread]:   d.name as event_name
[0m12:53:46.128456 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m12:53:46.128456 [error] [MainThread]:   inner join 
[0m12:53:46.128456 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m12:53:46.128456 [error] [MainThread]:   on a.id=b.organization_id 
[0m12:53:46.128456 [error] [MainThread]:   inner join 
[0m12:53:46.128456 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m12:53:46.128456 [error] [MainThread]:   on b.person_id = c.id
[0m12:53:46.128456 [error] [MainThread]:   inner join 
[0m12:53:46.128456 [error] [MainThread]:   `poc-normalized-legislator`.`events` as d
[0m12:53:46.128456 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m12:53:46.128456 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o97.toString. Trace:
[0m12:53:46.128456 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m12:53:46.128456 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m12:53:46.128456 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m12:53:46.128456 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m12:53:46.128456 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m12:53:46.128456 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m12:53:46.128456 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m12:53:46.128456 [error] [MainThread]:   
[0m12:53:46.128456 [error] [MainThread]:   
[0m12:53:46.128456 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m12:53:46.128456 [info ] [MainThread]: 
[0m12:53:46.128456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:53:46.128456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0D4FCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0D3DD690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D0E60B250>]}
[0m12:53:46.128456 [debug] [MainThread]: Flushing usage events
[0m12:53:47.010845 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 13:25:47.018185 | 53ddb5e7-2a64-47ee-bad6-9aa7e5378fa8 ==============================
[0m13:25:47.018185 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:25:47.018185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:25:47.018185 [debug] [MainThread]: Tracking: tracking
[0m13:25:47.055113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82B9ABA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82BA37370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82BA37DC0>]}
[0m13:25:47.271050 [debug] [MainThread]: Executing "git --help"
[0m13:25:47.303286 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:25:47.303286 [debug] [MainThread]: STDERR: "b''"
[0m13:25:47.319006 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m13:25:47.319006 [debug] [MainThread]: Using glue connection "debug"
[0m13:25:47.319006 [debug] [MainThread]: On debug: select 1 as id
[0m13:25:47.319006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:47.319006 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:25:47.319006 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m13:25:47.319006 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m13:26:15.098617 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m13:26:15.098617 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-8fb5e665-c82e-4abd-9bc5-50c99c940dd2
[0m13:26:24.742554 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m13:26:24.742554 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m13:26:24.742554 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m13:26:24.742554 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:26:24.742554 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m13:26:37.356801 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685021184664, 'CompletedOn': 1685021196252}, 'ResponseMetadata': {'RequestId': '67d87176-af77-483a-8f44-e4ce9676ede2', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 13:26:36 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '67d87176-af77-483a-8f44-e4ce9676ede2'}, 'RetryAttempts': 0}}
[0m13:26:37.356801 [debug] [MainThread]: Glue adapter: status = ok
[0m13:26:37.356801 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m13:26:37.356801 [debug] [MainThread]: SQL status: OK in 50 seconds
[0m13:26:37.356801 [debug] [MainThread]: On debug: Close
[0m13:26:37.356801 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:26:37.356801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82CE75340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82D460D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82D460A60>]}
[0m13:26:37.356801 [debug] [MainThread]: Flushing usage events
[0m13:26:38.273775 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 13:26:47.689832 | 32295047-bab9-49fa-b8fe-4d5d2f50be74 ==============================
[0m13:26:47.689832 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:26:47.689832 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:26:47.689832 [debug] [MainThread]: Tracking: tracking
[0m13:26:47.740989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C60DF730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C60DFDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C60DF9A0>]}
[0m13:26:47.757739 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:26:48.354483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:48.354483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:48.378636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C2B9CA30>]}
[0m13:26:48.378636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6130850>]}
[0m13:26:48.378636 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m13:26:48.378636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C61309A0>]}
[0m13:26:48.378636 [info ] [MainThread]: 
[0m13:26:48.389972 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:26:48.389972 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m13:26:48.389972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:48.389972 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:26:48.389972 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:26:48.389972 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:27:05.611769 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m13:27:05.611769 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-edbf3dff-0b5e-4fa4-82ad-fcf8cd506d26
[0m13:27:16.416308 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m13:27:17.487950 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m13:27:17.487950 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:27:17.487950 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m13:27:17.487950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:17.503866 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:27:18.571659 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m13:27:18.571659 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m13:27:18.571659 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-edbf3dff-0b5e-4fa4-82ad-fcf8cd506d26
[0m13:27:22.697132 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m13:27:23.784824 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m13:27:23.784824 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:27:23.784824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C60DF9A0>]}
[0m13:27:23.784824 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:27:23.784824 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:27:23.784824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:23.800395 [info ] [MainThread]: 
[0m13:27:23.845978 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m13:27:23.845978 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m13:27:23.845978 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m13:27:23.845978 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m13:27:23.845978 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m13:27:23.853024 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 13:27:23.845978 => 2023-05-25 13:27:23.853024
[0m13:27:23.853024 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m13:27:23.853024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:27:23.853024 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m13:27:24.932867 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m13:27:24.932867 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:27:24.932867 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-edbf3dff-0b5e-4fa4-82ad-fcf8cd506d26
[0m13:27:29.040957 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:30.181534 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m13:27:30.213162 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:30.213162 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m13:27:30.213162 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:27:30.213162 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m13:27:30.213162 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m13:27:30.213162 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:30.213162 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:27:30.228793 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:27:30.228793 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:27:30.228793 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  ''')
[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o89.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685021250176, 'CompletedOn': 1685021252444}, 'ResponseMetadata': {'RequestId': '8dce01e8-5c43-4659-9776-033ab61ae131', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 13:27:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4627', 'connection': 'keep-alive', 'x-amzn-requestid': '8dce01e8-5c43-4659-9776-033ab61ae131'}, 'RetryAttempts': 0}}
[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: status = error
[0m13:27:33.606052 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), Py4JError: An error occurred while calling o89.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m13:27:33.606052 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:27:33.606052 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m13:27:33.606052 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:27:33.606052 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 13:27:23.853024 => 2023-05-25 13:27:33.606052
[0m13:27:33.622219 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
    '''), Py4JError: An error occurred while calling o89.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m13:27:33.622219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6FE85B0>]}
[0m13:27:33.622219 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 9.78s]
[0m13:27:33.622219 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m13:27:33.622219 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m13:27:33.622219 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m13:27:33.622219 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m13:27:33.622219 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m13:27:33.622219 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m13:27:33.622219 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 13:27:33.622219 => 2023-05-25 13:27:33.622219
[0m13:27:33.622219 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m13:27:33.622219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:27:33.622219 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m13:27:34.676660 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m13:27:34.676660 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:27:34.676660 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-edbf3dff-0b5e-4fa4-82ad-fcf8cd506d26
[0m13:27:38.680984 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:39.820644 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:27:39.820644 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m13:27:39.820644 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:27:39.820644 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  ''')
[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\ninner join \n`poc-normalized-legislator`.`events` as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'Py4JError', 'ErrorValue': 'An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 113, in deco\n    converted = convert_exception(e.java_exception)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 88, in convert_exception\n    return AnalysisException(s.split(\': \', 1)[1], stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 105, in convert_exception\n    return UnknownException(s, stacktrace, c)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 27, in __init__\n    self.cause = convert_exception(cause) if cause is not None else None\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 98, in convert_exception\n    c.toString().startswith(\'org.apache.spark.api.python.PythonException: \')\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 111, in deco\n    return f(*a, **kw)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py", line 332, in get_return_value\n    format(target_id, ".", name, value))\n', 'py4j.protocol.Py4JError: An error occurred while calling o97.toString. Trace:\njava.lang.IllegalArgumentException: object is not an instance of declaring class\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\n']}, 'Progress': 1.0, 'StartedOn': 1685021259751, 'CompletedOn': 1685021261792}, 'ResponseMetadata': {'RequestId': '44598f73-03e6-425a-9b98-fd387542837f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 13:27:42 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4765', 'connection': 'keep-alive', 'x-amzn-requestid': '44598f73-03e6-425a-9b98-fd387542837f'}, 'RetryAttempts': 0}}
[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: status = error
[0m13:27:43.157191 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), Py4JError: An error occurred while calling o97.toString. Trace:
java.lang.IllegalArgumentException: object is not an instance of declaring class
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)


[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m13:27:43.157191 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:27:43.157191 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m13:27:43.157191 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:27:43.157191 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 13:27:33.622219 => 2023-05-25 13:27:43.157191
[0m13:27:43.170830 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
  inner join 
  `poc-normalized-legislator`.`events` as d
  on b.organization_id = d.organization_id
    '''), Py4JError: An error occurred while calling o97.toString. Trace:
  java.lang.IllegalArgumentException: object is not an instance of declaring class
  	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
  	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
  	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
  	at java.lang.reflect.Method.invoke(Method.java:498)
  	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
  	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
  	at py4j.Gateway.invoke(Gateway.java:282)
  	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
  	at py4j.commands.CallCommand.execute(CallCommand.java:79)
  	at py4j.GatewayConnection.run(GatewayConnection.java:238)
  	at java.lang.Thread.run(Thread.java:750)
  
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m13:27:43.170830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32295047-bab9-49fa-b8fe-4d5d2f50be74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6F57F70>]}
[0m13:27:43.170830 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 9.55s]
[0m13:27:43.170830 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m13:27:43.170830 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:27:43.170830 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:43.170830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:43.170830 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:27:44.213278 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m13:27:44.213278 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m13:27:44.213278 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-edbf3dff-0b5e-4fa4-82ad-fcf8cd506d26
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:27:48.205428 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:27:48.205428 [debug] [MainThread]: On master: Close
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:27:48.205428 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:27:48.686072 [info ] [MainThread]: 
[0m13:27:48.686072 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 0.31 seconds (60.31s).
[0m13:27:48.686072 [debug] [MainThread]: Command end result
[0m13:27:48.706674 [info ] [MainThread]: 
[0m13:27:48.706674 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:27:48.706674 [info ] [MainThread]: 
[0m13:27:48.706674 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m13:27:48.706674 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m13:27:48.706674 [error] [MainThread]:   
[0m13:27:48.706674 [error] [MainThread]:     
[0m13:27:48.706674 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m13:27:48.706674 [error] [MainThread]:     using PARQUET
[0m13:27:48.706674 [error] [MainThread]:   	
[0m13:27:48.706674 [error] [MainThread]:   	
[0m13:27:48.706674 [error] [MainThread]:   	
[0m13:27:48.706674 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m13:27:48.706674 [error] [MainThread]:   	
[0m13:27:48.706674 [error] [MainThread]:   	as
[0m13:27:48.706674 [error] [MainThread]:   	select 
[0m13:27:48.706674 [error] [MainThread]:   distinct 
[0m13:27:48.706674 [error] [MainThread]:   a.name as organization_name, 
[0m13:27:48.706674 [error] [MainThread]:   a.type as organization_type, 
[0m13:27:48.706674 [error] [MainThread]:   b.role as role, 
[0m13:27:48.706674 [error] [MainThread]:   c.name as person_name 
[0m13:27:48.706674 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m13:27:48.706674 [error] [MainThread]:   inner join 
[0m13:27:48.706674 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m13:27:48.706674 [error] [MainThread]:   on a.id=b.organization_id 
[0m13:27:48.706674 [error] [MainThread]:   inner join 
[0m13:27:48.706674 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m13:27:48.706674 [error] [MainThread]:   on b.person_id = c.id
[0m13:27:48.706674 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o89.toString. Trace:
[0m13:27:48.706674 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m13:27:48.706674 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m13:27:48.706674 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m13:27:48.706674 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m13:27:48.706674 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m13:27:48.706674 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m13:27:48.706674 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m13:27:48.706674 [error] [MainThread]:   
[0m13:27:48.722407 [error] [MainThread]:   
[0m13:27:48.722407 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m13:27:48.722407 [info ] [MainThread]: 
[0m13:27:48.722407 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m13:27:48.722407 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m13:27:48.722407 [error] [MainThread]:   
[0m13:27:48.722407 [error] [MainThread]:     
[0m13:27:48.722407 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m13:27:48.722407 [error] [MainThread]:     using PARQUET
[0m13:27:48.722407 [error] [MainThread]:   	
[0m13:27:48.722407 [error] [MainThread]:   	
[0m13:27:48.722407 [error] [MainThread]:   	
[0m13:27:48.722407 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m13:27:48.722407 [error] [MainThread]:   	
[0m13:27:48.722407 [error] [MainThread]:   	as
[0m13:27:48.722407 [error] [MainThread]:   	select 
[0m13:27:48.722407 [error] [MainThread]:   distinct 
[0m13:27:48.722407 [error] [MainThread]:   a.name as organization_name, 
[0m13:27:48.722407 [error] [MainThread]:   a.type as organization_type, 
[0m13:27:48.722407 [error] [MainThread]:   b.role as role, 
[0m13:27:48.722407 [error] [MainThread]:   c.name as person_name,
[0m13:27:48.722407 [error] [MainThread]:   d.name as event_name
[0m13:27:48.722407 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m13:27:48.722407 [error] [MainThread]:   inner join 
[0m13:27:48.722407 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m13:27:48.722407 [error] [MainThread]:   on a.id=b.organization_id 
[0m13:27:48.722407 [error] [MainThread]:   inner join 
[0m13:27:48.722407 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m13:27:48.722407 [error] [MainThread]:   on b.person_id = c.id
[0m13:27:48.722407 [error] [MainThread]:   inner join 
[0m13:27:48.722407 [error] [MainThread]:   `poc-normalized-legislator`.`events` as d
[0m13:27:48.722407 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m13:27:48.722407 [error] [MainThread]:     '''), Py4JError: An error occurred while calling o97.toString. Trace:
[0m13:27:48.722407 [error] [MainThread]:   java.lang.IllegalArgumentException: object is not an instance of declaring class
[0m13:27:48.722407 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[0m13:27:48.738477 [error] [MainThread]:   	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
[0m13:27:48.738477 [error] [MainThread]:   	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[0m13:27:48.738477 [error] [MainThread]:   	at java.lang.reflect.Method.invoke(Method.java:498)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.Gateway.invoke(Gateway.java:282)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.commands.CallCommand.execute(CallCommand.java:79)
[0m13:27:48.738477 [error] [MainThread]:   	at py4j.GatewayConnection.run(GatewayConnection.java:238)
[0m13:27:48.738477 [error] [MainThread]:   	at java.lang.Thread.run(Thread.java:750)
[0m13:27:48.738477 [error] [MainThread]:   
[0m13:27:48.738477 [error] [MainThread]:   
[0m13:27:48.738477 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m13:27:48.738477 [info ] [MainThread]: 
[0m13:27:48.738477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m13:27:48.738477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6EDB0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6130760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C6130A60>]}
[0m13:27:48.738477 [debug] [MainThread]: Flushing usage events
[0m13:27:49.808197 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 13:33:12.613832 | 31681065-9176-4dbb-be06-526e7aa10afe ==============================
[0m13:33:12.613832 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:33:12.613832 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:33:12.629582 [debug] [MainThread]: Tracking: tracking
[0m13:33:12.645879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCA6012B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCA677430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCA677E20>]}
[0m13:33:12.862448 [debug] [MainThread]: Executing "git --help"
[0m13:33:12.899511 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:33:12.899511 [debug] [MainThread]: STDERR: "b''"
[0m13:33:12.915270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCA66B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCBAC2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DCBAC22E0>]}
[0m13:33:12.915270 [debug] [MainThread]: Flushing usage events


============================== 2023-05-25 15:42:04.267888 | 83e59e5e-009c-45ed-bb58-4a2d0557de92 ==============================
[0m15:42:04.267888 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:42:04.267888 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:42:04.267888 [debug] [MainThread]: Tracking: tracking
[0m15:42:04.290745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F63034BA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6303D6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6303D6DC0>]}
[0m15:42:04.520069 [debug] [MainThread]: Executing "git --help"
[0m15:42:04.559032 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:42:04.559032 [debug] [MainThread]: STDERR: "b''"
[0m15:42:04.572796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6303CA4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F63185A7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F63185A310>]}
[0m15:42:04.572796 [debug] [MainThread]: Flushing usage events


============================== 2023-05-25 15:46:36.568791 | f15be34a-18b3-430e-9701-35804dc98122 ==============================
[0m15:46:36.568791 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:46:36.568791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:46:36.568791 [debug] [MainThread]: Tracking: tracking
[0m15:46:36.620244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D72A6F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D72A6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D72A6B50>]}
[0m15:46:36.836238 [debug] [MainThread]: Executing "git --help"
[0m15:46:36.867962 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:46:36.867962 [debug] [MainThread]: STDERR: "b''"
[0m15:46:36.884251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D7277730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D872A730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D872A2B0>]}
[0m15:46:36.884251 [debug] [MainThread]: Flushing usage events


============================== 2023-05-25 15:47:34.132078 | d91478dd-0e28-4d5e-8501-5c14b06b3a5e ==============================
[0m15:47:34.132078 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:47:34.132078 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:47:34.132078 [debug] [MainThread]: Tracking: tracking
[0m15:47:34.150980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F2BFAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D70306430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D70306D00>]}
[0m15:47:34.363497 [debug] [MainThread]: Executing "git --help"
[0m15:47:34.394313 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:47:34.394313 [debug] [MainThread]: STDERR: "b''"
[0m15:47:34.416452 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m15:47:34.417691 [debug] [MainThread]: Using glue connection "debug"
[0m15:47:34.417691 [debug] [MainThread]: On debug: select 1 as id
[0m15:47:34.417691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:34.417691 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m15:47:34.417691 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m15:47:34.417691 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m15:47:51.577963 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m15:47:51.577963 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4a062e64-966d-4f7c-9be0-b6cf9714f235
[0m15:47:58.340413 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m15:47:58.355987 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m15:47:58.355987 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m15:47:58.355987 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:47:58.355987 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m15:48:03.027407 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685029678282, 'CompletedOn': 1685029681516}, 'ResponseMetadata': {'RequestId': 'c59851ec-4ab2-47fb-a6a4-69b7b99f1e43', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 15:48:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'c59851ec-4ab2-47fb-a6a4-69b7b99f1e43'}, 'RetryAttempts': 0}}
[0m15:48:03.027407 [debug] [MainThread]: Glue adapter: status = ok
[0m15:48:03.027407 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m15:48:03.027407 [debug] [MainThread]: SQL status: OK in 29 seconds
[0m15:48:03.043369 [debug] [MainThread]: On debug: Close
[0m15:48:03.043369 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m15:48:03.043369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D70771160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D70D8F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D70D8F4C0>]}
[0m15:48:03.043369 [debug] [MainThread]: Flushing usage events
[0m15:48:04.019082 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 15:48:10.715628 | 4ecc21ed-6727-405a-8b86-6b0195a90520 ==============================
[0m15:48:10.715628 [info ] [MainThread]: Running with dbt=1.4.6
[0m15:48:10.715628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:48:10.715628 [debug] [MainThread]: Tracking: tracking
[0m15:48:10.750275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B712730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B712D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B7129A0>]}
[0m15:48:10.766983 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m15:48:10.782659 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:48:10.782659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B712730>]}
[0m15:48:11.980351 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m15:48:11.995906 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m15:48:12.049487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239BA77A00>]}
[0m15:48:12.049487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B712A60>]}
[0m15:48:12.049487 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m15:48:12.049487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B6C4520>]}
[0m15:48:12.049487 [info ] [MainThread]: 
[0m15:48:12.049487 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m15:48:12.049487 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m15:48:12.049487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:12.049487 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m15:48:12.049487 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m15:48:12.049487 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m15:48:29.402951 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m15:48:29.402951 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f8257992-ddfb-4311-95ec-5af8955654c4
[0m15:48:36.219041 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m15:48:37.358896 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m15:48:37.358896 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:48:37.358896 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m15:48:37.358896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:37.358896 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m15:48:38.440466 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m15:48:38.440466 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m15:48:38.440466 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f8257992-ddfb-4311-95ec-5af8955654c4
[0m15:48:41.268991 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m15:48:42.434966 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m15:48:42.434966 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:48:42.434966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239B6C4640>]}
[0m15:48:42.434966 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:48:42.434966 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:48:42.434966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:42.434966 [info ] [MainThread]: 
[0m15:48:42.450682 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m15:48:42.450682 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m15:48:42.450682 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m15:48:42.450682 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m15:48:42.450682 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m15:48:42.450682 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 15:48:42.450682 => 2023-05-25 15:48:42.450682
[0m15:48:42.450682 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m15:48:42.450682 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:48:42.450682 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m15:48:43.453401 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m15:48:43.453401 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:48:43.453401 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f8257992-ddfb-4311-95ec-5af8955654c4
[0m15:48:46.144166 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:47.285488 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m15:48:47.301690 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:47.301690 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m15:48:47.301690 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:48:47.301690 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m15:48:47.301690 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m15:48:47.317312 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:47.317312 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:48:47.317312 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:48:47.317312 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:48:47.317312 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  ''')
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', "pyspark.sql.utils.AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'\n"]}, 'Progress': 1.0, 'StartedOn': 1685029727227, 'CompletedOn': 1685029729032}, 'ResponseMetadata': {'RequestId': '063cca3e-fe48-4d1a-bcf6-590d42ad618c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 15:48:50 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2743', 'connection': 'keep-alive', 'x-amzn-requestid': '063cca3e-fe48-4d1a-bcf6-590d42ad618c'}, 'RetryAttempts': 0}}
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: status = error
[0m15:48:50.743836 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m15:48:50.743836 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:48:50.743836 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m15:48:50.743836 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:48:50.743836 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 15:48:42.450682 => 2023-05-25 15:48:50.743836
[0m15:48:50.796175 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
    '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m15:48:50.796175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012398166700>]}
[0m15:48:50.796175 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 8.35s]
[0m15:48:50.796175 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m15:48:50.796175 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m15:48:50.796175 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m15:48:50.796175 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m15:48:50.811805 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m15:48:50.814527 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m15:48:50.814527 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 15:48:50.811805 => 2023-05-25 15:48:50.814527
[0m15:48:50.814527 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m15:48:50.814527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:48:50.814527 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m15:48:51.850182 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m15:48:51.850182 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:48:51.850182 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f8257992-ddfb-4311-95ec-5af8955654c4
[0m15:48:54.552880 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:55.640348 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:55.655863 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:48:55.655863 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m15:48:55.655863 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:48:55.655863 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  ''')
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\ninner join \n`poc-normalized-legislator`.`events` as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', "pyspark.sql.utils.AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'\n"]}, 'Progress': 1.0, 'StartedOn': 1685029735574, 'CompletedOn': 1685029737320}, 'ResponseMetadata': {'RequestId': 'c83879e9-3b27-42ee-8c1a-9ba07b8434a4', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 15:48:58 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2881', 'connection': 'keep-alive', 'x-amzn-requestid': 'c83879e9-3b27-42ee-8c1a-9ba07b8434a4'}, 'RetryAttempts': 0}}
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: status = error
[0m15:48:58.964783 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m15:48:58.964783 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:48:58.964783 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m15:48:58.964783 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:48:58.964783 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 15:48:50.814527 => 2023-05-25 15:48:58.964783
[0m15:48:58.964783 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
  inner join 
  `poc-normalized-legislator`.`events` as d
  on b.organization_id = d.organization_id
    '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m15:48:58.964783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ecc21ed-6727-405a-8b86-6b0195a90520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239C608FD0>]}
[0m15:48:58.964783 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 8.17s]
[0m15:48:58.964783 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m15:48:58.964783 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m15:48:58.964783 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:58.964783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:58.964783 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m15:49:00.020157 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m15:49:00.020157 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m15:49:00.020157 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f8257992-ddfb-4311-95ec-5af8955654c4
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:49:02.681131 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:49:02.681131 [debug] [MainThread]: On master: Close
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m15:49:02.681131 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:49:03.116863 [info ] [MainThread]: 
[0m15:49:03.116863 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 51.07 seconds (51.07s).
[0m15:49:03.116863 [debug] [MainThread]: Command end result
[0m15:49:03.130375 [info ] [MainThread]: 
[0m15:49:03.130375 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:49:03.130375 [info ] [MainThread]: 
[0m15:49:03.130375 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m15:49:03.130375 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m15:49:03.130375 [error] [MainThread]:   
[0m15:49:03.130375 [error] [MainThread]:     
[0m15:49:03.130375 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m15:49:03.130375 [error] [MainThread]:     using PARQUET
[0m15:49:03.130375 [error] [MainThread]:   	
[0m15:49:03.130375 [error] [MainThread]:   	
[0m15:49:03.130375 [error] [MainThread]:   	
[0m15:49:03.130375 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m15:49:03.130375 [error] [MainThread]:   	
[0m15:49:03.130375 [error] [MainThread]:   	as
[0m15:49:03.130375 [error] [MainThread]:   	select 
[0m15:49:03.130375 [error] [MainThread]:   distinct 
[0m15:49:03.130375 [error] [MainThread]:   a.name as organization_name, 
[0m15:49:03.130375 [error] [MainThread]:   a.type as organization_type, 
[0m15:49:03.130375 [error] [MainThread]:   b.role as role, 
[0m15:49:03.130375 [error] [MainThread]:   c.name as person_name 
[0m15:49:03.130375 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m15:49:03.130375 [error] [MainThread]:   inner join 
[0m15:49:03.130375 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m15:49:03.130375 [error] [MainThread]:   on a.id=b.organization_id 
[0m15:49:03.130375 [error] [MainThread]:   inner join 
[0m15:49:03.130375 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m15:49:03.130375 [error] [MainThread]:   on b.person_id = c.id
[0m15:49:03.130375 [error] [MainThread]:     '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 42b3bb06-4088-40e9-a63d-cc68e8c0f5d8; Proxy: null));'
[0m15:49:03.146128 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m15:49:03.146128 [info ] [MainThread]: 
[0m15:49:03.146128 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m15:49:03.146128 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m15:49:03.146128 [error] [MainThread]:   
[0m15:49:03.146128 [error] [MainThread]:     
[0m15:49:03.146128 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m15:49:03.146128 [error] [MainThread]:     using PARQUET
[0m15:49:03.146128 [error] [MainThread]:   	
[0m15:49:03.146128 [error] [MainThread]:   	
[0m15:49:03.146128 [error] [MainThread]:   	
[0m15:49:03.146128 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m15:49:03.146128 [error] [MainThread]:   	
[0m15:49:03.146128 [error] [MainThread]:   	as
[0m15:49:03.146128 [error] [MainThread]:   	select 
[0m15:49:03.146128 [error] [MainThread]:   distinct 
[0m15:49:03.146128 [error] [MainThread]:   a.name as organization_name, 
[0m15:49:03.146128 [error] [MainThread]:   a.type as organization_type, 
[0m15:49:03.146128 [error] [MainThread]:   b.role as role, 
[0m15:49:03.146128 [error] [MainThread]:   c.name as person_name,
[0m15:49:03.146128 [error] [MainThread]:   d.name as event_name
[0m15:49:03.146128 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m15:49:03.146128 [error] [MainThread]:   inner join 
[0m15:49:03.146128 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m15:49:03.146128 [error] [MainThread]:   on a.id=b.organization_id 
[0m15:49:03.146128 [error] [MainThread]:   inner join 
[0m15:49:03.146128 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m15:49:03.146128 [error] [MainThread]:   on b.person_id = c.id
[0m15:49:03.146128 [error] [MainThread]:   inner join 
[0m15:49:03.146128 [error] [MainThread]:   `poc-normalized-legislator`.`events` as d
[0m15:49:03.146128 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m15:49:03.161839 [error] [MainThread]:     '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 1025c51e-7118-47d2-9cff-b6b51e4864ae; Proxy: null));'
[0m15:49:03.161839 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m15:49:03.161839 [info ] [MainThread]: 
[0m15:49:03.161839 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:49:03.161839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239824F460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239C6EEF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001239823BE50>]}
[0m15:49:03.161839 [debug] [MainThread]: Flushing usage events
[0m15:49:04.063734 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:05:39.619051 | c1cef06e-c3aa-4a2d-acdd-2688cc222958 ==============================
[0m16:05:39.619051 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:05:39.619051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:05:39.619051 [debug] [MainThread]: Tracking: tracking
[0m16:05:39.649819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369C22610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369C22D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369C22970>]}
[0m16:05:39.649819 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:05:39.666187 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:05:39.666187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369BCE100>]}
[0m16:05:40.250368 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:05:40.266087 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m16:05:40.318993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369F899D0>]}
[0m16:05:40.318993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014366659340>]}
[0m16:05:40.318993 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:05:40.318993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369BD95B0>]}
[0m16:05:40.318993 [info ] [MainThread]: 
[0m16:05:40.318993 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:05:40.334555 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:05:40.334555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:40.334555 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:05:40.334555 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:05:40.334555 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:06:02.845606 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:06:02.845606 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f08456ab-5cf3-4312-b6cd-1db8dcf26c9a
[0m16:06:12.500179 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:06:13.588542 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:06:13.588542 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:06:13.588542 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:06:13.588542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:13.588542 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:06:14.617937 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:06:14.617937 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:06:14.617937 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f08456ab-5cf3-4312-b6cd-1db8dcf26c9a
[0m16:06:15.969405 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:06:17.048802 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:06:17.048802 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:06:17.048802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369FC0700>]}
[0m16:06:17.048802 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:06:17.048802 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:06:17.048802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:17.048802 [info ] [MainThread]: 
[0m16:06:17.064525 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:06:17.064525 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:06:17.064525 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:06:17.064525 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:06:17.080370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:06:17.080370 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:06:17.064525 => 2023-05-25 16:06:17.080370
[0m16:06:17.080370 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:06:17.095983 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:06:17.095983 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:06:18.150465 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:06:18.150465 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:06:18.150465 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f08456ab-5cf3-4312-b6cd-1db8dcf26c9a
[0m16:06:19.522211 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:20.567702 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:06:20.631850 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:20.636258 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:06:20.636258 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:06:20.636258 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:06:20.636258 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  ''')
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#0, \'a.type AS organization_type#1, \'b.role AS role#2, \'c.name AS person_name#3]\\n      +- \'Join Inner, (\'b.person_id = \'c.id)\\n         :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :- \'SubqueryAlias `a`\\n         :  :  +- \'UnresolvedRelation `poc-normalized-legislator`.`organizations`\\n         :  +- \'SubqueryAlias `b`\\n         :     +- \'UnresolvedRelation `poc-normalized-legislator`.`memberships`\\n         +- \'SubqueryAlias `c`\\n            +- \'UnresolvedRelation `poc-normalized-legislator`.`persons`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#0, \'a.type AS organization_type#1, \'b.role AS role#2, \'c.name AS person_name#3]\\n      +- \'Join Inner, (\'b.person_id = \'c.id)\\n         :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :- \'SubqueryAlias `a`\\n         :  :  +- \'UnresolvedRelation `poc-normalized-legislator`.`organizations`\\n         :  +- \'SubqueryAlias `b`\\n         :     +- \'UnresolvedRelation `poc-normalized-legislator`.`memberships`\\n         +- \'SubqueryAlias `c`\\n            +- \'UnresolvedRelation `poc-normalized-legislator`.`persons`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685030780567, 'CompletedOn': 1685030781327}, 'ResponseMetadata': {'RequestId': 'b36076e8-58c9-43da-94bf-48d2be80dbd7', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:06:22 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3121', 'connection': 'keep-alive', 'x-amzn-requestid': 'b36076e8-58c9-43da-94bf-48d2be80dbd7'}, 'RetryAttempts': 0}}
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:06:22.645250 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias `a`\n         :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  +- 'SubqueryAlias `b`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         +- 'SubqueryAlias `c`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n"
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias `a`\n         :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  +- 'SubqueryAlias `b`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         +- 'SubqueryAlias `c`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n"
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table `poc_curated_dbt`.`spark_sql_test`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
  
[0m16:06:22.645250 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:06:22.645250 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:06:22.645250 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:06:22.645250 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:06:17.080370 => 2023-05-25 16:06:22.645250
[0m16:06:22.710468 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
    '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias `a`\n         :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  +- 'SubqueryAlias `b`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         +- 'SubqueryAlias `c`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:06:22.710468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436664C9D0>]}
[0m16:06:22.710468 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.65s]
[0m16:06:22.710468 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:06:22.710468 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:06:22.710468 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:06:22.710468 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:06:22.710468 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:06:22.728888 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:06:22.728888 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:06:22.710468 => 2023-05-25 16:06:22.728888
[0m16:06:22.728888 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:06:22.728888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:06:22.728888 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:06:23.831049 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:06:23.831049 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:06:23.831049 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f08456ab-5cf3-4312-b6cd-1db8dcf26c9a
[0m16:06:25.252552 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:26.381167 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:06:26.381167 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:26.381167 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:06:26.397062 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:06:26.397062 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:06:26.397062 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  ''')
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table `poc_curated_dbt`.`spark_sql_test_event`\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom `poc-normalized-legislator`.`organizations` as a \ninner join \n`poc-normalized-legislator`.`memberships` as b \non a.id=b.organization_id \ninner join \n`poc-normalized-legislator`.`persons` as c \non b.person_id = c.id\ninner join \n`poc-normalized-legislator`.`events` as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#4, \'a.type AS organization_type#5, \'b.role AS role#6, \'c.name AS person_name#7, \'d.name AS event_name#8]\\n      +- \'Join Inner, (\'b.organization_id = \'d.organization_id)\\n         :- \'Join Inner, (\'b.person_id = \'c.id)\\n         :  :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :  :- \'SubqueryAlias `a`\\n         :  :  :  +- \'UnresolvedRelation `poc-normalized-legislator`.`organizations`\\n         :  :  +- \'SubqueryAlias `b`\\n         :  :     +- \'UnresolvedRelation `poc-normalized-legislator`.`memberships`\\n         :  +- \'SubqueryAlias `c`\\n         :     +- \'UnresolvedRelation `poc-normalized-legislator`.`persons`\\n         +- \'SubqueryAlias `d`\\n            +- \'UnresolvedRelation `poc-normalized-legislator`.`events`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#4, \'a.type AS organization_type#5, \'b.role AS role#6, \'c.name AS person_name#7, \'d.name AS event_name#8]\\n      +- \'Join Inner, (\'b.organization_id = \'d.organization_id)\\n         :- \'Join Inner, (\'b.person_id = \'c.id)\\n         :  :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :  :- \'SubqueryAlias `a`\\n         :  :  :  +- \'UnresolvedRelation `poc-normalized-legislator`.`organizations`\\n         :  :  +- \'SubqueryAlias `b`\\n         :  :     +- \'UnresolvedRelation `poc-normalized-legislator`.`memberships`\\n         :  +- \'SubqueryAlias `c`\\n         :     +- \'UnresolvedRelation `poc-normalized-legislator`.`persons`\\n         +- \'SubqueryAlias `d`\\n            +- \'UnresolvedRelation `poc-normalized-legislator`.`events`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685030786315, 'CompletedOn': 1685030786683}, 'ResponseMetadata': {'RequestId': '434c0b78-2165-4ef6-a398-d8742e5c382b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:06:27 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3715', 'connection': 'keep-alive', 'x-amzn-requestid': '434c0b78-2165-4ef6-a398-d8742e5c382b'}, 'RetryAttempts': 0}}
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:06:28.368327 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`events`\n"
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`events`\n"
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table `poc_curated_dbt`.`spark_sql_test_event`
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from `poc-normalized-legislator`.`organizations` as a 
inner join 
`poc-normalized-legislator`.`memberships` as b 
on a.id=b.organization_id 
inner join 
`poc-normalized-legislator`.`persons` as c 
on b.person_id = c.id
inner join 
`poc-normalized-legislator`.`events` as d
on b.organization_id = d.organization_id
  
[0m16:06:28.368327 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:06:28.368327 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:06:28.368327 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:06:28.368327 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:06:22.728888 => 2023-05-25 16:06:28.368327
[0m16:06:28.384660 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table `poc_curated_dbt`.`spark_sql_test_event`
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from `poc-normalized-legislator`.`organizations` as a 
  inner join 
  `poc-normalized-legislator`.`memberships` as b 
  on a.id=b.organization_id 
  inner join 
  `poc-normalized-legislator`.`persons` as c 
  on b.person_id = c.id
  inner join 
  `poc-normalized-legislator`.`events` as d
  on b.organization_id = d.organization_id
    '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`events`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:06:28.384660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1cef06e-c3aa-4a2d-acdd-2688cc222958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436AB16D60>]}
[0m16:06:28.384660 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 5.67s]
[0m16:06:28.384660 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:06:28.384660 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:06:28.384660 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:28.384660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:28.384660 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:06:29.454868 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:06:29.454868 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:06:29.454868 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-f08456ab-5cf3-4312-b6cd-1db8dcf26c9a
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:06:30.784781 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:06:30.784781 [debug] [MainThread]: On master: Close
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:06:30.784781 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:06:31.223116 [info ] [MainThread]: 
[0m16:06:31.223116 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 50.90 seconds (50.90s).
[0m16:06:31.223116 [debug] [MainThread]: Command end result
[0m16:06:31.243364 [info ] [MainThread]: 
[0m16:06:31.243364 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:06:31.243364 [info ] [MainThread]: 
[0m16:06:31.243364 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:06:31.243364 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:06:31.243364 [error] [MainThread]:   
[0m16:06:31.243364 [error] [MainThread]:     
[0m16:06:31.243364 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test`
[0m16:06:31.243364 [error] [MainThread]:     using PARQUET
[0m16:06:31.243364 [error] [MainThread]:   	
[0m16:06:31.243364 [error] [MainThread]:   	
[0m16:06:31.243364 [error] [MainThread]:   	
[0m16:06:31.243364 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:06:31.243364 [error] [MainThread]:   	
[0m16:06:31.243364 [error] [MainThread]:   	as
[0m16:06:31.243364 [error] [MainThread]:   	select 
[0m16:06:31.243364 [error] [MainThread]:   distinct 
[0m16:06:31.243364 [error] [MainThread]:   a.name as organization_name, 
[0m16:06:31.243364 [error] [MainThread]:   a.type as organization_type, 
[0m16:06:31.243364 [error] [MainThread]:   b.role as role, 
[0m16:06:31.243364 [error] [MainThread]:   c.name as person_name 
[0m16:06:31.243364 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m16:06:31.243364 [error] [MainThread]:   inner join 
[0m16:06:31.243364 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m16:06:31.260133 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:06:31.260133 [error] [MainThread]:   inner join 
[0m16:06:31.260133 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m16:06:31.260133 [error] [MainThread]:   on b.person_id = c.id
[0m16:06:31.260133 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 18 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3]\n      +- 'Join Inner, ('b.person_id = 'c.id)\n         :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :- 'SubqueryAlias `a`\n         :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  +- 'SubqueryAlias `b`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         +- 'SubqueryAlias `c`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n"
[0m16:06:31.260133 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:06:31.260133 [info ] [MainThread]: 
[0m16:06:31.260133 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:06:31.260133 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:06:31.260133 [error] [MainThread]:   
[0m16:06:31.260133 [error] [MainThread]:     
[0m16:06:31.260133 [error] [MainThread]:       create table `poc_curated_dbt`.`spark_sql_test_event`
[0m16:06:31.260133 [error] [MainThread]:     using PARQUET
[0m16:06:31.260133 [error] [MainThread]:   	
[0m16:06:31.260133 [error] [MainThread]:   	
[0m16:06:31.260133 [error] [MainThread]:   	
[0m16:06:31.260133 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:06:31.260133 [error] [MainThread]:   	
[0m16:06:31.260133 [error] [MainThread]:   	as
[0m16:06:31.260133 [error] [MainThread]:   	select 
[0m16:06:31.260133 [error] [MainThread]:   distinct 
[0m16:06:31.275830 [error] [MainThread]:   a.name as organization_name, 
[0m16:06:31.276326 [error] [MainThread]:   a.type as organization_type, 
[0m16:06:31.276326 [error] [MainThread]:   b.role as role, 
[0m16:06:31.276326 [error] [MainThread]:   c.name as person_name,
[0m16:06:31.276326 [error] [MainThread]:   d.name as event_name
[0m16:06:31.276326 [error] [MainThread]:   from `poc-normalized-legislator`.`organizations` as a 
[0m16:06:31.276326 [error] [MainThread]:   inner join 
[0m16:06:31.276326 [error] [MainThread]:   `poc-normalized-legislator`.`memberships` as b 
[0m16:06:31.276326 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:06:31.276326 [error] [MainThread]:   inner join 
[0m16:06:31.276326 [error] [MainThread]:   `poc-normalized-legislator`.`persons` as c 
[0m16:06:31.276326 [error] [MainThread]:   on b.person_id = c.id
[0m16:06:31.276326 [error] [MainThread]:   inner join 
[0m16:06:31.276326 [error] [MainThread]:   `poc-normalized-legislator`.`events` as d
[0m16:06:31.276326 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:06:31.276326 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc-normalized-legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#4, 'a.type AS organization_type#5, 'b.role AS role#6, 'c.name AS person_name#7, 'd.name AS event_name#8]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc-normalized-legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc-normalized-legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc-normalized-legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc-normalized-legislator`.`events`\n"
[0m16:06:31.276326 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:06:31.276326 [info ] [MainThread]: 
[0m16:06:31.276326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:06:31.276326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014369BC3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001436ABFDF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014366760430>]}
[0m16:06:31.276326 [debug] [MainThread]: Flushing usage events
[0m16:06:32.200628 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:08:09.908315 | c59a60d3-6f37-4ab9-85b3-5d55280ab64b ==============================
[0m16:08:09.908315 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:08:09.908315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:08:09.908315 [debug] [MainThread]: Tracking: tracking
[0m16:08:09.933059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAEC1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAEC1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAEC18B0>]}
[0m16:08:09.949817 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:08:09.965528 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:08:09.965528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAE6EE50>]}
[0m16:08:11.115970 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:08:11.134823 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m16:08:11.181785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C79EC940>]}
[0m16:08:11.181785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAEC1E80>]}
[0m16:08:11.181785 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:08:11.181785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAE75430>]}
[0m16:08:11.181785 [info ] [MainThread]: 
[0m16:08:11.197368 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:08:11.197368 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:08:11.197368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:11.197368 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:08:11.197368 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:08:11.197368 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:08:34.136639 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:08:34.136639 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-26266b6a-b509-40e1-810e-8f8a713bdc1d
[0m16:08:42.329224 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:08:43.432925 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:08:43.432925 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:08:43.448763 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:08:43.448763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:43.448763 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:08:44.451586 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:08:44.467169 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:08:44.467169 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-26266b6a-b509-40e1-810e-8f8a713bdc1d
[0m16:08:45.827312 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:08:46.878189 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:08:46.878189 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:08:46.878189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CB25E670>]}
[0m16:08:46.878189 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:08:46.878189 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:08:46.878189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:46.878189 [info ] [MainThread]: 
[0m16:08:46.894083 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:08:46.894083 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:08:46.894083 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:08:46.894083 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:08:46.894083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:08:46.894083 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:08:46.894083 => 2023-05-25 16:08:46.894083
[0m16:08:46.894083 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:08:46.911701 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:08:46.911701 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:08:47.907259 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:08:47.907259 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:08:47.907259 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-26266b6a-b509-40e1-810e-8f8a713bdc1d
[0m16:08:49.279520 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:50.339666 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:50.367476 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:08:50.367476 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:08:50.367476 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:08:50.367476 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 18, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name \\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 18, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name \\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685030930301, 'CompletedOn': 1685030930363}, 'ResponseMetadata': {'RequestId': '7622124d-93ff-42e4-9ae7-22b76f72738b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:08:50 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3282', 'connection': 'keep-alive', 'x-amzn-requestid': '7622124d-93ff-42e4-9ae7-22b76f72738b'}, 'RetryAttempts': 0}}
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:08:51.053411 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m16:08:51.053411 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:08:51.053411 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:08:51.053411 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:08:51.053411 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:08:46.894083 => 2023-05-25 16:08:51.053411
[0m16:08:51.053411 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:08:51.053411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C794CB20>]}
[0m16:08:51.053411 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.16s]
[0m16:08:51.053411 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:08:51.053411 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:08:51.053411 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:08:51.053411 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:08:51.053411 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:08:51.069041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:08:51.069041 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:08:51.053411 => 2023-05-25 16:08:51.069041
[0m16:08:51.069041 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:08:51.069041 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:08:51.069041 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:08:52.088337 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:08:52.088337 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:08:52.088337 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-26266b6a-b509-40e1-810e-8f8a713bdc1d
[0m16:08:53.438686 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:54.512106 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:08:54.512106 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:08:54.512106 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:08:54.512106 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:08:54.527655 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:08:54.527655 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m16:08:55.182500 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685030934457, 'CompletedOn': 1685030934472}, 'ResponseMetadata': {'RequestId': '47dcdc24-ff3a-4701-aa44-905f5ed7281c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:08:54 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3692', 'connection': 'keep-alive', 'x-amzn-requestid': '47dcdc24-ff3a-4701-aa44-905f5ed7281c'}, 'RetryAttempts': 0}}
[0m16:08:55.198022 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:08:55.198022 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:08:55.198022 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:08:55.198022 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:08:55.198022 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:08:55.198022 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:08:55.198022 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:08:55.198022 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:08:55.198022 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:08:51.069041 => 2023-05-25 16:08:55.198022
[0m16:08:55.198022 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:08:55.198022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a60d3-6f37-4ab9-85b3-5d55280ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CBDD8B80>]}
[0m16:08:55.198022 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.14s]
[0m16:08:55.198022 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:08:55.198022 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:08:55.198022 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:55.198022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:55.198022 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:08:56.186142 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:08:56.186142 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:08:56.186142 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-26266b6a-b509-40e1-810e-8f8a713bdc1d
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:08:57.490530 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:08:57.490530 [debug] [MainThread]: On master: Close
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:08:57.490530 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:08:57.870677 [info ] [MainThread]: 
[0m16:08:57.876194 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 46.69 seconds (46.69s).
[0m16:08:57.876194 [debug] [MainThread]: Command end result
[0m16:08:57.876194 [info ] [MainThread]: 
[0m16:08:57.876194 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:08:57.876194 [info ] [MainThread]: 
[0m16:08:57.876194 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:08:57.876194 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:08:57.876194 [error] [MainThread]:   
[0m16:08:57.876194 [error] [MainThread]:     
[0m16:08:57.876194 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:08:57.876194 [error] [MainThread]:     using PARQUET
[0m16:08:57.876194 [error] [MainThread]:   	
[0m16:08:57.891904 [error] [MainThread]:   	
[0m16:08:57.891904 [error] [MainThread]:   	
[0m16:08:57.891904 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:08:57.891904 [error] [MainThread]:   	
[0m16:08:57.891904 [error] [MainThread]:   	as
[0m16:08:57.891904 [error] [MainThread]:   	select 
[0m16:08:57.891904 [error] [MainThread]:   distinct 
[0m16:08:57.891904 [error] [MainThread]:   a.name as organization_name, 
[0m16:08:57.891904 [error] [MainThread]:   a.type as organization_type, 
[0m16:08:57.891904 [error] [MainThread]:   b.role as role, 
[0m16:08:57.891904 [error] [MainThread]:   c.name as person_name 
[0m16:08:57.891904 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:08:57.891904 [error] [MainThread]:   inner join 
[0m16:08:57.891904 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:08:57.891904 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:08:57.891904 [error] [MainThread]:   inner join 
[0m16:08:57.891904 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:08:57.891904 [error] [MainThread]:   on b.person_id = c.id
[0m16:08:57.891904 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:08:57.891904 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:08:57.891904 [info ] [MainThread]: 
[0m16:08:57.891904 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:08:57.891904 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:08:57.891904 [error] [MainThread]:   
[0m16:08:57.891904 [error] [MainThread]:     
[0m16:08:57.891904 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m16:08:57.891904 [error] [MainThread]:     using PARQUET
[0m16:08:57.891904 [error] [MainThread]:   	
[0m16:08:57.891904 [error] [MainThread]:   	
[0m16:08:57.907547 [error] [MainThread]:   	
[0m16:08:57.907547 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:08:57.907547 [error] [MainThread]:   	
[0m16:08:57.907547 [error] [MainThread]:   	as
[0m16:08:57.907547 [error] [MainThread]:   	select 
[0m16:08:57.907547 [error] [MainThread]:   distinct 
[0m16:08:57.907547 [error] [MainThread]:   a.name as organization_name, 
[0m16:08:57.907547 [error] [MainThread]:   a.type as organization_type, 
[0m16:08:57.907547 [error] [MainThread]:   b.role as role, 
[0m16:08:57.907547 [error] [MainThread]:   c.name as person_name,
[0m16:08:57.907547 [error] [MainThread]:   d.name as event_name
[0m16:08:57.907547 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:08:57.907547 [error] [MainThread]:   inner join 
[0m16:08:57.907547 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:08:57.907547 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:08:57.907547 [error] [MainThread]:   inner join 
[0m16:08:57.907547 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:08:57.907547 [error] [MainThread]:   on b.person_id = c.id
[0m16:08:57.907547 [error] [MainThread]:   inner join 
[0m16:08:57.907547 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m16:08:57.907547 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:08:57.907547 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:08:57.907547 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:08:57.907547 [info ] [MainThread]: 
[0m16:08:57.907547 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:08:57.907547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CBEAA5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAF0D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281CAEF9D90>]}
[0m16:08:57.907547 [debug] [MainThread]: Flushing usage events
[0m16:08:58.824990 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:09:32.173394 | e9b0132b-bb14-4382-ab1c-db8f2a7d52d1 ==============================
[0m16:09:32.173394 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:09:32.173394 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:09:32.173394 [debug] [MainThread]: Tracking: tracking
[0m16:09:32.208037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9FE81670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9FE81D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9FE818E0>]}
[0m16:09:32.208037 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:09:32.289018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:09:32.289018 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test_event.sql
[0m16:09:32.289018 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m16:09:32.304646 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m16:09:32.304646 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:09:32.320344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FA01C75B0>]}
[0m16:09:32.335966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9C920A90>]}
[0m16:09:32.335966 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:09:32.335966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9C903EB0>]}
[0m16:09:32.335966 [info ] [MainThread]: 
[0m16:09:32.335966 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:09:32.335966 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:09:32.335966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:32.335966 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:09:32.335966 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:09:32.335966 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:09:49.575248 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:09:49.575248 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e1bc9caa-be0d-4cae-93dd-93663e910c4b
[0m16:09:56.627290 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:09:57.770651 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:09:57.770651 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:09:57.770651 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:09:57.770651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:57.785930 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:09:58.796399 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:09:58.796399 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:09:58.796399 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e1bc9caa-be0d-4cae-93dd-93663e910c4b
[0m16:10:00.038304 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:10:01.103956 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:10:01.103956 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:10:01.103956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9C903F10>]}
[0m16:10:01.103956 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:10:01.103956 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:10:01.103956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:01.103956 [info ] [MainThread]: 
[0m16:10:01.119722 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:10:01.119722 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:10:01.119722 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:10:01.119722 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:10:01.119722 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:10:01.119722 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:10:01.119722 => 2023-05-25 16:10:01.119722
[0m16:10:01.119722 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:10:01.135742 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:10:01.135742 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:10:02.143960 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:10:02.143960 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:10:02.143960 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e1bc9caa-be0d-4cae-93dd-93663e910c4b
[0m16:10:03.547981 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:04.631321 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:04.668203 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:10:04.668203 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:10:04.668203 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:10:04.668203 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  ''')
[0m16:10:05.334304 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 18, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name \\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 18, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name \\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031004603, 'CompletedOn': 1685031004661}, 'ResponseMetadata': {'RequestId': '8bd86e1b-df0f-4922-b636-aa62d7af848a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:10:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3282', 'connection': 'keep-alive', 'x-amzn-requestid': '8bd86e1b-df0f-4922-b636-aa62d7af848a'}, 'RetryAttempts': 0}}
[0m16:10:05.334304 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:10:05.334304 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:10:05.349987 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:10:05.349987 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name 
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
  
[0m16:10:05.349987 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:10:05.349987 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:10:05.349987 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:10:05.349987 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:10:05.349987 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:10:01.119722 => 2023-05-25 16:10:05.349987
[0m16:10:05.354656 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name 
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:10:05.354656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FA078B850>]}
[0m16:10:05.354656 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.23s]
[0m16:10:05.354656 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:10:05.354656 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:10:05.354656 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:10:05.354656 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:10:05.354656 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:10:05.354656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:10:05.354656 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:10:05.354656 => 2023-05-25 16:10:05.354656
[0m16:10:05.354656 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:10:05.354656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:05.401719 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:10:06.435373 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:10:06.435373 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:10:06.435373 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e1bc9caa-be0d-4cae-93dd-93663e910c4b
[0m16:10:08.260717 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:09.341559 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:09.357088 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:10:09.357088 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:10:09.357088 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:10:09.357088 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031009273, 'CompletedOn': 1685031009288}, 'ResponseMetadata': {'RequestId': '10cdcfe2-984b-4c27-acb4-4e0fd518bf3a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:10:09 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3692', 'connection': 'keep-alive', 'x-amzn-requestid': '10cdcfe2-984b-4c27-acb4-4e0fd518bf3a'}, 'RetryAttempts': 0}}
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:10:10.012207 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:10:10.012207 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:10:10.012207 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:10:10.012207 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:10:10.012207 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:10:05.354656 => 2023-05-25 16:10:10.012207
[0m16:10:10.012207 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:10:10.012207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b0132b-bb14-4382-ab1c-db8f2a7d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FA0DAC970>]}
[0m16:10:10.012207 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.66s]
[0m16:10:10.012207 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:10:10.012207 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:10:10.012207 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:10.012207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:10.012207 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:10:11.067751 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:10:11.067751 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:10:11.067751 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e1bc9caa-be0d-4cae-93dd-93663e910c4b
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:10:12.471518 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:10:12.471518 [debug] [MainThread]: On master: Close
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:10:12.471518 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:10:12.937987 [info ] [MainThread]: 
[0m16:10:12.937987 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 40.60 seconds (40.60s).
[0m16:10:12.943423 [debug] [MainThread]: Command end result
[0m16:10:12.943423 [info ] [MainThread]: 
[0m16:10:12.943423 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:10:12.943423 [info ] [MainThread]: 
[0m16:10:12.943423 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:10:12.943423 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:10:12.943423 [error] [MainThread]:   
[0m16:10:12.943423 [error] [MainThread]:     
[0m16:10:12.943423 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:10:12.943423 [error] [MainThread]:     using PARQUET
[0m16:10:12.943423 [error] [MainThread]:   	
[0m16:10:12.943423 [error] [MainThread]:   	
[0m16:10:12.943423 [error] [MainThread]:   	
[0m16:10:12.943423 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:10:12.959201 [error] [MainThread]:   	
[0m16:10:12.959201 [error] [MainThread]:   	as
[0m16:10:12.959201 [error] [MainThread]:   	select 
[0m16:10:12.959201 [error] [MainThread]:   distinct 
[0m16:10:12.959201 [error] [MainThread]:   a.name as organization_name, 
[0m16:10:12.959201 [error] [MainThread]:   a.type as organization_type, 
[0m16:10:12.959201 [error] [MainThread]:   b.role as role, 
[0m16:10:12.959201 [error] [MainThread]:   c.name as person_name 
[0m16:10:12.959201 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:10:12.959201 [error] [MainThread]:   inner join 
[0m16:10:12.959201 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:10:12.959201 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:10:12.959201 [error] [MainThread]:   inner join 
[0m16:10:12.959201 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:10:12.959201 [error] [MainThread]:   on b.person_id = c.id
[0m16:10:12.959201 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 18, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name \nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\n  \n'
[0m16:10:12.959201 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:10:12.959201 [info ] [MainThread]: 
[0m16:10:12.959201 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:10:12.959201 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:10:12.959201 [error] [MainThread]:   
[0m16:10:12.959201 [error] [MainThread]:     
[0m16:10:12.959201 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m16:10:12.959201 [error] [MainThread]:     using PARQUET
[0m16:10:12.959201 [error] [MainThread]:   	
[0m16:10:12.959201 [error] [MainThread]:   	
[0m16:10:12.959201 [error] [MainThread]:   	
[0m16:10:12.959201 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:10:12.959201 [error] [MainThread]:   	
[0m16:10:12.972408 [error] [MainThread]:   	as
[0m16:10:12.972408 [error] [MainThread]:   	select 
[0m16:10:12.972408 [error] [MainThread]:   distinct 
[0m16:10:12.972408 [error] [MainThread]:   a.name as organization_name, 
[0m16:10:12.972408 [error] [MainThread]:   a.type as organization_type, 
[0m16:10:12.972408 [error] [MainThread]:   b.role as role, 
[0m16:10:12.972408 [error] [MainThread]:   c.name as person_name,
[0m16:10:12.972408 [error] [MainThread]:   d.name as event_name
[0m16:10:12.972408 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:10:12.972408 [error] [MainThread]:   inner join 
[0m16:10:12.972408 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:10:12.972408 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:10:12.972408 [error] [MainThread]:   inner join 
[0m16:10:12.972408 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:10:12.972408 [error] [MainThread]:   on b.person_id = c.id
[0m16:10:12.972408 [error] [MainThread]:   inner join 
[0m16:10:12.972408 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m16:10:12.972408 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:10:12.972408 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:10:12.972408 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:10:12.972408 [info ] [MainThread]: 
[0m16:10:12.972408 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:10:12.972408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FA0E54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9C97B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F9C903E20>]}
[0m16:10:12.972408 [debug] [MainThread]: Flushing usage events
[0m16:10:13.852321 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:17:35.620281 | 602fce10-b47e-4dd4-a4de-026c6fb874ad ==============================
[0m16:17:35.620281 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:17:35.620281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:17:35.620281 [debug] [MainThread]: Tracking: tracking
[0m16:17:35.653574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804F116D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804F11D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804F11940>]}
[0m16:17:35.653574 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:17:35.719012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:17:35.719012 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m16:17:35.719012 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:17:35.742793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805251C40>]}
[0m16:17:35.758655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8019B0850>]}
[0m16:17:35.758655 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:17:35.758655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F801993EB0>]}
[0m16:17:35.758655 [info ] [MainThread]: 
[0m16:17:35.758655 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:17:35.758655 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:17:35.758655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:35.758655 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:17:35.758655 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:17:35.758655 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:17:53.281162 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:17:53.281162 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-a54daadf-ed59-4991-bc5d-845d0d9a7112
[0m16:18:01.797225 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:18:02.811363 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:18:02.811363 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:18:02.811363 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:18:02.811363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:02.811363 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:18:03.836147 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:18:03.836147 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:18:03.836147 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-a54daadf-ed59-4991-bc5d-845d0d9a7112
[0m16:18:05.205169 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:18:06.274780 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:18:06.274780 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:18:06.274780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804F6D730>]}
[0m16:18:06.274780 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:18:06.274780 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:18:06.274780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:06.274780 [info ] [MainThread]: 
[0m16:18:06.290581 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:18:06.290581 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:18:06.290581 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:18:06.290581 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:18:06.290581 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:18:06.290581 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:18:06.290581 => 2023-05-25 16:18:06.290581
[0m16:18:06.290581 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:18:06.306997 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:18:06.306997 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:18:07.369486 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:18:07.369486 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:18:07.369486 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-a54daadf-ed59-4991-bc5d-845d0d9a7112
[0m16:18:08.836784 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:09.932031 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:09.964124 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:18:09.964124 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:18:09.964124 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:18:09.964124 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting \\\')\\\'(line 16, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom poc-normalized-legislator.organizations\\n--------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting \\\')\\\'(line 16, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom poc-normalized-legislator.organizations\\n--------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031489907, 'CompletedOn': 1685031489961}, 'ResponseMetadata': {'RequestId': 'ec0f474b-4c11-4220-abaf-98b162f3a651', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:18:10 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2803', 'connection': 'keep-alive', 'x-amzn-requestid': 'ec0f474b-4c11-4220-abaf-98b162f3a651'}, 'RetryAttempts': 0}}
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:18:10.664786 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:18:10.664786 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:18:10.664786 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:18:10.664786 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:18:10.664786 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:18:06.290581 => 2023-05-25 16:18:10.664786
[0m16:18:10.680595 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from poc-normalized-legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:18:10.680595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8058F47C0>]}
[0m16:18:10.680595 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.39s]
[0m16:18:10.680595 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:18:10.685618 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:18:10.685618 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:18:10.685618 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:18:10.685618 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:18:10.685618 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:18:10.685618 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:18:10.685618 => 2023-05-25 16:18:10.685618
[0m16:18:10.685618 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:18:10.685618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:10.685618 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:18:11.735309 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:18:11.735309 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:18:11.735309 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-a54daadf-ed59-4991-bc5d-845d0d9a7112
[0m16:18:13.035337 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:14.123441 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:18:14.123441 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:18:14.123441 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:18:14.123441 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031494000, 'CompletedOn': 1685031494025}, 'ResponseMetadata': {'RequestId': 'be8cec75-0b62-4bfb-9254-8f322f177a61', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:18:14 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3692', 'connection': 'keep-alive', 'x-amzn-requestid': 'be8cec75-0b62-4bfb-9254-8f322f177a61'}, 'RetryAttempts': 0}}
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:18:14.725094 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:18:14.725094 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:18:14.725094 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:18:14.725094 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:18:14.725094 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:18:10.685618 => 2023-05-25 16:18:14.725094
[0m16:18:14.742090 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:18:14.742090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '602fce10-b47e-4dd4-a4de-026c6fb874ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805E5EB20>]}
[0m16:18:14.742090 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.06s]
[0m16:18:14.742090 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:18:14.742090 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:18:14.742090 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:14.742090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:14.742090 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:18:15.868009 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:18:15.883748 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:18:15.883748 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-a54daadf-ed59-4991-bc5d-845d0d9a7112
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:18:17.261130 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:18:17.261130 [debug] [MainThread]: On master: Close
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:18:17.261130 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:18:17.677250 [info ] [MainThread]: 
[0m16:18:17.677250 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 41.92 seconds (41.92s).
[0m16:18:17.677250 [debug] [MainThread]: Command end result
[0m16:18:17.698760 [info ] [MainThread]: 
[0m16:18:17.698760 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:18:17.698760 [info ] [MainThread]: 
[0m16:18:17.698760 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:18:17.698760 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:18:17.698760 [error] [MainThread]:   
[0m16:18:17.698760 [error] [MainThread]:     
[0m16:18:17.698760 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:18:17.698760 [error] [MainThread]:     using PARQUET
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	as
[0m16:18:17.698760 [error] [MainThread]:   	with org as (
[0m16:18:17.698760 [error] [MainThread]:   select 
[0m16:18:17.698760 [error] [MainThread]:   organization_name,
[0m16:18:17.698760 [error] [MainThread]:   organization_type
[0m16:18:17.698760 [error] [MainThread]:   from poc-normalized-legislator.organizations
[0m16:18:17.698760 [error] [MainThread]:   )
[0m16:18:17.698760 [error] [MainThread]:   select distinct 
[0m16:18:17.698760 [error] [MainThread]:   organization_name, 
[0m16:18:17.698760 [error] [MainThread]:   organization_type
[0m16:18:17.698760 [error] [MainThread]:   from org
[0m16:18:17.698760 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:18:17.698760 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:18:17.698760 [info ] [MainThread]: 
[0m16:18:17.698760 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:18:17.698760 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:18:17.698760 [error] [MainThread]:   
[0m16:18:17.698760 [error] [MainThread]:     
[0m16:18:17.698760 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m16:18:17.698760 [error] [MainThread]:     using PARQUET
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:18:17.698760 [error] [MainThread]:   	
[0m16:18:17.698760 [error] [MainThread]:   	as
[0m16:18:17.714488 [error] [MainThread]:   	select 
[0m16:18:17.714488 [error] [MainThread]:   distinct 
[0m16:18:17.714488 [error] [MainThread]:   a.name as organization_name, 
[0m16:18:17.714488 [error] [MainThread]:   a.type as organization_type, 
[0m16:18:17.714488 [error] [MainThread]:   b.role as role, 
[0m16:18:17.714488 [error] [MainThread]:   c.name as person_name,
[0m16:18:17.714488 [error] [MainThread]:   d.name as event_name
[0m16:18:17.714488 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:18:17.714488 [error] [MainThread]:   inner join 
[0m16:18:17.714488 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:18:17.714488 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:18:17.714488 [error] [MainThread]:   inner join 
[0m16:18:17.714488 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:18:17.714488 [error] [MainThread]:   on b.person_id = c.id
[0m16:18:17.714488 [error] [MainThread]:   inner join 
[0m16:18:17.714488 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m16:18:17.714488 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:18:17.714488 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:18:17.714488 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:18:17.714488 [info ] [MainThread]: 
[0m16:18:17.714488 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:18:17.714488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8058380D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F801993F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8058A8BE0>]}
[0m16:18:17.714488 [debug] [MainThread]: Flushing usage events
[0m16:18:18.631588 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:21:57.375361 | 4d4da6cf-2961-425b-bd25-f66a21355305 ==============================
[0m16:21:57.375361 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:21:57.375361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:21:57.375361 [debug] [MainThread]: Tracking: tracking
[0m16:21:57.405199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D048F670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D048FD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D048F910>]}
[0m16:21:57.420827 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:21:58.021245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:58.021245 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\schema.yml
[0m16:21:58.036910 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:21:58.053137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D07DB8E0>]}
[0m16:21:58.068961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D04EDA30>]}
[0m16:21:58.068961 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:21:58.068961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D04EDB20>]}
[0m16:21:58.068961 [info ] [MainThread]: 
[0m16:21:58.068961 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:21:58.068961 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:21:58.068961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:58.068961 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:21:58.068961 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:21:58.068961 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:22:21.007746 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:22:21.007746 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-835e1af5-e9b1-48c6-b490-75b2b28dd052
[0m16:22:27.983634 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:22:29.118127 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:22:29.118127 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:22:29.118127 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:22:29.118127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:29.118127 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:22:30.305209 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:22:30.305209 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:22:30.305209 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-835e1af5-e9b1-48c6-b490-75b2b28dd052
[0m16:22:31.671842 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:22:32.694272 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:22:32.694272 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:22:32.694272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D07D9A00>]}
[0m16:22:32.694272 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:22:32.694272 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:22:32.694272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:32.694272 [info ] [MainThread]: 
[0m16:22:32.709901 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:22:32.709901 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:22:32.709901 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:22:32.709901 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:22:32.709901 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:22:32.709901 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:22:32.709901 => 2023-05-25 16:22:32.709901
[0m16:22:32.709901 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:22:32.725566 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:22:32.725566 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:22:33.797319 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:22:33.797319 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:22:33.797319 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-835e1af5-e9b1-48c6-b490-75b2b28dd052
[0m16:22:35.180767 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:36.270476 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:36.306958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:22:36.306958 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:22:36.306958 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:22:36.306958 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:22:36.956072 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting \\\')\\\'(line 16, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom poc-normalized-legislator.organizations\\n--------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting \\\')\\\'(line 16, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom poc-normalized-legislator.organizations\\n--------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031756220, 'CompletedOn': 1685031756281}, 'ResponseMetadata': {'RequestId': 'dced0952-37dc-49b2-93c2-f9f66a11aacb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:22:36 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2803', 'connection': 'keep-alive', 'x-amzn-requestid': 'dced0952-37dc-49b2-93c2-f9f66a11aacb'}, 'RetryAttempts': 0}}
[0m16:22:36.956072 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:22:36.956072 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:22:36.956072 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:22:36.956072 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc-normalized-legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:22:36.971671 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:22:36.971671 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:22:36.971671 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:22:36.971671 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:22:36.971671 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:22:32.709901 => 2023-05-25 16:22:36.971671
[0m16:22:37.024429 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from poc-normalized-legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:22:37.024429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D07D95B0>]}
[0m16:22:37.024429 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 4.31s]
[0m16:22:37.024429 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:22:37.024429 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:22:37.024429 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:22:37.024429 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:22:37.024429 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:22:37.024429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:22:37.040112 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:22:37.024429 => 2023-05-25 16:22:37.040112
[0m16:22:37.040112 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:22:37.040112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:22:37.040112 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:22:38.058117 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:22:38.058117 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:22:38.058117 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-835e1af5-e9b1-48c6-b490-75b2b28dd052
[0m16:22:39.414156 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:40.448144 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:40.463735 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:22:40.463735 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:22:40.463735 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:22:40.463735 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'-\\\' expecting <EOF>(line 19, pos 8)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test_event\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\\\'\\n\\t\\n\\tas\\n\\tselect \\ndistinct \\na.name as organization_name, \\na.type as organization_type, \\nb.role as role, \\nc.name as person_name,\\nd.name as event_name\\nfrom poc-normalized-legislator.organizations as a \\n--------^^^\\ninner join \\npoc-normalized-legislator.memberships as b \\non a.id=b.organization_id \\ninner join \\npoc-normalized-legislator.persons as c \\non b.person_id = c.id\\ninner join \\npoc-normalized-legislator.events as d\\non b.organization_id = d.organization_id\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685031760390, 'CompletedOn': 1685031760409}, 'ResponseMetadata': {'RequestId': '77f78d74-cf1b-4427-8223-5c8e00ea8880', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:22:40 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3692', 'connection': 'keep-alive', 'x-amzn-requestid': '77f78d74-cf1b-4427-8223-5c8e00ea8880'}, 'RetryAttempts': 0}}
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:22:41.119058 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc-normalized-legislator.organizations as a 
inner join 
poc-normalized-legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc-normalized-legislator.persons as c 
on b.person_id = c.id
inner join 
poc-normalized-legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:22:41.119058 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:22:41.119058 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:22:41.119058 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:22:41.119058 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:22:37.040112 => 2023-05-25 16:22:41.119058
[0m16:22:41.134694 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc-normalized-legislator.organizations as a 
  inner join 
  poc-normalized-legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc-normalized-legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc-normalized-legislator.events as d
  on b.organization_id = d.organization_id
    '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:22:41.134694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4da6cf-2961-425b-bd25-f66a21355305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D13F00A0>]}
[0m16:22:41.134694 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 4.11s]
[0m16:22:41.134694 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:22:41.134694 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:22:41.140905 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:41.140905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:41.140905 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:22:42.237492 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:22:42.237492 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:22:42.237492 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-835e1af5-e9b1-48c6-b490-75b2b28dd052
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:22:43.672387 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:22:43.672387 [debug] [MainThread]: On master: Close
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:22:43.672387 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:22:44.106982 [info ] [MainThread]: 
[0m16:22:44.106982 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 46.04 seconds (46.04s).
[0m16:22:44.106982 [debug] [MainThread]: Command end result
[0m16:22:44.122593 [info ] [MainThread]: 
[0m16:22:44.122593 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:22:44.122593 [info ] [MainThread]: 
[0m16:22:44.122593 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:22:44.122593 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:22:44.122593 [error] [MainThread]:   
[0m16:22:44.122593 [error] [MainThread]:     
[0m16:22:44.122593 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:22:44.122593 [error] [MainThread]:     using PARQUET
[0m16:22:44.122593 [error] [MainThread]:   	
[0m16:22:44.122593 [error] [MainThread]:   	
[0m16:22:44.122593 [error] [MainThread]:   	
[0m16:22:44.122593 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:22:44.122593 [error] [MainThread]:   	
[0m16:22:44.122593 [error] [MainThread]:   	as
[0m16:22:44.122593 [error] [MainThread]:   	with org as (
[0m16:22:44.122593 [error] [MainThread]:   select 
[0m16:22:44.122593 [error] [MainThread]:   organization_name,
[0m16:22:44.122593 [error] [MainThread]:   organization_type
[0m16:22:44.122593 [error] [MainThread]:   from poc-normalized-legislator.organizations
[0m16:22:44.122593 [error] [MainThread]:   )
[0m16:22:44.122593 [error] [MainThread]:   select distinct 
[0m16:22:44.122593 [error] [MainThread]:   organization_name, 
[0m16:22:44.122593 [error] [MainThread]:   organization_type
[0m16:22:44.138213 [error] [MainThread]:   from org
[0m16:22:44.142289 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting \')\'(line 16, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc-normalized-legislator.organizations\n--------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:22:44.142289 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:22:44.142289 [info ] [MainThread]: 
[0m16:22:44.142289 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:22:44.142289 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:22:44.142289 [error] [MainThread]:   
[0m16:22:44.142289 [error] [MainThread]:     
[0m16:22:44.142289 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m16:22:44.142289 [error] [MainThread]:     using PARQUET
[0m16:22:44.142289 [error] [MainThread]:   	
[0m16:22:44.142289 [error] [MainThread]:   	
[0m16:22:44.142289 [error] [MainThread]:   	
[0m16:22:44.142289 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:22:44.142289 [error] [MainThread]:   	
[0m16:22:44.142289 [error] [MainThread]:   	as
[0m16:22:44.142289 [error] [MainThread]:   	select 
[0m16:22:44.142289 [error] [MainThread]:   distinct 
[0m16:22:44.142289 [error] [MainThread]:   a.name as organization_name, 
[0m16:22:44.142289 [error] [MainThread]:   a.type as organization_type, 
[0m16:22:44.142289 [error] [MainThread]:   b.role as role, 
[0m16:22:44.142289 [error] [MainThread]:   c.name as person_name,
[0m16:22:44.142289 [error] [MainThread]:   d.name as event_name
[0m16:22:44.142289 [error] [MainThread]:   from poc-normalized-legislator.organizations as a 
[0m16:22:44.142289 [error] [MainThread]:   inner join 
[0m16:22:44.142289 [error] [MainThread]:   poc-normalized-legislator.memberships as b 
[0m16:22:44.142289 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:22:44.142289 [error] [MainThread]:   inner join 
[0m16:22:44.142289 [error] [MainThread]:   poc-normalized-legislator.persons as c 
[0m16:22:44.142289 [error] [MainThread]:   on b.person_id = c.id
[0m16:22:44.142289 [error] [MainThread]:   inner join 
[0m16:22:44.142289 [error] [MainThread]:   poc-normalized-legislator.events as d
[0m16:22:44.142289 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:22:44.142289 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'-\' expecting <EOF>(line 19, pos 8)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc-normalized-legislator.organizations as a \n--------^^^\ninner join \npoc-normalized-legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc-normalized-legislator.persons as c \non b.person_id = c.id\ninner join \npoc-normalized-legislator.events as d\non b.organization_id = d.organization_id\n  \n'
[0m16:22:44.142289 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:22:44.142289 [info ] [MainThread]: 
[0m16:22:44.142289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:22:44.142289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D0DF9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D12980D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1D1298400>]}
[0m16:22:44.142289 [debug] [MainThread]: Flushing usage events
[0m16:22:45.044336 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:24:14.018233 | f68b5174-93df-4422-bcb7-4c49f274ed31 ==============================
[0m16:24:14.018233 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:24:14.018233 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:24:14.018233 [debug] [MainThread]: Tracking: tracking
[0m16:24:14.055272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A63A316A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A63A31D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A63A31910>]}
[0m16:24:14.055272 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:24:14.136230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:14.136230 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m16:24:14.136230 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:24:14.155071 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test_event.sql
[0m16:24:14.186450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A60576EE0>]}
[0m16:24:14.186450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A604F56A0>]}
[0m16:24:14.186450 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:24:14.186450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A604F5820>]}
[0m16:24:14.186450 [info ] [MainThread]: 
[0m16:24:14.186450 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:24:14.186450 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:24:14.186450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:14.186450 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:24:14.186450 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:24:14.186450 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:24:36.751557 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:24:36.751557 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-74df2c4e-12f7-4c53-8153-c189b4236bc7
[0m16:24:45.080440 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:24:46.165970 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:24:46.165970 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:24:46.181545 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:24:46.181545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:46.181545 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:24:47.236946 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:24:47.236946 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:24:47.236946 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-74df2c4e-12f7-4c53-8153-c189b4236bc7
[0m16:24:48.618673 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:24:49.657845 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:24:49.657845 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:24:49.657845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A604F5130>]}
[0m16:24:49.673620 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:24:49.673700 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:24:49.673700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:49.673700 [info ] [MainThread]: 
[0m16:24:49.673700 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:24:49.673700 [info ] [Thread-1  ]: 1 of 2 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:24:49.673700 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:24:49.673700 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:24:49.673700 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:24:49.689560 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:24:49.673700 => 2023-05-25 16:24:49.689560
[0m16:24:49.690064 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:24:49.690064 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:24:49.690064 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:24:50.704898 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:24:50.704898 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:24:50.704898 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-74df2c4e-12f7-4c53-8153-c189b4236bc7
[0m16:24:52.111910 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:53.166872 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:24:53.182697 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:53.198322 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:24:53.198322 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:24:53.198322 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:24:53.198322 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc_normalized_legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685031893113, 'CompletedOn': 1685031893666}, 'ResponseMetadata': {'RequestId': '4084b494-3fb6-4bc0-877a-ad387c3c3c1c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:24:54 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2264', 'connection': 'keep-alive', 'x-amzn-requestid': '4084b494-3fb6-4bc0-877a-ad387c3c3c1c'}, 'RetryAttempts': 0}}
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:24:55.185479 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:24:55.185479 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:24:55.185479 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:24:55.185479 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:24:55.185479 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:24:49.690064 => 2023-05-25 16:24:55.185479
[0m16:24:55.195884 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from poc_normalized_legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:24:55.195884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A648020D0>]}
[0m16:24:55.195884 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.52s]
[0m16:24:55.195884 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:24:55.195884 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test_event
[0m16:24:55.195884 [info ] [Thread-1  ]: 2 of 2 START sql table model poc_curated_dbt.spark_sql_test_event .............. [RUN]
[0m16:24:55.195884 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test_event'
[0m16:24:55.195884 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test_event
[0m16:24:55.195884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:24:55.195884 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (compile): 2023-05-25 16:24:55.195884 => 2023-05-25 16:24:55.195884
[0m16:24:55.195884 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test_event
[0m16:24:55.243471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:55.243471 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:24:56.387752 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:24:56.387752 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:24:56.387752 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-74df2c4e-12f7-4c53-8153-c189b4236bc7
[0m16:24:57.722869 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test_event not found.
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:58.810292 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test_event"
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:24:58.810292 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test_event"
[0m16:24:58.810292 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc_normalized_legislator.organizations as a 
inner join 
poc_normalized_legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc_normalized_legislator.persons as c 
on b.person_id = c.id
inner join 
poc_normalized_legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:24:58.810292 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc_normalized_legislator.organizations as a 
inner join 
poc_normalized_legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc_normalized_legislator.persons as c 
on b.person_id = c.id
inner join 
poc_normalized_legislator.events as d
on b.organization_id = d.organization_id
  ''')
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 9, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test_event\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/\'\n\t\n\tas\n\tselect \ndistinct \na.name as organization_name, \na.type as organization_type, \nb.role as role, \nc.name as person_name,\nd.name as event_name\nfrom poc_normalized_legislator.organizations as a \ninner join \npoc_normalized_legislator.memberships as b \non a.id=b.organization_id \ninner join \npoc_normalized_legislator.persons as c \non b.person_id = c.id\ninner join \npoc_normalized_legislator.events as d\non b.organization_id = d.organization_id\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 9, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#0, \'a.type AS organization_type#1, \'b.role AS role#2, \'c.name AS person_name#3, \'d.name AS event_name#4]\\n      +- \'Join Inner, (\'b.organization_id = \'d.organization_id)\\n         :- \'Join Inner, (\'b.person_id = \'c.id)\\n         :  :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :  :- \'SubqueryAlias `a`\\n         :  :  :  +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n         :  :  +- \'SubqueryAlias `b`\\n         :  :     +- \'UnresolvedRelation `poc_normalized_legislator`.`memberships`\\n         :  +- \'SubqueryAlias `c`\\n         :     +- \'UnresolvedRelation `poc_normalized_legislator`.`persons`\\n         +- \'SubqueryAlias `d`\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`events`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'a.name AS organization_name#0, \'a.type AS organization_type#1, \'b.role AS role#2, \'c.name AS person_name#3, \'d.name AS event_name#4]\\n      +- \'Join Inner, (\'b.organization_id = \'d.organization_id)\\n         :- \'Join Inner, (\'b.person_id = \'c.id)\\n         :  :- \'Join Inner, (\'a.id = \'b.organization_id)\\n         :  :  :- \'SubqueryAlias `a`\\n         :  :  :  +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n         :  :  +- \'SubqueryAlias `b`\\n         :  :     +- \'UnresolvedRelation `poc_normalized_legislator`.`memberships`\\n         :  +- \'SubqueryAlias `c`\\n         :     +- \'UnresolvedRelation `poc_normalized_legislator`.`persons`\\n         +- \'SubqueryAlias `d`\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`events`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685031898790, 'CompletedOn': 1685031899184}, 'ResponseMetadata': {'RequestId': '8ae103a4-928f-4679-a73c-528b39bf4b2c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:25:00 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3695', 'connection': 'keep-alive', 'x-amzn-requestid': '8ae103a4-928f-4679-a73c-528b39bf4b2c'}, 'RetryAttempts': 0}}
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:25:00.899563 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc_normalized_legislator.organizations as a 
inner join 
poc_normalized_legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc_normalized_legislator.persons as c 
on b.person_id = c.id
inner join 
poc_normalized_legislator.events as d
on b.organization_id = d.organization_id
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3, 'd.name AS event_name#4]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc_normalized_legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc_normalized_legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`events`\n"
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc_normalized_legislator.organizations as a 
inner join 
poc_normalized_legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc_normalized_legislator.persons as c 
on b.person_id = c.id
inner join 
poc_normalized_legislator.events as d
on b.organization_id = d.organization_id
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3, 'd.name AS event_name#4]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc_normalized_legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc_normalized_legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`events`\n"
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */

  
    create table poc_curated_dbt.spark_sql_test_event
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
	
	as
	select 
distinct 
a.name as organization_name, 
a.type as organization_type, 
b.role as role, 
c.name as person_name,
d.name as event_name
from poc_normalized_legislator.organizations as a 
inner join 
poc_normalized_legislator.memberships as b 
on a.id=b.organization_id 
inner join 
poc_normalized_legislator.persons as c 
on b.person_id = c.id
inner join 
poc_normalized_legislator.events as d
on b.organization_id = d.organization_id
  
[0m16:25:00.899563 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: ROLLBACK
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:25:00.899563 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test_event: Close
[0m16:25:00.899563 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:25:00.899563 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test_event (execute): 2023-05-25 16:24:55.195884 => 2023-05-25 16:25:00.899563
[0m16:25:00.899563 [debug] [Thread-1  ]: Database Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
  
    
      create table poc_curated_dbt.spark_sql_test_event
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
  	
  	as
  	select 
  distinct 
  a.name as organization_name, 
  a.type as organization_type, 
  b.role as role, 
  c.name as person_name,
  d.name as event_name
  from poc_normalized_legislator.organizations as a 
  inner join 
  poc_normalized_legislator.memberships as b 
  on a.id=b.organization_id 
  inner join 
  poc_normalized_legislator.persons as c 
  on b.person_id = c.id
  inner join 
  poc_normalized_legislator.events as d
  on b.organization_id = d.organization_id
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3, 'd.name AS event_name#4]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc_normalized_legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc_normalized_legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`events`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:25:00.899563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68b5174-93df-4422-bcb7-4c49f274ed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A649607F0>]}
[0m16:25:00.899563 [error] [Thread-1  ]: 2 of 2 ERROR creating sql table model poc_curated_dbt.spark_sql_test_event ..... [[31mERROR[0m in 5.70s]
[0m16:25:00.915088 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test_event
[0m16:25:00.917608 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:25:00.917608 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:00.917608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:00.917608 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:25:02.001272 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:25:02.001272 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:25:02.001272 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-74df2c4e-12f7-4c53-8153-c189b4236bc7
[0m16:25:03.472521 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:25:03.472521 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:25:03.472521 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:25:03.472521 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:03.472521 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:25:03.472521 [debug] [MainThread]: On master: Close
[0m16:25:03.488223 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:25:03.488223 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:25:03.952843 [info ] [MainThread]: 
[0m16:25:03.952843 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 49.77 seconds (49.77s).
[0m16:25:03.952843 [debug] [MainThread]: Command end result
[0m16:25:03.968683 [info ] [MainThread]: 
[0m16:25:03.968683 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:25:03.968683 [info ] [MainThread]: 
[0m16:25:03.974305 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:25:03.974305 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:25:03.974305 [error] [MainThread]:   
[0m16:25:03.974305 [error] [MainThread]:     
[0m16:25:03.974305 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:25:03.974305 [error] [MainThread]:     using PARQUET
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	as
[0m16:25:03.974305 [error] [MainThread]:   	with org as (
[0m16:25:03.974305 [error] [MainThread]:   select 
[0m16:25:03.974305 [error] [MainThread]:   organization_name,
[0m16:25:03.974305 [error] [MainThread]:   organization_type
[0m16:25:03.974305 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m16:25:03.974305 [error] [MainThread]:   )
[0m16:25:03.974305 [error] [MainThread]:   select distinct 
[0m16:25:03.974305 [error] [MainThread]:   organization_name, 
[0m16:25:03.974305 [error] [MainThread]:   organization_type
[0m16:25:03.974305 [error] [MainThread]:   from org
[0m16:25:03.974305 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:25:03.974305 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:25:03.974305 [info ] [MainThread]: 
[0m16:25:03.974305 [error] [MainThread]: [33mDatabase Error in model spark_sql_test_event (models\gold_metrics\spark_sql_test_event.sql)[0m
[0m16:25:03.974305 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test_event"} */
[0m16:25:03.974305 [error] [MainThread]:   
[0m16:25:03.974305 [error] [MainThread]:     
[0m16:25:03.974305 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test_event
[0m16:25:03.974305 [error] [MainThread]:     using PARQUET
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test_event/'
[0m16:25:03.974305 [error] [MainThread]:   	
[0m16:25:03.974305 [error] [MainThread]:   	as
[0m16:25:03.974305 [error] [MainThread]:   	select 
[0m16:25:03.974305 [error] [MainThread]:   distinct 
[0m16:25:03.989937 [error] [MainThread]:   a.name as organization_name, 
[0m16:25:03.989937 [error] [MainThread]:   a.type as organization_type, 
[0m16:25:03.989937 [error] [MainThread]:   b.role as role, 
[0m16:25:03.989937 [error] [MainThread]:   c.name as person_name,
[0m16:25:03.989937 [error] [MainThread]:   d.name as event_name
[0m16:25:03.989937 [error] [MainThread]:   from poc_normalized_legislator.organizations as a 
[0m16:25:03.989937 [error] [MainThread]:   inner join 
[0m16:25:03.989937 [error] [MainThread]:   poc_normalized_legislator.memberships as b 
[0m16:25:03.989937 [error] [MainThread]:   on a.id=b.organization_id 
[0m16:25:03.989937 [error] [MainThread]:   inner join 
[0m16:25:03.989937 [error] [MainThread]:   poc_normalized_legislator.persons as c 
[0m16:25:03.989937 [error] [MainThread]:   on b.person_id = c.id
[0m16:25:03.989937 [error] [MainThread]:   inner join 
[0m16:25:03.989937 [error] [MainThread]:   poc_normalized_legislator.events as d
[0m16:25:03.989937 [error] [MainThread]:   on b.organization_id = d.organization_id
[0m16:25:03.989937 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 19 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test_event`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['a.name AS organization_name#0, 'a.type AS organization_type#1, 'b.role AS role#2, 'c.name AS person_name#3, 'd.name AS event_name#4]\n      +- 'Join Inner, ('b.organization_id = 'd.organization_id)\n         :- 'Join Inner, ('b.person_id = 'c.id)\n         :  :- 'Join Inner, ('a.id = 'b.organization_id)\n         :  :  :- 'SubqueryAlias `a`\n         :  :  :  +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n         :  :  +- 'SubqueryAlias `b`\n         :  :     +- 'UnresolvedRelation `poc_normalized_legislator`.`memberships`\n         :  +- 'SubqueryAlias `c`\n         :     +- 'UnresolvedRelation `poc_normalized_legislator`.`persons`\n         +- 'SubqueryAlias `d`\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`events`\n"
[0m16:25:03.989937 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test_event.sql
[0m16:25:03.989937 [info ] [MainThread]: 
[0m16:25:03.989937 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:25:03.989937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A64A078E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A64803AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A60442E80>]}
[0m16:25:03.989937 [debug] [MainThread]: Flushing usage events
[0m16:25:04.893368 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:30:26.330024 | 46656be8-3dca-4d32-b175-68ea79c381d6 ==============================
[0m16:30:26.330024 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:30:26.330024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:26.330024 [debug] [MainThread]: Tracking: tracking
[0m16:30:26.367910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017786FC25B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017786FC2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017786FC2820>]}
[0m16:30:26.385854 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:30:26.455090 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m16:30:26.455090 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\schema.yml
[0m16:30:26.455090 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m16:30:26.455090 [debug] [MainThread]: Partial parsing: deleted file: dbtgluepoc://models\gold_metrics\spark_sql_test_event.sql
[0m16:30:26.471341 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:30:26.503186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46656be8-3dca-4d32-b175-68ea79c381d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017783B06F10>]}
[0m16:30:26.503186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46656be8-3dca-4d32-b175-68ea79c381d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017787010490>]}
[0m16:30:26.503186 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:30:26.503186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46656be8-3dca-4d32-b175-68ea79c381d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017787010910>]}
[0m16:30:26.503186 [info ] [MainThread]: 
[0m16:30:26.503186 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:30:26.503186 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:30:26.503186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:26.503186 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:30:26.503186 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:30:26.503186 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:30:44.090194 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:30:44.090194 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a3a5652-8771-47a7-90b9-fc1169b349b6
[0m16:30:52.208503 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:30:53.343112 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:30:53.343112 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:30:53.343112 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:30:53.343112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:53.343112 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:30:54.392597 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:30:54.392597 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:30:54.392597 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a3a5652-8771-47a7-90b9-fc1169b349b6
[0m16:30:56.032544 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:30:57.086258 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:30:57.086258 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:30:57.086258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46656be8-3dca-4d32-b175-68ea79c381d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017787010610>]}
[0m16:30:57.086258 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:30:57.086258 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:30:57.086258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:57.086258 [info ] [MainThread]: 
[0m16:30:57.102135 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:30:57.102135 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:30:57.102135 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:30:57.102135 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:30:57.102135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:30:57.102135 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:30:57.102135 => 2023-05-25 16:30:57.102135
[0m16:30:57.102135 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:30:57.102135 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:30:57.102135 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:30:58.737775 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:30:58.737775 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:30:58.737775 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a3a5652-8771-47a7-90b9-fc1169b349b6
[0m16:31:00.171788 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:31:01.257119 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:31:01.303997 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:31:01.303997 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:31:01.303997 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:31:01.303997 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:31:03.344380 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc_normalized_legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685032261248, 'CompletedOn': 1685032261851}, 'ResponseMetadata': {'RequestId': 'cf2337a8-873e-43cb-8bce-86d21abe1aae', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:31:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2264', 'connection': 'keep-alive', 'x-amzn-requestid': 'cf2337a8-873e-43cb-8bce-86d21abe1aae'}, 'RetryAttempts': 0}}
[0m16:31:03.344380 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:31:03.360096 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:31:03.360096 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:31:03.360096 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:31:03.360096 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:31:03.360096 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:31:03.360096 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:31:03.360096 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:31:03.360096 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:30:57.102135 => 2023-05-25 16:31:03.360096
[0m16:31:03.367820 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from poc_normalized_legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:31:03.367820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46656be8-3dca-4d32-b175-68ea79c381d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017787010610>]}
[0m16:31:03.367820 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.27s]
[0m16:31:03.367820 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:31:03.367820 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:31:03.367820 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:03.367820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:03.367820 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:31:04.394200 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:31:04.394200 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:31:04.394200 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-6a3a5652-8771-47a7-90b9-fc1169b349b6
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:31:05.781529 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:31:05.781529 [debug] [MainThread]: On master: Close
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:31:05.781529 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:31:06.201159 [info ] [MainThread]: 
[0m16:31:06.201159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.70 seconds (39.70s).
[0m16:31:06.217273 [debug] [MainThread]: Command end result
[0m16:31:06.217273 [info ] [MainThread]: 
[0m16:31:06.217273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:06.217273 [info ] [MainThread]: 
[0m16:31:06.217273 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:31:06.217273 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:31:06.217273 [error] [MainThread]:   
[0m16:31:06.217273 [error] [MainThread]:     
[0m16:31:06.233003 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:31:06.235298 [error] [MainThread]:     using PARQUET
[0m16:31:06.235298 [error] [MainThread]:   	
[0m16:31:06.235298 [error] [MainThread]:   	
[0m16:31:06.235298 [error] [MainThread]:   	
[0m16:31:06.235298 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:31:06.235298 [error] [MainThread]:   	
[0m16:31:06.235298 [error] [MainThread]:   	as
[0m16:31:06.235298 [error] [MainThread]:   	with org as (
[0m16:31:06.235298 [error] [MainThread]:   select 
[0m16:31:06.235298 [error] [MainThread]:   organization_name,
[0m16:31:06.235298 [error] [MainThread]:   organization_type
[0m16:31:06.235298 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m16:31:06.235298 [error] [MainThread]:   )
[0m16:31:06.235298 [error] [MainThread]:   select distinct 
[0m16:31:06.235298 [error] [MainThread]:   organization_name, 
[0m16:31:06.235298 [error] [MainThread]:   organization_type
[0m16:31:06.235298 [error] [MainThread]:   from org
[0m16:31:06.235298 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:31:06.235298 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:31:06.235298 [info ] [MainThread]: 
[0m16:31:06.235298 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:31:06.235298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017787EF7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017784FF67C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017786F457C0>]}
[0m16:31:06.235298 [debug] [MainThread]: Flushing usage events
[0m16:31:07.183815 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:38:08.917364 | bcd089fc-1658-4271-bd08-541efd129302 ==============================
[0m16:38:08.917364 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:38:08.917364 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:38:08.917364 [debug] [MainThread]: Tracking: tracking
[0m16:38:08.952965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB68441550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB68441C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB68441820>]}
[0m16:38:08.969178 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:38:09.782695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:09.782695 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m16:38:09.797746 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:38:09.819761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd089fc-1658-4271-bd08-541efd129302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6877AEB0>]}
[0m16:38:09.831578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd089fc-1658-4271-bd08-541efd129302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB64ED4EB0>]}
[0m16:38:09.831578 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:38:09.832584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd089fc-1658-4271-bd08-541efd129302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB683EFEE0>]}
[0m16:38:09.833775 [info ] [MainThread]: 
[0m16:38:09.833775 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:38:09.833775 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:38:09.833775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:09.833775 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:38:09.833775 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:38:09.833775 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:38:32.506123 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:38:32.506123 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-5a14c01c-3784-4ab3-b82f-71e1ed30b617
[0m16:38:40.830642 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:38:42.016459 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:38:42.016459 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:38:42.031779 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:38:42.032692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:42.032692 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:38:43.174770 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:38:43.174770 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:38:43.178876 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-5a14c01c-3784-4ab3-b82f-71e1ed30b617
[0m16:38:44.580682 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:38:45.658381 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:38:45.659379 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:38:45.660376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd089fc-1658-4271-bd08-541efd129302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB64ED4D60>]}
[0m16:38:45.661378 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:38:45.662375 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:38:45.663220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:45.663220 [info ] [MainThread]: 
[0m16:38:45.663220 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:38:45.663220 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:38:45.679135 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:38:45.679135 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:38:45.683650 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:38:45.683650 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:38:45.679135 => 2023-05-25 16:38:45.683650
[0m16:38:45.683650 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:38:45.699375 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:38:45.699375 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:38:46.813990 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:38:46.814993 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:38:46.814993 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-5a14c01c-3784-4ab3-b82f-71e1ed30b617
[0m16:38:49.491421 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:38:50.615394 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:38:50.664912 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:38:50.664912 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:38:50.679292 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:38:50.679292 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:38:50.680835 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from glue_catalog.poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:38:50.681350 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:38:50.681350 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:38:50.681350 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:38:50.681350 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:38:50.681350 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from glue_catalog.poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:38:51.381788 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom glue_catalog.poc_normalized_legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'ParseException', 'ErrorValue': '\'\\nmismatched input \\\'.\\\' expecting \\\')\\\'(line 16, pos 43)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom glue_catalog.poc_normalized_legislator.organizations\\n-------------------------------------------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 73, in deco\n    raise ParseException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.ParseException: \'\\nmismatched input \\\'.\\\' expecting \\\')\\\'(line 16, pos 43)\\n\\n== SQL ==\\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\\n\\n  \\n    create table poc_curated_dbt.spark_sql_test\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \\\'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\\\'\\n\\t\\n\\tas\\n\\twith org as (\\nselect \\norganization_name,\\norganization_type\\nfrom glue_catalog.poc_normalized_legislator.organizations\\n-------------------------------------------^^^\\n)\\nselect distinct \\norganization_name, \\norganization_type\\nfrom org\\n  \\n\'\n']}, 'Progress': 1.0, 'StartedOn': 1685032730610, 'CompletedOn': 1685032730663}, 'ResponseMetadata': {'RequestId': 'a8b1badf-bcea-4e58-a3eb-902ebf0198f0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:38:50 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2914', 'connection': 'keep-alive', 'x-amzn-requestid': 'a8b1badf-bcea-4e58-a3eb-902ebf0198f0'}, 'RetryAttempts': 0}}
[0m16:38:51.382660 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:38:51.382660 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from glue_catalog.poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'.\' expecting \')\'(line 16, pos 43)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom glue_catalog.poc_normalized_legislator.organizations\n-------------------------------------------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:38:51.382660 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from glue_catalog.poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), ParseException: '\nmismatched input \'.\' expecting \')\'(line 16, pos 43)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom glue_catalog.poc_normalized_legislator.organizations\n-------------------------------------------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:38:51.382660 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from glue_catalog.poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:38:51.382660 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:38:51.382660 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:38:51.382660 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:38:51.382660 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:38:51.382660 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:38:45.683650 => 2023-05-25 16:38:51.382660
[0m16:38:51.467174 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from glue_catalog.poc_normalized_legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), ParseException: '\nmismatched input \'.\' expecting \')\'(line 16, pos 43)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom glue_catalog.poc_normalized_legislator.organizations\n-------------------------------------------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:38:51.477193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd089fc-1658-4271-bd08-541efd129302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB64ED4D60>]}
[0m16:38:51.477193 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.80s]
[0m16:38:51.480748 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:38:51.480748 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:38:51.480748 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:51.480748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:51.480748 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:38:52.683833 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:38:52.683833 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:38:52.683833 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-5a14c01c-3784-4ab3-b82f-71e1ed30b617
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:38:54.148135 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:38:54.148135 [debug] [MainThread]: On master: Close
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:38:54.148135 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:38:54.599322 [info ] [MainThread]: 
[0m16:38:54.599322 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 44.77 seconds (44.77s).
[0m16:38:54.599322 [debug] [MainThread]: Command end result
[0m16:38:54.615577 [info ] [MainThread]: 
[0m16:38:54.615577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:38:54.615577 [info ] [MainThread]: 
[0m16:38:54.615577 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:38:54.615577 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:38:54.615577 [error] [MainThread]:   
[0m16:38:54.615577 [error] [MainThread]:     
[0m16:38:54.615577 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:38:54.615577 [error] [MainThread]:     using PARQUET
[0m16:38:54.615577 [error] [MainThread]:   	
[0m16:38:54.615577 [error] [MainThread]:   	
[0m16:38:54.615577 [error] [MainThread]:   	
[0m16:38:54.615577 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:38:54.615577 [error] [MainThread]:   	
[0m16:38:54.615577 [error] [MainThread]:   	as
[0m16:38:54.615577 [error] [MainThread]:   	with org as (
[0m16:38:54.615577 [error] [MainThread]:   select 
[0m16:38:54.628968 [error] [MainThread]:   organization_name,
[0m16:38:54.628968 [error] [MainThread]:   organization_type
[0m16:38:54.628968 [error] [MainThread]:   from glue_catalog.poc_normalized_legislator.organizations
[0m16:38:54.630245 [error] [MainThread]:   )
[0m16:38:54.630754 [error] [MainThread]:   select distinct 
[0m16:38:54.631402 [error] [MainThread]:   organization_name, 
[0m16:38:54.631402 [error] [MainThread]:   organization_type
[0m16:38:54.631402 [error] [MainThread]:   from org
[0m16:38:54.631402 [error] [MainThread]:     '''), ParseException: '\nmismatched input \'.\' expecting \')\'(line 16, pos 43)\n\n== SQL ==\n/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom glue_catalog.poc_normalized_legislator.organizations\n-------------------------------------------^^^\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \n'
[0m16:38:54.631402 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:38:54.631402 [info ] [MainThread]: 
[0m16:38:54.631402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:54.631402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB683C7EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB68DBC760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB69367100>]}
[0m16:38:54.631402 [debug] [MainThread]: Flushing usage events
[0m16:38:55.597471 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:42:44.250190 | a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2 ==============================
[0m16:42:44.250190 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:42:44.250190 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:42:44.250190 [debug] [MainThread]: Tracking: tracking
[0m16:42:44.286475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F36C640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F36CD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F36C910>]}
[0m16:42:44.286475 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:42:44.352154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:44.352154 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m16:42:44.352154 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:42:44.387057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F6A8160>]}
[0m16:42:44.387057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9BE05FA0>]}
[0m16:42:44.387057 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:42:44.387057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9BDED4F0>]}
[0m16:42:44.387057 [info ] [MainThread]: 
[0m16:42:44.387057 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:42:44.387057 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:42:44.387057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:44.387057 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:42:44.387057 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:42:44.387057 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:43:01.820028 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:43:01.836043 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e4accc2b-02da-41a9-a684-e586cefa4e79
[0m16:43:10.104620 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:43:11.234554 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:43:11.234554 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:43:11.234554 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:43:11.234554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:11.234554 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:43:12.233962 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:43:12.234951 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:43:12.234951 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e4accc2b-02da-41a9-a684-e586cefa4e79
[0m16:43:13.512954 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:43:14.574745 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:43:14.575743 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:43:14.577819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9BE05EE0>]}
[0m16:43:14.578805 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:43:14.578805 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:43:14.579801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:14.580808 [info ] [MainThread]: 
[0m16:43:14.595310 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:43:14.595310 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:43:14.598371 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:43:14.598371 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:43:14.604621 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:43:14.607531 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:43:14.599373 => 2023-05-25 16:43:14.606607
[0m16:43:14.607531 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:43:14.623700 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:43:14.623700 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:43:15.746712 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:43:15.746712 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:43:15.746712 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e4accc2b-02da-41a9-a684-e586cefa4e79
[0m16:43:17.118443 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:43:18.191956 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:43:18.247082 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:43:18.255055 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:43:18.256053 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:43:18.257060 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:43:18.257060 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:43:18.257060 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:43:18.257060 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:43:18.257060 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:43:18.257060 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:43:18.258057 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  ''')
[0m16:43:20.303266 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \norganization_name,\norganization_type\nfrom poc_normalized_legislator.organizations\n)\nselect distinct \norganization_name, \norganization_type\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Distinct\\n   +- \'Project [\'organization_name, \'organization_type]\\n      +- \'SubqueryAlias `org`\\n         +- \'Project [\'organization_name, \'organization_type]\\n            +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685032998208, 'CompletedOn': 1685032998788}, 'ResponseMetadata': {'RequestId': 'f6a29255-03e1-401b-8b76-553126e56ee6', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:43:19 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2264', 'connection': 'keep-alive', 'x-amzn-requestid': 'f6a29255-03e1-401b-8b76-553126e56ee6'}, 'RetryAttempts': 0}}
[0m16:43:20.303266 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:43:20.303266 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:43:20.317569 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:43:20.318063 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
organization_name,
organization_type
from poc_normalized_legislator.organizations
)
select distinct 
organization_name, 
organization_type
from org
  
[0m16:43:20.318063 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:43:20.319069 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:43:20.319069 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:43:20.320137 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:43:20.321135 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:43:14.608532 => 2023-05-25 16:43:20.320137
[0m16:43:20.329042 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  organization_name,
  organization_type
  from poc_normalized_legislator.organizations
  )
  select distinct 
  organization_name, 
  organization_type
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:43:20.330123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ab3666-7bd9-455a-b8c4-c3dfd7983dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9FD087C0>]}
[0m16:43:20.331100 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.73s]
[0m16:43:20.334696 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:43:20.336896 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:43:20.336896 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:20.336896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:20.337898 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:43:21.369090 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:43:21.369090 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:43:21.369090 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-e4accc2b-02da-41a9-a684-e586cefa4e79
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:43:22.735138 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:43:22.735138 [debug] [MainThread]: On master: Close
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:43:22.735138 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:43:23.184821 [info ] [MainThread]: 
[0m16:43:23.185851 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.80 seconds (38.80s).
[0m16:43:23.186349 [debug] [MainThread]: Command end result
[0m16:43:23.186349 [info ] [MainThread]: 
[0m16:43:23.186349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:23.186349 [info ] [MainThread]: 
[0m16:43:23.200981 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:43:23.201830 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:43:23.201830 [error] [MainThread]:   
[0m16:43:23.201830 [error] [MainThread]:     
[0m16:43:23.201830 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:43:23.201830 [error] [MainThread]:     using PARQUET
[0m16:43:23.201830 [error] [MainThread]:   	
[0m16:43:23.201830 [error] [MainThread]:   	
[0m16:43:23.201830 [error] [MainThread]:   	
[0m16:43:23.201830 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:43:23.201830 [error] [MainThread]:   	
[0m16:43:23.201830 [error] [MainThread]:   	as
[0m16:43:23.201830 [error] [MainThread]:   	with org as (
[0m16:43:23.201830 [error] [MainThread]:   select 
[0m16:43:23.201830 [error] [MainThread]:   organization_name,
[0m16:43:23.201830 [error] [MainThread]:   organization_type
[0m16:43:23.201830 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m16:43:23.201830 [error] [MainThread]:   )
[0m16:43:23.201830 [error] [MainThread]:   select distinct 
[0m16:43:23.201830 [error] [MainThread]:   organization_name, 
[0m16:43:23.201830 [error] [MainThread]:   organization_type
[0m16:43:23.201830 [error] [MainThread]:   from org
[0m16:43:23.201830 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 16 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Distinct\n   +- 'Project ['organization_name, 'organization_type]\n      +- 'SubqueryAlias `org`\n         +- 'Project ['organization_name, 'organization_type]\n            +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:43:23.201830 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:43:23.201830 [info ] [MainThread]: 
[0m16:43:23.217503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:23.218463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F2F7E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9F2E2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E9FCEC730>]}
[0m16:43:23.218463 [debug] [MainThread]: Flushing usage events
[0m16:43:24.157801 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:44:51.080671 | 2228babb-9abe-4d96-95cf-b9e6481c010f ==============================
[0m16:44:51.080671 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:44:51.080671 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:44:51.080671 [debug] [MainThread]: Tracking: tracking
[0m16:44:51.121283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730A602670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730A602D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730A6028B0>]}
[0m16:44:51.121283 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:44:51.180576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:51.180576 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m16:44:51.196981 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:44:51.221557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2228babb-9abe-4d96-95cf-b9e6481c010f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730A93BF10>]}
[0m16:44:51.221557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2228babb-9abe-4d96-95cf-b9e6481c010f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027307095D60>]}
[0m16:44:51.221557 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:44:51.221557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2228babb-9abe-4d96-95cf-b9e6481c010f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730707E460>]}
[0m16:44:51.221557 [info ] [MainThread]: 
[0m16:44:51.237543 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:44:51.237543 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:44:51.237543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.237543 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:44:51.237543 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:44:51.237543 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:45:09.104194 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:45:09.104194 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-24abb3e5-1cdf-422a-b0d7-60e208b5f918
[0m16:45:17.354238 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:45:18.392713 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:45:18.392713 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:45:18.392713 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:45:18.392713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.392713 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:45:19.457018 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:45:19.457018 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:45:19.457018 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-24abb3e5-1cdf-422a-b0d7-60e208b5f918
[0m16:45:20.844311 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:45:21.963181 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:45:21.963181 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:45:21.963181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2228babb-9abe-4d96-95cf-b9e6481c010f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027307095D90>]}
[0m16:45:21.963181 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:45:21.963181 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:45:21.963181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:21.963181 [info ] [MainThread]: 
[0m16:45:21.978878 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:45:21.983956 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:45:21.983956 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:45:21.983956 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:45:21.983956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:45:21.983956 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:45:21.983956 => 2023-05-25 16:45:21.983956
[0m16:45:21.983956 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:45:21.983956 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:45:21.983956 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:45:23.002160 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:45:23.002160 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:45:23.002160 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-24abb3e5-1cdf-422a-b0d7-60e208b5f918
[0m16:45:24.303961 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:45:25.353014 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:45:25.389845 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:45:25.389845 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:45:25.389845 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:45:25.389845 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685033125307, 'CompletedOn': 1685033125915}, 'ResponseMetadata': {'RequestId': 'f2ae5fb1-ec3c-4b9c-8202-9e13a2dcd211', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:45:26 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2100', 'connection': 'keep-alive', 'x-amzn-requestid': 'f2ae5fb1-ec3c-4b9c-8202-9e13a2dcd211'}, 'RetryAttempts': 0}}
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:45:27.358693 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m16:45:27.358693 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:45:27.358693 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:45:27.358693 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:45:27.358693 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:45:21.983956 => 2023-05-25 16:45:27.358693
[0m16:45:27.358693 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:45:27.358693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2228babb-9abe-4d96-95cf-b9e6481c010f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027307095D90>]}
[0m16:45:27.358693 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.37s]
[0m16:45:27.358693 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:45:27.374786 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:45:27.374786 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:27.374786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:27.374786 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:45:28.496365 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:45:28.496365 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:45:28.496365 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-24abb3e5-1cdf-422a-b0d7-60e208b5f918
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:45:29.897813 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:45:29.897813 [debug] [MainThread]: On master: Close
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:45:29.897813 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:45:30.346838 [info ] [MainThread]: 
[0m16:45:30.346838 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.11 seconds (39.11s).
[0m16:45:30.346838 [debug] [MainThread]: Command end result
[0m16:45:30.346838 [info ] [MainThread]: 
[0m16:45:30.346838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:30.346838 [info ] [MainThread]: 
[0m16:45:30.346838 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:45:30.362666 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:45:30.362666 [error] [MainThread]:   
[0m16:45:30.362666 [error] [MainThread]:     
[0m16:45:30.362666 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:45:30.362666 [error] [MainThread]:     using PARQUET
[0m16:45:30.362666 [error] [MainThread]:   	
[0m16:45:30.362666 [error] [MainThread]:   	
[0m16:45:30.362666 [error] [MainThread]:   	
[0m16:45:30.362666 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:45:30.362666 [error] [MainThread]:   	
[0m16:45:30.362666 [error] [MainThread]:   	as
[0m16:45:30.362666 [error] [MainThread]:   	with org as (
[0m16:45:30.362666 [error] [MainThread]:   select 
[0m16:45:30.362666 [error] [MainThread]:   name, classification
[0m16:45:30.362666 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m16:45:30.362666 [error] [MainThread]:   )
[0m16:45:30.362666 [error] [MainThread]:   select name, classification
[0m16:45:30.362666 [error] [MainThread]:   from org
[0m16:45:30.362666 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m16:45:30.362666 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:45:30.362666 [info ] [MainThread]: 
[0m16:45:30.362666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:45:30.362666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730A587F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027308D7CB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730B527250>]}
[0m16:45:30.362666 [debug] [MainThread]: Flushing usage events
[0m16:45:31.294083 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-25 16:48:54.048360 | 46afdda6-6066-4a36-97d8-da6eb98249a5 ==============================
[0m16:48:54.048360 [info ] [MainThread]: Running with dbt=1.4.6
[0m16:48:54.048360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:48:54.048360 [debug] [MainThread]: Tracking: tracking
[0m16:48:54.086616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A6B15B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A6B1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A6B1910>]}
[0m16:48:54.102334 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m16:48:54.102334 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:48:54.102334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A661070>]}
[0m16:48:54.702747 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m16:48:54.752469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265371F75B0>]}
[0m16:48:54.752469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A6B19A0>]}
[0m16:48:54.752469 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:48:54.752469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653A656F40>]}
[0m16:48:54.752469 [info ] [MainThread]: 
[0m16:48:54.752469 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:48:54.768100 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m16:48:54.768100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:54.768100 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:48:54.768100 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:48:54.768100 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:49:12.224605 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:49:12.224605 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-2c46db7e-5593-47a8-b690-b2fec9b9948f
[0m16:49:21.806358 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:49:22.876554 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m16:49:22.876554 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:49:22.876554 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m16:49:22.876554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:22.876554 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:49:23.878814 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m16:49:23.878814 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m16:49:23.878814 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-2c46db7e-5593-47a8-b690-b2fec9b9948f
[0m16:49:26.568212 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m16:49:27.633006 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m16:49:27.637587 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:49:27.637587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265371F7F40>]}
[0m16:49:27.637587 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:49:27.637587 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:49:27.637587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:27.637587 [info ] [MainThread]: 
[0m16:49:27.637587 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m16:49:27.637587 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m16:49:27.637587 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m16:49:27.637587 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m16:49:27.653361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m16:49:27.653361 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-25 16:49:27.637587 => 2023-05-25 16:49:27.653361
[0m16:49:27.653361 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m16:49:27.653361 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:49:27.653361 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m16:49:28.640071 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m16:49:28.640071 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m16:49:28.640071 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-2c46db7e-5593-47a8-b690-b2fec9b9948f
[0m16:49:31.245755 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:49:32.311176 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:49:32.348813 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:49:32.348813 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m16:49:32.348813 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m16:49:32.348813 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', "pyspark.sql.utils.AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'\n"]}, 'Progress': 1.0, 'StartedOn': 1685033372340, 'CompletedOn': 1685033374143}, 'ResponseMetadata': {'RequestId': 'dce3305f-83b4-4d14-8e79-35efbac22444', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Thu, 25 May 2023 16:49:35 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2522', 'connection': 'keep-alive', 'x-amzn-requestid': 'dce3305f-83b4-4d14-8e79-35efbac22444'}, 'RetryAttempts': 0}}
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: status = error
[0m16:49:35.701237 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m16:49:35.701237 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m16:49:35.701237 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m16:49:35.701237 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m16:49:35.701237 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-25 16:49:27.653361 => 2023-05-25 16:49:35.701237
[0m16:49:35.701237 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:49:35.701237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46afdda6-6066-4a36-97d8-da6eb98249a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026537119E80>]}
[0m16:49:35.701237 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 8.06s]
[0m16:49:35.701237 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m16:49:35.701237 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:49:35.716992 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:35.716992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:35.716992 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m16:49:36.790334 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m16:49:36.790334 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m16:49:36.790334 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-2c46db7e-5593-47a8-b690-b2fec9b9948f
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:49:39.461043 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m16:49:39.461043 [debug] [MainThread]: On master: Close
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m16:49:39.461043 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:49:39.900695 [info ] [MainThread]: 
[0m16:49:39.900695 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 45.15 seconds (45.15s).
[0m16:49:39.900695 [debug] [MainThread]: Command end result
[0m16:49:39.917231 [info ] [MainThread]: 
[0m16:49:39.917231 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:39.917231 [info ] [MainThread]: 
[0m16:49:39.917231 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m16:49:39.917231 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m16:49:39.917231 [error] [MainThread]:   
[0m16:49:39.917231 [error] [MainThread]:     
[0m16:49:39.917231 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m16:49:39.917231 [error] [MainThread]:     using PARQUET
[0m16:49:39.917231 [error] [MainThread]:   	
[0m16:49:39.917231 [error] [MainThread]:   	
[0m16:49:39.917231 [error] [MainThread]:   	
[0m16:49:39.917231 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m16:49:39.917231 [error] [MainThread]:   	
[0m16:49:39.917231 [error] [MainThread]:   	as
[0m16:49:39.917231 [error] [MainThread]:   	with org as (
[0m16:49:39.917231 [error] [MainThread]:   select 
[0m16:49:39.917231 [error] [MainThread]:   name, classification
[0m16:49:39.917231 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m16:49:39.917231 [error] [MainThread]:   )
[0m16:49:39.917231 [error] [MainThread]:   select name, classification
[0m16:49:39.917231 [error] [MainThread]:   from org
[0m16:49:39.917231 [error] [MainThread]:     '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: 4ff87463-1bae-49e1-9156-3cd0a143022a; Proxy: null));'
[0m16:49:39.917231 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m16:49:39.917231 [info ] [MainThread]: 
[0m16:49:39.917231 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:49:39.917231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653B035250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653B5DC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653B69FFA0>]}
[0m16:49:39.917231 [debug] [MainThread]: Flushing usage events
[0m16:49:40.818025 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 01:50:14.286982 | 7f24f343-61af-4012-b470-4236c27c75ac ==============================
[0m01:50:14.286982 [info ] [MainThread]: Running with dbt=1.4.6
[0m01:50:14.286982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m01:50:14.286982 [debug] [MainThread]: Tracking: tracking
[0m01:50:14.322427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1185902B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B118607430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B118607D60>]}
[0m01:50:14.644582 [debug] [MainThread]: Executing "git --help"
[0m01:50:14.721048 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:50:14.721048 [debug] [MainThread]: STDERR: "b''"
[0m01:50:14.731806 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m01:50:14.733549 [debug] [MainThread]: Using glue connection "debug"
[0m01:50:14.734043 [debug] [MainThread]: On debug: select 1 as id
[0m01:50:14.734399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:14.734399 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m01:50:14.734935 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m01:50:14.735429 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m01:50:39.436320 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m01:50:39.443444 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4393632c-38bc-4ed3-9a18-4d388017e3fa
[0m01:50:46.492960 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m01:50:46.492960 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m01:50:46.492960 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m01:50:46.492960 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m01:50:46.492960 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m01:50:50.328211 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685065846315, 'CompletedOn': 1685065849635}, 'ResponseMetadata': {'RequestId': 'be67bd80-36be-4788-b0ff-dd035a070f50', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 01:50:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'be67bd80-36be-4788-b0ff-dd035a070f50'}, 'RetryAttempts': 0}}
[0m01:50:50.328211 [debug] [MainThread]: Glue adapter: status = ok
[0m01:50:50.328211 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m01:50:50.328211 [debug] [MainThread]: SQL status: OK in 36 seconds
[0m01:50:50.328211 [debug] [MainThread]: On debug: Close
[0m01:50:50.328211 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m01:50:50.336243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B118AA96A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B11908F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B11908F190>]}
[0m01:50:50.336243 [debug] [MainThread]: Flushing usage events
[0m01:50:51.328195 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 01:54:29.332266 | 53c69d26-b0b5-4a5c-b260-1b1b1715454b ==============================
[0m01:54:29.332266 [info ] [MainThread]: Running with dbt=1.4.6
[0m01:54:29.332266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:54:29.332266 [debug] [MainThread]: Tracking: tracking
[0m01:54:29.375388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF20580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF20C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF20820>]}
[0m01:54:29.400128 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m01:54:30.551836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:30.551836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:30.551836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53c69d26-b0b5-4a5c-b260-1b1b1715454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1BA10D00>]}
[0m01:54:30.567652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53c69d26-b0b5-4a5c-b260-1b1b1715454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF888E0>]}
[0m01:54:30.567652 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:54:30.575664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c69d26-b0b5-4a5c-b260-1b1b1715454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF88D60>]}
[0m01:54:30.575664 [info ] [MainThread]: 
[0m01:54:30.575664 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m01:54:30.575664 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m01:54:30.575664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:30.575664 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m01:54:30.575664 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m01:54:30.575664 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m01:54:53.540788 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m01:54:53.540788 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-267dbfe8-4923-4fcf-a9dd-95c6f6ea3b71
[0m01:55:01.907588 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m01:55:03.141386 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m01:55:03.141386 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m01:55:03.144430 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m01:55:03.144995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:03.145490 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m01:55:04.283455 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m01:55:04.283455 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m01:55:04.283455 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-267dbfe8-4923-4fcf-a9dd-95c6f6ea3b71
[0m01:55:06.982569 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m01:55:08.133146 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m01:55:08.133146 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m01:55:08.133146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c69d26-b0b5-4a5c-b260-1b1b1715454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF88B80>]}
[0m01:55:08.133146 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m01:55:08.133146 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m01:55:08.133146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:55:08.133146 [info ] [MainThread]: 
[0m01:55:08.150059 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m01:55:08.150059 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m01:55:08.150059 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m01:55:08.150059 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m01:55:08.150059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m01:55:08.150059 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 01:55:08.150059 => 2023-05-26 01:55:08.150059
[0m01:55:08.150059 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m01:55:08.166693 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:55:08.166693 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m01:55:09.233327 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m01:55:09.233327 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m01:55:09.233327 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-267dbfe8-4923-4fcf-a9dd-95c6f6ea3b71
[0m01:55:13.252137 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m01:55:14.350390 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m01:55:14.415020 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m01:55:14.418023 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m01:55:14.418023 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m01:55:14.418023 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m01:55:14.418023 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', "pyspark.sql.utils.AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'\n"]}, 'Progress': 1.0, 'StartedOn': 1685066114244, 'CompletedOn': 1685066116243}, 'ResponseMetadata': {'RequestId': '3e226ada-03bb-4625-bab7-0da889f3c230', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 01:55:17 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2522', 'connection': 'keep-alive', 'x-amzn-requestid': '3e226ada-03bb-4625-bab7-0da889f3c230'}, 'RetryAttempts': 0}}
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: status = error
[0m01:55:17.866547 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m01:55:17.866547 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m01:55:17.866547 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m01:55:17.866547 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m01:55:17.866547 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 01:55:08.150059 => 2023-05-26 01:55:17.866547
[0m01:55:17.949485 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m01:55:17.949485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53c69d26-b0b5-4a5c-b260-1b1b1715454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1EF547F0>]}
[0m01:55:17.949485 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 9.80s]
[0m01:55:17.949485 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m01:55:17.949485 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m01:55:17.949485 [debug] [MainThread]: On master: ROLLBACK
[0m01:55:17.949485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:55:17.949485 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m01:55:19.047999 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m01:55:19.047999 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m01:55:19.047999 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-267dbfe8-4923-4fcf-a9dd-95c6f6ea3b71
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m01:55:21.731624 [debug] [MainThread]: On master: ROLLBACK
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m01:55:21.731624 [debug] [MainThread]: On master: Close
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m01:55:21.731624 [debug] [MainThread]: Glue adapter: cleanup called
[0m01:55:22.148459 [info ] [MainThread]: 
[0m01:55:22.148459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 51.57 seconds (51.57s).
[0m01:55:22.148459 [debug] [MainThread]: Command end result
[0m01:55:22.162039 [info ] [MainThread]: 
[0m01:55:22.162039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:55:22.162039 [info ] [MainThread]: 
[0m01:55:22.162039 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m01:55:22.162039 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m01:55:22.162039 [error] [MainThread]:   
[0m01:55:22.162039 [error] [MainThread]:     
[0m01:55:22.162039 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m01:55:22.162039 [error] [MainThread]:     using PARQUET
[0m01:55:22.162039 [error] [MainThread]:   	
[0m01:55:22.162039 [error] [MainThread]:   	
[0m01:55:22.162039 [error] [MainThread]:   	
[0m01:55:22.162039 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m01:55:22.162039 [error] [MainThread]:   	
[0m01:55:22.162039 [error] [MainThread]:   	as
[0m01:55:22.162039 [error] [MainThread]:   	with org as (
[0m01:55:22.162039 [error] [MainThread]:   select 
[0m01:55:22.170435 [error] [MainThread]:   name, classification
[0m01:55:22.170800 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m01:55:22.170800 [error] [MainThread]:   )
[0m01:55:22.170800 [error] [MainThread]:   select name, classification
[0m01:55:22.170800 [error] [MainThread]:   from org
[0m01:55:22.170800 [error] [MainThread]:     '''), AnalysisException: 'java.lang.RuntimeException: MetaException(message:Unable to verify existence of default database: com.amazonaws.services.glue.model.AccessDeniedException: User: arn:aws:sts::334822733362:assumed-role/GlueInteractiveSessionRole/GlueJobRunnerSession is not authorized to perform: glue:GetDatabase on resource: arn:aws:glue:us-west-1:334822733362:catalog because no identity-based policy allows the glue:GetDatabase action (Service: AWSGlue; Status Code: 400; Error Code: AccessDeniedException; Request ID: cae63039-a615-4b6a-9745-e1953dcd92c2; Proxy: null));'
[0m01:55:22.170800 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m01:55:22.170800 [info ] [MainThread]: 
[0m01:55:22.170800 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:55:22.170800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1FEE5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1FEE5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1FEE5BE0>]}
[0m01:55:22.170800 [debug] [MainThread]: Flushing usage events
[0m01:55:23.123454 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 02:00:58.524249 | 0535277b-eead-42a9-9c96-9f8be3a88cf7 ==============================
[0m02:00:58.524249 [info ] [MainThread]: Running with dbt=1.4.6
[0m02:00:58.524249 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:00:58.524249 [debug] [MainThread]: Tracking: tracking
[0m02:00:58.573757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC113925B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC11392C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC11392820>]}
[0m02:00:58.594751 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m02:00:58.609937 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:00:58.609937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1133EE50>]}
[0m02:00:59.674988 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m02:00:59.733349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0DED69D0>]}
[0m02:00:59.750577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC113925B0>]}
[0m02:00:59.750577 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:00:59.750577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC11336160>]}
[0m02:00:59.750577 [info ] [MainThread]: 
[0m02:00:59.750577 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m02:00:59.750577 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m02:00:59.750577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:59.750577 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m02:00:59.750577 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m02:00:59.750577 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m02:01:39.734543 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m02:01:39.734543 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-0d519f7c-3af6-4bf0-ac09-4f2804977d07
[0m02:01:47.188740 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m02:01:48.332647 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m02:01:48.332647 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m02:01:48.332647 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m02:01:48.332647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:48.332647 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m02:01:49.606009 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m02:01:49.606009 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m02:01:49.606009 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-0d519f7c-3af6-4bf0-ac09-4f2804977d07
[0m02:01:50.974931 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m02:01:52.069694 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m02:01:52.069694 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m02:01:52.077967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0DED6C10>]}
[0m02:01:52.080045 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m02:01:52.080045 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m02:01:52.080045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:52.080045 [info ] [MainThread]: 
[0m02:01:52.096207 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m02:01:52.096207 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m02:01:52.098806 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m02:01:52.098806 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m02:01:52.100333 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m02:01:52.100333 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 02:01:52.100333 => 2023-05-26 02:01:52.100333
[0m02:01:52.108404 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m02:01:52.129449 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:01:52.129449 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m02:01:53.289216 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m02:01:53.289216 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m02:01:53.289216 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-0d519f7c-3af6-4bf0-ac09-4f2804977d07
[0m02:01:54.833988 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:01:55.937824 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m02:01:56.030687 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:01:56.039546 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m02:01:56.047683 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m02:01:56.047683 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m02:01:56.049216 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m02:01:56.049216 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:01:56.049216 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m02:01:56.049216 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m02:01:56.049216 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m02:01:56.049216 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685066515877, 'CompletedOn': 1685066516469}, 'ResponseMetadata': {'RequestId': 'efea6bf2-5544-4fe3-89c8-1c32c8acb68b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 02:01:57 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2100', 'connection': 'keep-alive', 'x-amzn-requestid': 'efea6bf2-5544-4fe3-89c8-1c32c8acb68b'}, 'RetryAttempts': 0}}
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: status = error
[0m02:01:58.047272 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m02:01:58.047272 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m02:01:58.047272 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m02:01:58.047272 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m02:01:58.063334 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 02:01:52.108404 => 2023-05-26 02:01:58.047272
[0m02:01:58.070272 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m02:01:58.070272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0535277b-eead-42a9-9c96-9f8be3a88cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0DE22B20>]}
[0m02:01:58.070272 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.97s]
[0m02:01:58.070272 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m02:01:58.078747 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m02:01:58.078747 [debug] [MainThread]: On master: ROLLBACK
[0m02:01:58.078747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:58.078747 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m02:01:59.117263 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m02:01:59.117263 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m02:01:59.117263 [debug] [MainThread]: Glue adapter: GlueConnection session_id : poc-glue-dbt-glue-0d519f7c-3af6-4bf0-ac09-4f2804977d07
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m02:02:00.563786 [debug] [MainThread]: On master: ROLLBACK
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m02:02:00.563786 [debug] [MainThread]: On master: Close
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m02:02:00.563786 [debug] [MainThread]: Glue adapter: cleanup called
[0m02:02:00.977261 [info ] [MainThread]: 
[0m02:02:00.985630 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 1.23 seconds (61.23s).
[0m02:02:00.985630 [debug] [MainThread]: Command end result
[0m02:02:01.009986 [info ] [MainThread]: 
[0m02:02:01.014577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:02:01.019088 [info ] [MainThread]: 
[0m02:02:01.019088 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m02:02:01.019088 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m02:02:01.023765 [error] [MainThread]:   
[0m02:02:01.025291 [error] [MainThread]:     
[0m02:02:01.025291 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m02:02:01.025291 [error] [MainThread]:     using PARQUET
[0m02:02:01.029855 [error] [MainThread]:   	
[0m02:02:01.032943 [error] [MainThread]:   	
[0m02:02:01.032943 [error] [MainThread]:   	
[0m02:02:01.032943 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m02:02:01.038661 [error] [MainThread]:   	
[0m02:02:01.038791 [error] [MainThread]:   	as
[0m02:02:01.038791 [error] [MainThread]:   	with org as (
[0m02:02:01.038791 [error] [MainThread]:   select 
[0m02:02:01.038791 [error] [MainThread]:   name, classification
[0m02:02:01.038791 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m02:02:01.046657 [error] [MainThread]:   )
[0m02:02:01.047627 [error] [MainThread]:   select name, classification
[0m02:02:01.055655 [error] [MainThread]:   from org
[0m02:02:01.055655 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:02:01.055655 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m02:02:01.055655 [info ] [MainThread]: 
[0m02:02:01.055655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:02:01.055655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC113DD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC12279310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC12279C10>]}
[0m02:02:01.063647 [debug] [MainThread]: Flushing usage events
[0m02:02:02.148854 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 02:48:41.730865 | c8107f8d-28b2-48c9-ab1c-682a356cf1e0 ==============================
[0m02:48:41.730865 [info ] [MainThread]: Running with dbt=1.4.6
[0m02:48:41.730865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:48:41.730865 [debug] [MainThread]: Tracking: tracking
[0m02:48:41.785334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E6D2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E6D2BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E6D2760>]}
[0m02:48:41.798843 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m02:48:41.824501 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:48:41.824501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E682D90>]}
[0m02:48:43.179391 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m02:48:43.232557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605B206FD0>]}
[0m02:48:43.248244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E6D2490>]}
[0m02:48:43.248244 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:48:43.248244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605E676FA0>]}
[0m02:48:43.248244 [info ] [MainThread]: 
[0m02:48:43.248244 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m02:48:43.248244 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m02:48:43.248244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:43.248244 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m02:48:43.248244 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m02:48:43.248244 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m02:49:05.793517 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m02:49:05.809293 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bde938df-d142-499d-ad02-b299bc2e0922
[0m02:49:14.124188 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m02:49:15.223495 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m02:49:15.223495 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m02:49:15.223495 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m02:49:15.223495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:15.223495 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m02:49:16.294535 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m02:49:16.294535 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m02:49:16.294535 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bde938df-d142-499d-ad02-b299bc2e0922
[0m02:49:17.655741 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m02:49:18.703552 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m02:49:18.703552 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m02:49:18.703552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605B206790>]}
[0m02:49:18.703552 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m02:49:18.703552 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m02:49:18.703552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:18.703552 [info ] [MainThread]: 
[0m02:49:18.719599 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m02:49:18.719599 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m02:49:18.719599 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m02:49:18.719599 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m02:49:18.719599 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m02:49:18.719599 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 02:49:18.719599 => 2023-05-26 02:49:18.719599
[0m02:49:18.719599 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m02:49:18.719599 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:49:18.719599 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m02:49:19.777026 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m02:49:19.777026 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m02:49:19.777026 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bde938df-d142-499d-ad02-b299bc2e0922
[0m02:49:21.152953 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:49:22.262910 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:49:22.310896 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m02:49:22.310896 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m02:49:22.310896 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m02:49:22.310896 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m02:49:24.314842 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685069362140, 'CompletedOn': 1685069362623}, 'ResponseMetadata': {'RequestId': '9db34f06-b945-4327-87bd-58702f9a5bd7', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 02:49:23 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2100', 'connection': 'keep-alive', 'x-amzn-requestid': '9db34f06-b945-4327-87bd-58702f9a5bd7'}, 'RetryAttempts': 0}}
[0m02:49:24.314842 [debug] [Thread-1  ]: Glue adapter: status = error
[0m02:49:24.314842 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:49:24.330508 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:49:24.330508 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m02:49:24.330508 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m02:49:24.330508 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m02:49:24.330508 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m02:49:24.330508 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m02:49:24.330508 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 02:49:18.719599 => 2023-05-26 02:49:24.330508
[0m02:49:24.399772 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m02:49:24.399772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8107f8d-28b2-48c9-ab1c-682a356cf1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605EFF8F70>]}
[0m02:49:24.399772 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.68s]
[0m02:49:24.399772 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m02:49:24.399772 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m02:49:24.399772 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:24.399772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:24.399772 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m02:49:25.464931 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m02:49:25.464931 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m02:49:25.464931 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bde938df-d142-499d-ad02-b299bc2e0922
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m02:49:26.806022 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m02:49:26.806022 [debug] [MainThread]: On master: Close
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m02:49:26.806022 [debug] [MainThread]: Glue adapter: cleanup called
[0m02:49:27.237821 [info ] [MainThread]: 
[0m02:49:27.237821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.99 seconds (43.99s).
[0m02:49:27.237821 [debug] [MainThread]: Command end result
[0m02:49:27.237821 [info ] [MainThread]: 
[0m02:49:27.237821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:27.253638 [info ] [MainThread]: 
[0m02:49:27.253638 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m02:49:27.253638 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m02:49:27.253638 [error] [MainThread]:   
[0m02:49:27.253638 [error] [MainThread]:     
[0m02:49:27.253638 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m02:49:27.253638 [error] [MainThread]:     using PARQUET
[0m02:49:27.253638 [error] [MainThread]:   	
[0m02:49:27.253638 [error] [MainThread]:   	
[0m02:49:27.253638 [error] [MainThread]:   	
[0m02:49:27.253638 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m02:49:27.253638 [error] [MainThread]:   	
[0m02:49:27.253638 [error] [MainThread]:   	as
[0m02:49:27.274520 [error] [MainThread]:   	with org as (
[0m02:49:27.274520 [error] [MainThread]:   select 
[0m02:49:27.274520 [error] [MainThread]:   name, classification
[0m02:49:27.274520 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m02:49:27.274520 [error] [MainThread]:   )
[0m02:49:27.274520 [error] [MainThread]:   select name, classification
[0m02:49:27.274520 [error] [MainThread]:   from org
[0m02:49:27.274520 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m02:49:27.274520 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m02:49:27.274520 [info ] [MainThread]: 
[0m02:49:27.274520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:27.274520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605B194070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605F5C2F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605F5C21C0>]}
[0m02:49:27.274520 [debug] [MainThread]: Flushing usage events
[0m02:49:28.309637 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:39:31.505194 | 6f078de7-db68-4c7c-93ee-0231cdd655a5 ==============================
[0m06:39:31.505194 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:39:31.507331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:39:31.507331 [debug] [MainThread]: Tracking: tracking
[0m06:39:31.549193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AEBB1AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AEC26340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AEC26CD0>]}
[0m06:39:31.782602 [debug] [MainThread]: Executing "git --help"
[0m06:39:31.820909 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:39:31.820968 [debug] [MainThread]: STDERR: "b''"
[0m06:39:31.833561 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m06:39:31.834569 [debug] [MainThread]: Using glue connection "debug"
[0m06:39:31.834569 [debug] [MainThread]: On debug: select 1 as id
[0m06:39:31.834569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:31.834569 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:39:31.834569 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m06:39:31.834569 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m06:39:54.422475 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:39:54.423476 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-14f3db8d-d87b-41fa-a96e-723b71f07ce5
[0m06:40:02.694863 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m06:40:02.695859 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m06:40:02.695859 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m06:40:02.696863 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:40:02.696863 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m06:40:07.472538 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685083202557, 'CompletedOn': 1685083206184}, 'ResponseMetadata': {'RequestId': '933419f2-3e49-4df4-9aa2-1ad0318e47d1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 06:40:06 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '933419f2-3e49-4df4-9aa2-1ad0318e47d1'}, 'RetryAttempts': 0}}
[0m06:40:07.473546 [debug] [MainThread]: Glue adapter: status = ok
[0m06:40:07.474534 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m06:40:07.474534 [debug] [MainThread]: SQL status: OK in 36 seconds
[0m06:40:07.476529 [debug] [MainThread]: On debug: Close
[0m06:40:07.476529 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:40:07.481948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B005D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B067F700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B067F460>]}
[0m06:40:07.481948 [debug] [MainThread]: Flushing usage events
[0m06:40:08.453202 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:40:19.041349 | d10fb4b4-9ffc-4ace-babc-eff5777bfe23 ==============================
[0m06:40:19.041349 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:40:19.042359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:40:19.042359 [debug] [MainThread]: Tracking: tracking
[0m06:40:19.069863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D222490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D222BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D222760>]}
[0m06:40:19.091485 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:40:20.180432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:20.181492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:20.185608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd10fb4b4-9ffc-4ace-babc-eff5777bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018359CD0CA0>]}
[0m06:40:20.191503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd10fb4b4-9ffc-4ace-babc-eff5777bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D284A60>]}
[0m06:40:20.191503 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:40:20.192509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd10fb4b4-9ffc-4ace-babc-eff5777bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D284D00>]}
[0m06:40:20.193511 [info ] [MainThread]: 
[0m06:40:20.194149 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:40:20.197793 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:40:20.197793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:20.197793 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:40:20.197793 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:40:20.197793 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:40:37.711931 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:40:37.713208 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a6200c8b-a2c8-4235-836a-c8c6b54b5bdc
[0m06:40:44.697371 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:40:45.816344 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:40:45.817359 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:40:45.820305 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:40:45.821291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:45.821291 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:40:46.879819 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:40:46.880813 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:40:46.881089 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a6200c8b-a2c8-4235-836a-c8c6b54b5bdc
[0m06:40:48.253867 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:40:49.330670 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:40:49.330670 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:40:49.332065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd10fb4b4-9ffc-4ace-babc-eff5777bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D284880>]}
[0m06:40:49.332065 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:40:49.332065 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:40:49.332065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:49.333131 [info ] [MainThread]: 
[0m06:40:49.344378 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:40:49.344378 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:40:49.345732 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:40:49.346732 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:40:49.349721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:40:49.351012 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 06:40:49.346732 => 2023-05-26 06:40:49.350910
[0m06:40:49.351012 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:40:49.357990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:40:49.358988 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:40:50.378057 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:40:50.379053 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:40:50.379053 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a6200c8b-a2c8-4235-836a-c8c6b54b5bdc
[0m06:40:51.711430 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:40:52.879673 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:40:52.912956 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:40:52.917014 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:40:52.917014 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:40:52.917938 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:40:52.917938 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:40:52.917938 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:40:52.917938 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:40:52.917938 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:40:52.917938 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:40:52.919006 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:40:54.915325 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685083252756, 'CompletedOn': 1685083253330}, 'ResponseMetadata': {'RequestId': '17c4573c-483e-4422-8f19-cf6596e96050', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 06:40:54 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2100', 'connection': 'keep-alive', 'x-amzn-requestid': '17c4573c-483e-4422-8f19-cf6596e96050'}, 'RetryAttempts': 0}}
[0m06:40:54.915325 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:40:54.916321 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:40:54.917392 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:40:54.917392 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:40:54.917392 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:40:54.917392 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:40:54.917392 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:40:54.917392 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:40:54.917392 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 06:40:49.351012 => 2023-05-26 06:40:54.917392
[0m06:40:54.977871 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:40:54.977871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10fb4b4-9ffc-4ace-babc-eff5777bfe23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835DB2F880>]}
[0m06:40:54.978878 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.63s]
[0m06:40:54.979876 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:40:54.981084 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:40:54.981084 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:54.982082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:54.982082 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:40:55.982160 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:40:55.983159 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:40:55.983159 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a6200c8b-a2c8-4235-836a-c8c6b54b5bdc
[0m06:40:57.307777 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:40:57.308772 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:40:57.309766 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:40:57.309766 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:57.309766 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:40:57.310764 [debug] [MainThread]: On master: Close
[0m06:40:57.310764 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:40:57.310764 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:40:57.726600 [info ] [MainThread]: 
[0m06:40:57.727596 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.53 seconds (37.53s).
[0m06:40:57.731582 [debug] [MainThread]: Command end result
[0m06:40:57.737400 [info ] [MainThread]: 
[0m06:40:57.738399 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:40:57.738399 [info ] [MainThread]: 
[0m06:40:57.743383 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:40:57.743997 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:40:57.748479 [error] [MainThread]:   
[0m06:40:57.748479 [error] [MainThread]:     
[0m06:40:57.749124 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:40:57.749124 [error] [MainThread]:     using PARQUET
[0m06:40:57.750123 [error] [MainThread]:   	
[0m06:40:57.750123 [error] [MainThread]:   	
[0m06:40:57.750123 [error] [MainThread]:   	
[0m06:40:57.751238 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m06:40:57.751238 [error] [MainThread]:   	
[0m06:40:57.751841 [error] [MainThread]:   	as
[0m06:40:57.751841 [error] [MainThread]:   	with org as (
[0m06:40:57.752424 [error] [MainThread]:   select 
[0m06:40:57.752424 [error] [MainThread]:   name, classification
[0m06:40:57.753008 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:40:57.753008 [error] [MainThread]:   )
[0m06:40:57.753580 [error] [MainThread]:   select name, classification
[0m06:40:57.753580 [error] [MainThread]:   from org
[0m06:40:57.753580 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:40:57.754579 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:40:57.759562 [info ] [MainThread]: 
[0m06:40:57.760561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:40:57.760561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835D284A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835E1938B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835E193490>]}
[0m06:40:57.761556 [debug] [MainThread]: Flushing usage events
[0m06:40:58.601577 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:45:46.766796 | 3c783e9b-7820-4fe3-b28c-063041323ad8 ==============================
[0m06:45:46.766796 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:45:46.768292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:45:46.769299 [debug] [MainThread]: Tracking: tracking
[0m06:45:46.794100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7AA1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7AA1D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7AA18E0>]}
[0m06:45:46.818207 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:45:48.064256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:45:48.064256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:45:48.068621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c783e9b-7820-4fe3-b28c-063041323ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C4551DF0>]}
[0m06:45:48.073799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c783e9b-7820-4fe3-b28c-063041323ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7B139D0>]}
[0m06:45:48.074976 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:45:48.074976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c783e9b-7820-4fe3-b28c-063041323ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7B13E50>]}
[0m06:45:48.076063 [info ] [MainThread]: 
[0m06:45:48.076993 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:45:48.079027 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:45:48.079027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:48.079027 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:45:48.079027 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:45:48.079027 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:46:15.808059 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:46:15.808059 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1b2d5103-e0ba-482d-84ea-da9530f5f3fe
[0m06:46:22.968004 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:46:24.092421 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:46:24.092421 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:46:24.095411 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:46:24.096668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:46:24.096668 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:46:25.110222 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:46:25.111218 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:46:25.111218 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1b2d5103-e0ba-482d-84ea-da9530f5f3fe
[0m06:46:26.561125 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:46:28.195307 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:46:28.196296 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:46:28.198297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c783e9b-7820-4fe3-b28c-063041323ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C45560D0>]}
[0m06:46:28.199283 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:46:28.199283 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:46:28.200287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:46:28.201898 [info ] [MainThread]: 
[0m06:46:28.212134 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:46:28.213129 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:46:28.215213 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:46:28.215213 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:46:28.222189 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:46:28.224326 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 06:46:28.216210 => 2023-05-26 06:46:28.224326
[0m06:46:28.225407 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:46:28.244616 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:46:28.245595 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:46:29.291598 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:46:29.291598 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:46:29.292597 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1b2d5103-e0ba-482d-84ea-da9530f5f3fe
[0m06:46:30.631215 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:46:31.736898 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:46:31.818721 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:46:31.828963 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:46:31.831244 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:46:31.831244 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:46:31.832238 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:46:31.832238 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:46:31.832238 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:46:31.833308 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:46:31.833308 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:46:31.834306 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:46:33.842673 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': '"Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 767, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 69, in deco\n    raise AnalysisException(s.split(\': \', 1)[1], stackTrace)\n', 'pyspark.sql.utils.AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\\n\'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\\n+- \'Project [\'name, \'classification]\\n   +- \'SubqueryAlias `org`\\n      +- \'Project [\'name, \'classification]\\n         +- \'UnresolvedRelation `poc_normalized_legislator`.`organizations`\\n"\n']}, 'Progress': 1.0, 'StartedOn': 1685083591681, 'CompletedOn': 1685083592365}, 'ResponseMetadata': {'RequestId': '2b088cf2-6562-4d44-a192-acacbb7c2e86', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 06:46:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2100', 'connection': 'keep-alive', 'x-amzn-requestid': '2b088cf2-6562-4d44-a192-acacbb7c2e86'}, 'RetryAttempts': 0}}
[0m06:46:33.843669 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:46:33.844666 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:46:33.846656 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:46:33.846656 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:46:33.847649 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:46:33.847649 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:46:33.848645 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:46:33.848645 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:46:33.848645 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 06:46:28.226444 => 2023-05-26 06:46:33.848645
[0m06:46:33.855622 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:46:33.856619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c783e9b-7820-4fe3-b28c-063041323ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C840BD00>]}
[0m06:46:33.857616 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.64s]
[0m06:46:33.860676 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:46:33.862372 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:46:33.862372 [debug] [MainThread]: On master: ROLLBACK
[0m06:46:33.863457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:46:33.863457 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:46:34.963954 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:46:34.964886 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:46:34.964886 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1b2d5103-e0ba-482d-84ea-da9530f5f3fe
[0m06:46:36.256977 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:46:36.257972 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:46:36.258968 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:46:36.258968 [debug] [MainThread]: On master: ROLLBACK
[0m06:46:36.259965 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:46:36.259965 [debug] [MainThread]: On master: Close
[0m06:46:36.259965 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:46:36.261959 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:46:36.671334 [info ] [MainThread]: 
[0m06:46:36.673313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 48.59 seconds (48.59s).
[0m06:46:36.674311 [debug] [MainThread]: Command end result
[0m06:46:36.692449 [info ] [MainThread]: 
[0m06:46:36.692969 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:46:36.694002 [info ] [MainThread]: 
[0m06:46:36.694002 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:46:36.695044 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:46:36.695964 [error] [MainThread]:   
[0m06:46:36.695964 [error] [MainThread]:     
[0m06:46:36.697013 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:46:36.697013 [error] [MainThread]:     using PARQUET
[0m06:46:36.697987 [error] [MainThread]:   	
[0m06:46:36.697987 [error] [MainThread]:   	
[0m06:46:36.698995 [error] [MainThread]:   	
[0m06:46:36.698995 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m06:46:36.700003 [error] [MainThread]:   	
[0m06:46:36.701613 [error] [MainThread]:   	as
[0m06:46:36.702719 [error] [MainThread]:   	with org as (
[0m06:46:36.703719 [error] [MainThread]:   select 
[0m06:46:36.703719 [error] [MainThread]:   name, classification
[0m06:46:36.703719 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:46:36.703719 [error] [MainThread]:   )
[0m06:46:36.704716 [error] [MainThread]:   select name, classification
[0m06:46:36.704716 [error] [MainThread]:   from org
[0m06:46:36.704716 [error] [MainThread]:     '''), AnalysisException: "Table or view not found: `poc_normalized_legislator`.`organizations`; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias `org`\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation `poc_normalized_legislator`.`organizations`\n"
[0m06:46:36.704716 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:46:36.704716 [info ] [MainThread]: 
[0m06:46:36.704716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:46:36.705713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C896C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C896C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C896C4C0>]}
[0m06:46:36.705713 [debug] [MainThread]: Flushing usage events
[0m06:46:37.752146 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:49:02.817076 | b55db580-8016-496c-a73b-168985987f54 ==============================
[0m06:49:02.817076 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:49:02.818060 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:49:02.818060 [debug] [MainThread]: Tracking: tracking
[0m06:49:02.845927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212C06F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212C06FD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212C06F910>]}
[0m06:49:02.858188 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:49:02.864373 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:49:02.865370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212C01FD90>]}
[0m06:49:03.486579 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m06:49:03.541968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012128B4FFD0>]}
[0m06:49:03.547543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212C027460>]}
[0m06:49:03.547543 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:49:03.548542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012128B90670>]}
[0m06:49:03.548542 [info ] [MainThread]: 
[0m06:49:03.549603 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:49:03.551140 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:49:03.551140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:49:03.552139 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:49:03.552139 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:49:03.552139 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:49:20.913472 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:49:20.913472 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f4b0f639-ee93-4093-b76c-b8703d7a034f
[0m06:49:29.108896 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:49:30.194441 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:49:30.195441 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:49:30.198429 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:49:30.199426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:49:30.200423 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:49:31.230088 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:49:31.230088 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:49:31.230088 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f4b0f639-ee93-4093-b76c-b8703d7a034f
[0m06:49:33.908499 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:49:34.971574 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:49:34.972070 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:49:34.973888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012128B4FB20>]}
[0m06:49:34.974885 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:49:34.974885 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:49:34.975881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:49:34.976881 [info ] [MainThread]: 
[0m06:49:34.991421 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:49:34.992417 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:49:34.994488 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:49:34.995484 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:49:35.002129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:49:35.004911 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 06:49:34.996630 => 2023-05-26 06:49:35.004911
[0m06:49:35.004911 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:49:35.020994 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:49:35.021991 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:49:36.056260 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:49:36.057258 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:49:36.058254 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f4b0f639-ee93-4093-b76c-b8703d7a034f
[0m06:49:37.374773 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:49:38.502003 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:49:38.573747 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:49:38.582967 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:49:38.585093 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:49:38.585547 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:49:38.585547 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:49:38.585547 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:49:38.585547 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:49:38.586551 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:49:38.586551 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:49:38.586551 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:49:40.573140 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685083778411, 'CompletedOn': 1685083778968}, 'ResponseMetadata': {'RequestId': '599b6b45-e4c0-4608-9eac-0f133c49f154', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 06:49:40 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2058', 'connection': 'keep-alive', 'x-amzn-requestid': '599b6b45-e4c0-4608-9eac-0f133c49f154'}, 'RetryAttempts': 0}}
[0m06:49:40.573140 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:49:40.574130 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:49:40.576122 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:49:40.576122 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:49:40.577131 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:49:40.577131 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:49:40.578115 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:49:40.578115 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:49:40.579219 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 06:49:35.005918 => 2023-05-26 06:49:40.579219
[0m06:49:40.584270 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:49:40.585308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b55db580-8016-496c-a73b-168985987f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212CE4C280>]}
[0m06:49:40.586336 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.59s]
[0m06:49:40.588248 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:49:40.588988 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:49:40.588988 [debug] [MainThread]: On master: ROLLBACK
[0m06:49:40.590059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:40.590059 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:49:41.662249 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:49:41.662249 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:49:41.663244 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f4b0f639-ee93-4093-b76c-b8703d7a034f
[0m06:49:42.995105 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:49:42.996100 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:49:42.996100 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:49:42.997101 [debug] [MainThread]: On master: ROLLBACK
[0m06:49:42.997101 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:49:42.998102 [debug] [MainThread]: On master: Close
[0m06:49:42.998102 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:49:42.999100 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:49:43.414869 [info ] [MainThread]: 
[0m06:49:43.416865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.87 seconds (39.87s).
[0m06:49:43.418855 [debug] [MainThread]: Command end result
[0m06:49:43.437058 [info ] [MainThread]: 
[0m06:49:43.437058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:49:43.438103 [info ] [MainThread]: 
[0m06:49:43.439052 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:49:43.439052 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:49:43.439052 [error] [MainThread]:   
[0m06:49:43.440331 [error] [MainThread]:     
[0m06:49:43.440331 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:49:43.441374 [error] [MainThread]:     using PARQUET
[0m06:49:43.442369 [error] [MainThread]:   	
[0m06:49:43.442369 [error] [MainThread]:   	
[0m06:49:43.444855 [error] [MainThread]:   	
[0m06:49:43.444855 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m06:49:43.445934 [error] [MainThread]:   	
[0m06:49:43.446347 [error] [MainThread]:   	as
[0m06:49:43.446347 [error] [MainThread]:   	with org as (
[0m06:49:43.447048 [error] [MainThread]:   select 
[0m06:49:43.447048 [error] [MainThread]:   name, classification
[0m06:49:43.447048 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:49:43.448103 [error] [MainThread]:   )
[0m06:49:43.448103 [error] [MainThread]:   select name, classification
[0m06:49:43.449051 [error] [MainThread]:   from org
[0m06:49:43.449051 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:49:43.449051 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:49:43.450085 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m06:49:43.450085 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:49:43.451414 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:49:43.451567 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:49:43.451567 [error] [MainThread]:   
[0m06:49:43.452558 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:49:43.452859 [info ] [MainThread]: 
[0m06:49:43.452859 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:49:43.454084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212CE4C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212CF60BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001212CF60D00>]}
[0m06:49:43.454084 [debug] [MainThread]: Flushing usage events
[0m06:49:44.453664 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:53:54.949338 | dd559f1f-8532-4e65-b993-43e1b72ba59f ==============================
[0m06:53:54.949338 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:53:54.950654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m06:53:54.950654 [debug] [MainThread]: Tracking: tracking
[0m06:53:54.978926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203394E1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033A543730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033A543280>]}
[0m06:53:54.986134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203394E1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033A543850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033A543400>]}
[0m06:53:54.987133 [debug] [MainThread]: Flushing usage events


============================== 2023-05-26 06:54:15.380348 | b1ee90c4-f6a6-436a-813a-9076815d120d ==============================
[0m06:54:15.380348 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:54:15.381493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:54:15.381493 [debug] [MainThread]: Tracking: tracking
[0m06:54:15.410184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7E425E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7E42D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7E428E0>]}
[0m06:54:15.423756 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:54:15.423756 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:54:15.424753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7DE3160>]}
[0m06:54:16.016439 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m06:54:16.071133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7FDC910>]}
[0m06:54:16.077511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7F3E820>]}
[0m06:54:16.077511 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:54:16.078524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7DE3130>]}
[0m06:54:16.079519 [info ] [MainThread]: 
[0m06:54:16.081513 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:54:16.083506 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:54:16.083506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:16.083506 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:54:16.084502 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:54:16.084502 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:54:38.570455 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:54:38.571455 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f6459cae-7790-43ce-be48-ad2b49e4b478
[0m06:54:46.771804 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:54:47.831613 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:54:47.832622 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:54:47.834615 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:54:47.834615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:47.834615 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:54:48.842235 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:54:48.842235 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:54:48.842235 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f6459cae-7790-43ce-be48-ad2b49e4b478
[0m06:54:50.135302 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:54:51.180479 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:54:51.181479 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:54:51.183079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7FDC850>]}
[0m06:54:51.184163 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:54:51.184163 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:54:51.185155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:51.186082 [info ] [MainThread]: 
[0m06:54:51.197012 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:54:51.197012 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:54:51.198088 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:54:51.198088 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:54:51.201152 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:54:51.203970 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 06:54:51.198088 => 2023-05-26 06:54:51.203970
[0m06:54:51.205150 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:54:51.212195 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:54:51.212195 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:54:52.233279 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:54:52.234274 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:54:52.234274 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f6459cae-7790-43ce-be48-ad2b49e4b478
[0m06:54:53.582126 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:54:54.701811 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:54:54.781557 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:54:54.791899 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:54:54.794903 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:54:54.794903 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:54:54.795900 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:54:54.795900 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:54:54.795900 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:54:54.796896 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:54:54.796896 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:54:54.797896 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:54:56.852315 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685084094656, 'CompletedOn': 1685084095155}, 'ResponseMetadata': {'RequestId': 'f179d948-927f-4524-ba48-03c8e98aee6c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 06:54:56 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2058', 'connection': 'keep-alive', 'x-amzn-requestid': 'f179d948-927f-4524-ba48-03c8e98aee6c'}, 'RetryAttempts': 0}}
[0m06:54:56.853312 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:54:56.854309 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:54:56.856302 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:54:56.857300 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:54:56.857300 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:54:56.858295 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:54:56.859292 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:54:56.859292 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:54:56.860289 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 06:54:51.205150 => 2023-05-26 06:54:56.860289
[0m06:54:56.867091 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:54:56.868332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1ee90c4-f6a6-436a-813a-9076815d120d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F798FD90>]}
[0m06:54:56.868332 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.67s]
[0m06:54:56.872767 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:54:56.874683 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:54:56.875753 [debug] [MainThread]: On master: ROLLBACK
[0m06:54:56.876749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:54:56.876749 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:54:57.975752 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:54:57.976756 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:54:57.976756 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f6459cae-7790-43ce-be48-ad2b49e4b478
[0m06:54:59.301917 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:54:59.302912 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:54:59.302912 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:54:59.303909 [debug] [MainThread]: On master: ROLLBACK
[0m06:54:59.303909 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:54:59.303909 [debug] [MainThread]: On master: Close
[0m06:54:59.304905 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:54:59.305903 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:54:59.778481 [info ] [MainThread]: 
[0m06:54:59.779406 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.70 seconds (43.70s).
[0m06:54:59.782888 [debug] [MainThread]: Command end result
[0m06:54:59.794230 [info ] [MainThread]: 
[0m06:54:59.796625 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:54:59.797621 [info ] [MainThread]: 
[0m06:54:59.800809 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:54:59.800809 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:54:59.801811 [error] [MainThread]:   
[0m06:54:59.802803 [error] [MainThread]:     
[0m06:54:59.802803 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:54:59.803806 [error] [MainThread]:     using PARQUET
[0m06:54:59.803806 [error] [MainThread]:   	
[0m06:54:59.804802 [error] [MainThread]:   	
[0m06:54:59.804802 [error] [MainThread]:   	
[0m06:54:59.805886 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m06:54:59.805886 [error] [MainThread]:   	
[0m06:54:59.806724 [error] [MainThread]:   	as
[0m06:54:59.806724 [error] [MainThread]:   	with org as (
[0m06:54:59.806724 [error] [MainThread]:   select 
[0m06:54:59.807724 [error] [MainThread]:   name, classification
[0m06:54:59.808191 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:54:59.808191 [error] [MainThread]:   )
[0m06:54:59.808191 [error] [MainThread]:   select name, classification
[0m06:54:59.809190 [error] [MainThread]:   from org
[0m06:54:59.809190 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:54:59.809190 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:54:59.816161 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m06:54:59.816161 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:54:59.817692 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:54:59.817692 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:54:59.817692 [error] [MainThread]:   
[0m06:54:59.818691 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:54:59.818691 [info ] [MainThread]: 
[0m06:54:59.818691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:54:59.819688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F7EFC580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F487C2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F487CEB0>]}
[0m06:54:59.819688 [debug] [MainThread]: Flushing usage events
[0m06:55:00.741710 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 06:59:24.794823 | 97bb4f4e-d4ae-475a-b803-c9c1c1b7621f ==============================
[0m06:59:24.794823 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:59:24.796057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:59:24.796057 [debug] [MainThread]: Tracking: tracking
[0m06:59:24.838580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7CA2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7CA2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7CA2790>]}
[0m06:59:24.858117 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:59:26.101772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:59:26.101772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:59:26.106762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97bb4f4e-d4ae-475a-b803-c9c1c1b7621f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C4750CD0>]}
[0m06:59:26.111143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97bb4f4e-d4ae-475a-b803-c9c1c1b7621f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7D14A90>]}
[0m06:59:26.112181 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:59:26.112181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb4f4e-d4ae-475a-b803-c9c1c1b7621f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7D14D30>]}
[0m06:59:26.114182 [info ] [MainThread]: 
[0m06:59:26.115131 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:59:26.117998 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:59:26.118997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:59:26.118997 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:59:26.118997 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:59:26.118997 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:59:49.126738 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:59:49.127842 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-c07cc2de-f848-4291-bba6-7ee256b68fe2
[0m06:59:58.988241 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:00:00.061165 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:00:00.062164 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:00:00.063170 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:00:00.063170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:00.064262 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:00:01.393618 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:00:01.394619 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:00:01.394619 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-c07cc2de-f848-4291-bba6-7ee256b68fe2
[0m07:00:03.177903 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:00:04.262879 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:00:04.262879 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:00:04.264874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb4f4e-d4ae-475a-b803-c9c1c1b7621f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C7D148B0>]}
[0m07:00:04.264874 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:00:04.264874 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:00:04.264874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:04.265949 [info ] [MainThread]: 
[0m07:00:04.274351 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:00:04.274351 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:00:04.276282 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:00:04.276282 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:00:04.278039 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:00:04.279483 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 07:00:04.276282 => 2023-05-26 07:00:04.279483
[0m07:00:04.279483 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:00:04.287704 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:00:04.287704 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m07:00:05.465930 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m07:00:05.466925 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m07:00:05.466925 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-c07cc2de-f848-4291-bba6-7ee256b68fe2
[0m07:00:07.579272 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:00:08.673969 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:00:08.700870 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:00:08.704951 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:00:08.704951 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m07:00:08.705856 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:00:08.705856 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m07:00:08.705856 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:00:08.705856 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:00:08.705856 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:00:08.705856 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:00:08.705856 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m07:00:10.667603 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685084408536, 'CompletedOn': 1685084409131}, 'ResponseMetadata': {'RequestId': '6a31b5e1-1e45-4e09-a8a2-defa24b07738', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 07:00:10 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2058', 'connection': 'keep-alive', 'x-amzn-requestid': '6a31b5e1-1e45-4e09-a8a2-defa24b07738'}, 'RetryAttempts': 0}}
[0m07:00:10.668607 [debug] [Thread-1  ]: Glue adapter: status = error
[0m07:00:10.669600 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:00:10.670531 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:00:10.670531 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m07:00:10.670531 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:00:10.670531 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m07:00:10.671519 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:00:10.671877 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m07:00:10.672547 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 07:00:04.279483 => 2023-05-26 07:00:10.672547
[0m07:00:10.732831 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:00:10.732831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb4f4e-d4ae-475a-b803-c9c1c1b7621f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3F41DC0>]}
[0m07:00:10.732831 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.46s]
[0m07:00:10.734825 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:00:10.735837 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:00:10.736894 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:10.736894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:10.736894 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:00:11.811252 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:00:11.811252 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:00:11.811252 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-c07cc2de-f848-4291-bba6-7ee256b68fe2
[0m07:00:14.513664 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:00:14.514655 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:00:14.514655 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:00:14.515654 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:14.515654 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:00:14.516642 [debug] [MainThread]: On master: Close
[0m07:00:14.516642 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:00:14.517640 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:00:14.953396 [info ] [MainThread]: 
[0m07:00:14.954959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 48.84 seconds (48.84s).
[0m07:00:14.958967 [debug] [MainThread]: Command end result
[0m07:00:14.965176 [info ] [MainThread]: 
[0m07:00:14.966173 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:00:14.966435 [info ] [MainThread]: 
[0m07:00:14.966883 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:00:14.966883 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:00:14.967882 [error] [MainThread]:   
[0m07:00:14.967882 [error] [MainThread]:     
[0m07:00:14.968501 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:00:14.968501 [error] [MainThread]:     using PARQUET
[0m07:00:14.968501 [error] [MainThread]:   	
[0m07:00:14.969500 [error] [MainThread]:   	
[0m07:00:14.969500 [error] [MainThread]:   	
[0m07:00:14.969500 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m07:00:14.970764 [error] [MainThread]:   	
[0m07:00:14.975184 [error] [MainThread]:   	as
[0m07:00:14.975184 [error] [MainThread]:   	with org as (
[0m07:00:14.976187 [error] [MainThread]:   select 
[0m07:00:14.976187 [error] [MainThread]:   name, classification
[0m07:00:14.977176 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m07:00:14.977176 [error] [MainThread]:   )
[0m07:00:14.977176 [error] [MainThread]:   select name, classification
[0m07:00:14.978174 [error] [MainThread]:   from org
[0m07:00:14.978174 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m07:00:14.978174 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:00:14.979170 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m07:00:14.979170 [error] [MainThread]:      +- 'SubqueryAlias org
[0m07:00:14.979170 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m07:00:14.980167 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m07:00:14.980167 [error] [MainThread]:   
[0m07:00:14.980167 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:00:14.981303 [info ] [MainThread]: 
[0m07:00:14.981303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:00:14.981303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C8C22B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C8C228E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C8C22BB0>]}
[0m07:00:14.981303 [debug] [MainThread]: Flushing usage events
[0m07:00:15.929591 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 07:19:01.401774 | f107e141-7f95-453b-9afe-297c521f56e7 ==============================
[0m07:19:01.401774 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:19:01.403809 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m07:19:01.403809 [debug] [MainThread]: Tracking: tracking
[0m07:19:01.432551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D571920850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D572982760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D572982280>]}
[0m07:19:01.437532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D571920850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D572982880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D572982430>]}
[0m07:19:01.437532 [debug] [MainThread]: Flushing usage events


============================== 2023-05-26 07:19:05.866547 | e8d040f5-7a1f-486a-abe1-1072beab3539 ==============================
[0m07:19:05.866547 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:19:05.867859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:19:05.868896 [debug] [MainThread]: Tracking: tracking
[0m07:19:05.897568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D8250AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D82C6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D82C6D00>]}
[0m07:19:06.112571 [debug] [MainThread]: Executing "git --help"
[0m07:19:06.194596 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:19:06.194596 [debug] [MainThread]: STDERR: "b''"
[0m07:19:06.210449 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m07:19:06.210506 [debug] [MainThread]: Using glue connection "debug"
[0m07:19:06.210506 [debug] [MainThread]: On debug: select 1 as id
[0m07:19:06.210506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:19:06.210506 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:19:06.210506 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m07:19:06.210506 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m07:19:41.474162 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:19:41.475155 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a432b118-d04b-4ede-aa2d-d26744da5004
[0m07:19:52.738235 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m07:19:52.739234 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m07:19:52.739234 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m07:19:52.740210 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:19:52.740210 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m07:20:00.158236 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685085592602, 'CompletedOn': 1685085599027}, 'ResponseMetadata': {'RequestId': '3813a898-ee7d-4512-ad8a-c559cbdc9b81', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 07:19:59 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '3813a898-ee7d-4512-ad8a-c559cbdc9b81'}, 'RetryAttempts': 0}}
[0m07:20:00.158236 [debug] [MainThread]: Glue adapter: status = ok
[0m07:20:00.159241 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m07:20:00.159241 [debug] [MainThread]: SQL status: OK in 54 seconds
[0m07:20:00.161567 [debug] [MainThread]: On debug: Close
[0m07:20:00.161567 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:20:00.168215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D876B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D8D23CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262D8D23940>]}
[0m07:20:00.169359 [debug] [MainThread]: Flushing usage events
[0m07:20:01.090488 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-26 07:20:13.825619 | d36c6794-4b0e-4893-bd00-193d46339a45 ==============================
[0m07:20:13.825619 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:20:13.827533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:20:13.827533 [debug] [MainThread]: Tracking: tracking
[0m07:20:13.854617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DEF825B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DEF82CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DEF82850>]}
[0m07:20:13.874416 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m07:20:13.875388 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:20:13.875388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DEF22F70>]}
[0m07:20:15.673182 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m07:20:15.726239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DF1468E0>]}
[0m07:20:15.733041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DF07F7F0>]}
[0m07:20:15.733536 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m07:20:15.733536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DEF22190>]}
[0m07:20:15.736033 [info ] [MainThread]: 
[0m07:20:15.740265 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:20:15.742181 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m07:20:15.743177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:15.743177 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:20:15.743177 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m07:20:15.743177 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m07:20:43.085760 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:20:43.086755 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4b7a4924-6818-401c-8497-9854713190e6
[0m07:20:51.279506 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:20:52.492435 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:20:52.492435 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:20:52.496877 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:20:52.496877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:52.497841 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:20:53.528780 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:20:53.529766 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:20:53.529766 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4b7a4924-6818-401c-8497-9854713190e6
[0m07:20:54.899540 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:20:55.961625 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:20:55.961625 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:20:55.963627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DF1467C0>]}
[0m07:20:55.963627 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:20:55.963627 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:20:55.963627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:20:55.964814 [info ] [MainThread]: 
[0m07:20:55.972303 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:20:55.972303 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:20:55.973134 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:20:55.973134 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:20:55.975203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:20:55.978533 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-26 07:20:55.973134 => 2023-05-26 07:20:55.978533
[0m07:20:55.978533 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:20:55.988386 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:20:55.989374 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m07:20:57.131357 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m07:20:57.131357 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m07:20:57.132354 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4b7a4924-6818-401c-8497-9854713190e6
[0m07:20:58.599941 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:20:59.696139 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:20:59.725788 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:20:59.728778 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:20:59.730700 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m07:20:59.730700 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:20:59.730700 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m07:20:59.731706 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:20:59.731929 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:20:59.731929 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:20:59.731929 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:20:59.731929 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m07:21:01.721201 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685085659578, 'CompletedOn': 1685085660032}, 'ResponseMetadata': {'RequestId': 'd86a8406-e38d-40c8-bcd1-74e3d3c6a042', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Fri, 26 May 2023 07:21:01 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2058', 'connection': 'keep-alive', 'x-amzn-requestid': 'd86a8406-e38d-40c8-bcd1-74e3d3c6a042'}, 'RetryAttempts': 0}}
[0m07:21:01.722268 [debug] [Thread-1  ]: Glue adapter: status = error
[0m07:21:01.723269 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:21:01.725263 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:21:01.725263 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m07:21:01.726254 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:21:01.726254 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m07:21:01.727250 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:21:01.727250 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m07:21:01.727250 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-26 07:20:55.979544 => 2023-05-26 07:21:01.727250
[0m07:21:01.758231 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:21:01.758231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd36c6794-4b0e-4893-bd00-193d46339a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DF016820>]}
[0m07:21:01.759230 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.79s]
[0m07:21:01.760318 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:21:01.761478 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:21:01.761478 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:01.761478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:01.761478 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:21:02.836989 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:21:02.836989 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:21:02.837982 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-4b7a4924-6818-401c-8497-9854713190e6
[0m07:21:04.195245 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:21:04.196240 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:21:04.196240 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:21:04.197236 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:04.197236 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:21:04.198232 [debug] [MainThread]: On master: Close
[0m07:21:04.198232 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:21:04.199229 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:21:04.615708 [info ] [MainThread]: 
[0m07:21:04.616202 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 48.88 seconds (48.88s).
[0m07:21:04.620193 [debug] [MainThread]: Command end result
[0m07:21:04.628406 [info ] [MainThread]: 
[0m07:21:04.629406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:21:04.629406 [info ] [MainThread]: 
[0m07:21:04.629406 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:21:04.632566 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:21:04.632566 [error] [MainThread]:   
[0m07:21:04.637539 [error] [MainThread]:     
[0m07:21:04.637539 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:21:04.637539 [error] [MainThread]:     using PARQUET
[0m07:21:04.638537 [error] [MainThread]:   	
[0m07:21:04.638537 [error] [MainThread]:   	
[0m07:21:04.639534 [error] [MainThread]:   	
[0m07:21:04.639534 [error] [MainThread]:   	LOCATION 's3://aws-athena-dbt-glue-query-results-334822733362-us-east-1/poc_curated_dbt/spark_sql_test/'
[0m07:21:04.640537 [error] [MainThread]:   	
[0m07:21:04.640537 [error] [MainThread]:   	as
[0m07:21:04.640537 [error] [MainThread]:   	with org as (
[0m07:21:04.641537 [error] [MainThread]:   select 
[0m07:21:04.641537 [error] [MainThread]:   name, classification
[0m07:21:04.642526 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m07:21:04.642526 [error] [MainThread]:   )
[0m07:21:04.642526 [error] [MainThread]:   select name, classification
[0m07:21:04.643532 [error] [MainThread]:   from org
[0m07:21:04.643532 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m07:21:04.643532 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:21:04.644521 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m07:21:04.644521 [error] [MainThread]:      +- 'SubqueryAlias org
[0m07:21:04.644521 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m07:21:04.645568 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m07:21:04.650202 [error] [MainThread]:   
[0m07:21:04.650202 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:21:04.651391 [info ] [MainThread]: 
[0m07:21:04.651391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:21:04.652618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DF0579A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DB9BFD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DB9BF5E0>]}
[0m07:21:04.652618 [debug] [MainThread]: Flushing usage events
[0m07:21:06.588270 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:30:47.923721 | b05a14f6-1b34-4193-9d96-94a7c3533e61 ==============================
[0m17:30:47.923721 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:30:47.923721 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:30:47.923721 [debug] [MainThread]: Tracking: tracking
[0m17:30:47.945543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C2AD1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C2B47430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C2B47D00>]}
[0m17:30:48.208099 [debug] [MainThread]: Executing "git --help"
[0m17:30:48.257540 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:30:48.257540 [debug] [MainThread]: STDERR: "b''"
[0m17:30:48.257540 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m17:30:48.257540 [debug] [MainThread]: Using glue connection "debug"
[0m17:30:48.257540 [debug] [MainThread]: On debug: select 1 as id
[0m17:30:48.257540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:48.257540 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m17:30:48.257540 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m17:30:48.257540 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m17:31:17.568912 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m17:31:17.568912 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-7be1f405-e91b-44a8-8d8b-9d7eef446458
[0m17:31:26.382739 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m17:31:26.382739 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m17:31:26.382739 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m17:31:26.382739 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m17:31:26.398331 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m17:31:51.238049 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685381486580, 'CompletedOn': 1685381510621}, 'ResponseMetadata': {'RequestId': 'ae248b59-9f2b-4760-bb96-50e25865b119', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 17:31:51 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'ae248b59-9f2b-4760-bb96-50e25865b119'}, 'RetryAttempts': 0}}
[0m17:31:51.238049 [debug] [MainThread]: Glue adapter: status = ok
[0m17:31:51.238049 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m17:31:51.238049 [debug] [MainThread]: SQL status: OK in 63 seconds
[0m17:31:51.238049 [debug] [MainThread]: On debug: Close
[0m17:31:51.238049 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m17:31:51.238049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C3FD4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C45AE250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C45AE160>]}
[0m17:31:51.238049 [debug] [MainThread]: Flushing usage events
[0m17:31:52.626714 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:32:06.357448 | 8cf2b438-65a4-4382-871f-d52a30019db4 ==============================
[0m17:32:06.357448 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:32:06.357448 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:32:06.357448 [debug] [MainThread]: Tracking: tracking
[0m17:32:06.386217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A07525B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0752CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0752820>]}
[0m17:32:06.401849 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:32:06.417549 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:32:06.417549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0700CA0>]}
[0m17:32:07.653679 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m17:32:07.705836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0A88BE0>]}
[0m17:32:07.705836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0705340>]}
[0m17:32:07.713890 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:32:07.713957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002989D295C70>]}
[0m17:32:07.713957 [info ] [MainThread]: 
[0m17:32:07.713957 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:32:07.713957 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m17:32:07.713957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:07.713957 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:32:07.713957 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m17:32:07.713957 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m17:32:24.984462 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:32:24.984462 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f82183a2-cce6-4b55-9dcf-2789b87c83f1
[0m17:32:32.430248 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:32:33.973242 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m17:32:33.973242 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:32:33.973242 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m17:32:33.973242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:33.973242 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:32:35.293784 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m17:32:35.293784 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:32:35.293784 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f82183a2-cce6-4b55-9dcf-2789b87c83f1
[0m17:32:36.982122 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:32:38.482885 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m17:32:38.482885 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:32:38.482885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A0A883D0>]}
[0m17:32:38.482885 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:32:38.482885 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:32:38.482885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:38.482885 [info ] [MainThread]: 
[0m17:32:38.499425 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m17:32:38.499425 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m17:32:38.499425 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m17:32:38.499425 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m17:32:38.499425 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m17:32:38.499425 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 17:32:38.499425 => 2023-05-29 17:32:38.499425
[0m17:32:38.499425 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m17:32:38.515148 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:32:38.515148 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m17:32:39.867800 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m17:32:39.867800 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m17:32:39.867800 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f82183a2-cce6-4b55-9dcf-2789b87c83f1
[0m17:32:41.568972 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:32:42.985360 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:32:43.016527 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m17:32:43.016527 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m17:32:43.016527 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m17:32:43.016527 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685381563203, 'CompletedOn': 1685381563808}, 'ResponseMetadata': {'RequestId': '93d63fa3-8484-4c5d-a2f4-103e8ec775b1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 17:32:45 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': '93d63fa3-8484-4c5d-a2f4-103e8ec775b1'}, 'RetryAttempts': 0}}
[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: status = error
[0m17:32:45.234075 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:32:45.234075 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m17:32:45.234075 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m17:32:45.234075 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m17:32:45.234075 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 17:32:38.499425 => 2023-05-29 17:32:45.234075
[0m17:32:45.303218 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:32:45.303218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cf2b438-65a4-4382-871f-d52a30019db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A151B070>]}
[0m17:32:45.303218 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.80s]
[0m17:32:45.303218 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m17:32:45.318769 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:32:45.318769 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:45.318769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:45.318769 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m17:32:46.753858 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m17:32:46.753858 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m17:32:46.753858 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f82183a2-cce6-4b55-9dcf-2789b87c83f1
[0m17:32:48.428971 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:32:48.428971 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:32:48.428971 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:32:48.428971 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:48.428971 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:32:48.428971 [debug] [MainThread]: On master: Close
[0m17:32:48.428971 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m17:32:48.444557 [debug] [MainThread]: Glue adapter: cleanup called
[0m17:32:48.921095 [info ] [MainThread]: 
[0m17:32:48.921095 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.21 seconds (41.21s).
[0m17:32:48.921095 [debug] [MainThread]: Command end result
[0m17:32:48.936736 [info ] [MainThread]: 
[0m17:32:48.936736 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:32:48.936736 [info ] [MainThread]: 
[0m17:32:48.936736 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m17:32:48.936736 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m17:32:48.936736 [error] [MainThread]:   
[0m17:32:48.936736 [error] [MainThread]:     
[0m17:32:48.936736 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m17:32:48.936736 [error] [MainThread]:     using PARQUET
[0m17:32:48.936736 [error] [MainThread]:   	
[0m17:32:48.936736 [error] [MainThread]:   	
[0m17:32:48.936736 [error] [MainThread]:   	
[0m17:32:48.936736 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m17:32:48.936736 [error] [MainThread]:   	
[0m17:32:48.936736 [error] [MainThread]:   	as
[0m17:32:48.936736 [error] [MainThread]:   	with org as (
[0m17:32:48.936736 [error] [MainThread]:   select 
[0m17:32:48.936736 [error] [MainThread]:   name, classification
[0m17:32:48.936736 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m17:32:48.936736 [error] [MainThread]:   )
[0m17:32:48.936736 [error] [MainThread]:   select name, classification
[0m17:32:48.936736 [error] [MainThread]:   from org
[0m17:32:48.936736 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m17:32:48.952359 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m17:32:48.952359 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m17:32:48.952359 [error] [MainThread]:      +- 'SubqueryAlias org
[0m17:32:48.952359 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m17:32:48.952359 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m17:32:48.952359 [error] [MainThread]:   
[0m17:32:48.952359 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:32:48.952359 [info ] [MainThread]: 
[0m17:32:48.952359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:32:48.952359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A151B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A1630AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A1630C10>]}
[0m17:32:48.952359 [debug] [MainThread]: Flushing usage events
[0m17:32:50.290319 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:36:20.823834 | da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080 ==============================
[0m17:36:20.823834 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:36:20.823834 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:36:20.823834 [debug] [MainThread]: Tracking: tracking
[0m17:36:20.857196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200359814C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020035981C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200359817F0>]}
[0m17:36:20.857196 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:36:20.924273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:20.924273 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m17:36:20.939897 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m17:36:20.971297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200324C5730>]}
[0m17:36:20.971297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020032416C40>]}
[0m17:36:20.971297 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:36:20.971297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020035930F10>]}
[0m17:36:20.971297 [info ] [MainThread]: 
[0m17:36:20.971297 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:36:20.986988 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m17:36:20.986988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:20.986988 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:36:20.986988 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m17:36:20.986988 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m17:36:55.982478 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:36:55.982478 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-cb1c1b1e-d474-4b7b-861e-1296307cbdb0
[0m17:37:04.827326 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:37:06.363331 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m17:37:06.363331 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:37:06.363331 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m17:37:06.363331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:06.363331 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:37:08.081519 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m17:37:08.081519 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:37:08.081519 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-cb1c1b1e-d474-4b7b-861e-1296307cbdb0
[0m17:37:09.740889 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:37:11.158848 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m17:37:11.158848 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:37:11.158848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020032416FA0>]}
[0m17:37:11.158848 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:37:11.158848 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:37:11.158848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:11.158848 [info ] [MainThread]: 
[0m17:37:11.158848 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m17:37:11.158848 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m17:37:11.158848 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m17:37:11.158848 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m17:37:11.174513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m17:37:11.174513 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 17:37:11.158848 => 2023-05-29 17:37:11.174513
[0m17:37:11.174513 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m17:37:11.174513 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:37:11.174513 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m17:37:12.460168 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m17:37:12.460168 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m17:37:12.460168 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-cb1c1b1e-d474-4b7b-861e-1296307cbdb0
[0m17:37:14.130908 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:37:15.448026 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m17:37:15.526140 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:37:15.526140 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m17:37:15.526140 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m17:37:15.526140 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m17:37:15.526140 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:37:15.532693 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:37:15.532693 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m17:37:15.532693 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m17:37:15.532693 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m17:37:15.532693 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m17:37:17.784766 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685381835715, 'CompletedOn': 1685381836222}, 'ResponseMetadata': {'RequestId': '27ce5838-ffea-4535-90b8-9010970d1456', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 17:37:17 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': '27ce5838-ffea-4535-90b8-9010970d1456'}, 'RetryAttempts': 0}}
[0m17:37:17.784766 [debug] [Thread-1  ]: Glue adapter: status = error
[0m17:37:17.784766 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:37:17.784766 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:37:17.784766 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:37:17.784766 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m17:37:17.784766 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m17:37:17.800276 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m17:37:17.800276 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m17:37:17.800276 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 17:37:11.174513 => 2023-05-29 17:37:17.800276
[0m17:37:17.800276 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:37:17.800276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2b6ea2-fdd7-4d7e-909e-0fb3e2a6d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200367A46A0>]}
[0m17:37:17.800276 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.64s]
[0m17:37:17.800276 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m17:37:17.800276 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:37:17.800276 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:17.800276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:17.800276 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m17:37:19.254852 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m17:37:19.254852 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m17:37:19.254852 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-cb1c1b1e-d474-4b7b-861e-1296307cbdb0
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:37:20.941556 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:37:20.941556 [debug] [MainThread]: On master: Close
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m17:37:20.941556 [debug] [MainThread]: Glue adapter: cleanup called
[0m17:37:21.457560 [info ] [MainThread]: 
[0m17:37:21.473143 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 0.49 seconds (60.49s).
[0m17:37:21.473143 [debug] [MainThread]: Command end result
[0m17:37:21.488961 [info ] [MainThread]: 
[0m17:37:21.488961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:21.488961 [info ] [MainThread]: 
[0m17:37:21.488961 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m17:37:21.488961 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m17:37:21.488961 [error] [MainThread]:   
[0m17:37:21.488961 [error] [MainThread]:     
[0m17:37:21.488961 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m17:37:21.488961 [error] [MainThread]:     using PARQUET
[0m17:37:21.488961 [error] [MainThread]:   	
[0m17:37:21.488961 [error] [MainThread]:   	
[0m17:37:21.488961 [error] [MainThread]:   	
[0m17:37:21.488961 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m17:37:21.488961 [error] [MainThread]:   	
[0m17:37:21.488961 [error] [MainThread]:   	as
[0m17:37:21.488961 [error] [MainThread]:   	with org as (
[0m17:37:21.488961 [error] [MainThread]:   select 
[0m17:37:21.488961 [error] [MainThread]:   name, classification
[0m17:37:21.488961 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m17:37:21.488961 [error] [MainThread]:   )
[0m17:37:21.488961 [error] [MainThread]:   select name, classification
[0m17:37:21.488961 [error] [MainThread]:   from org
[0m17:37:21.488961 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m17:37:21.488961 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m17:37:21.488961 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m17:37:21.488961 [error] [MainThread]:      +- 'SubqueryAlias org
[0m17:37:21.488961 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m17:37:21.488961 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m17:37:21.488961 [error] [MainThread]:   
[0m17:37:21.488961 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:37:21.504696 [info ] [MainThread]: 
[0m17:37:21.504696 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:37:21.504696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002F57EFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200339A7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200354BD310>]}
[0m17:37:21.504696 [debug] [MainThread]: Flushing usage events
[0m17:37:22.722741 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:37:43.146423 | 95b323eb-02c0-4c13-8d3f-f1944f42173d ==============================
[0m17:37:43.146423 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:37:43.146423 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m17:37:43.146423 [debug] [MainThread]: Tracking: tracking
[0m17:37:43.183761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F454711880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4547A1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4547A12B0>]}
[0m17:37:43.183761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F454711880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4547A1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4547A13D0>]}
[0m17:37:43.183761 [debug] [MainThread]: Flushing usage events


============================== 2023-05-29 17:37:49.006145 | a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c ==============================
[0m17:37:49.006145 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:37:49.006145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:37:49.006145 [debug] [MainThread]: Tracking: tracking
[0m17:37:49.037796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439BA14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439BA1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439BA1880>]}
[0m17:37:49.053427 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:37:49.053427 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:37:49.053427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439B47040>]}
[0m17:37:49.630309 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m17:37:49.680040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439D618B0>]}
[0m17:37:49.690051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439C9F7C0>]}
[0m17:37:49.690051 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:37:49.690051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439B47130>]}
[0m17:37:49.690051 [info ] [MainThread]: 
[0m17:37:49.690051 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:37:49.690051 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m17:37:49.690051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:49.690051 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:37:49.690051 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m17:37:49.690051 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m17:38:07.871316 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:38:07.871316 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a4bf6678-51eb-4d62-b3fe-b84a62482007
[0m17:38:15.162650 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:38:16.495461 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m17:38:16.495461 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:38:16.495461 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m17:38:16.495461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:16.495461 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:38:17.784193 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m17:38:17.799861 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:38:17.799861 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a4bf6678-51eb-4d62-b3fe-b84a62482007
[0m17:38:19.332258 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:38:20.576566 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m17:38:20.576566 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:38:20.576566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439D61790>]}
[0m17:38:20.576566 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:38:20.576566 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:38:20.576566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:20.576566 [info ] [MainThread]: 
[0m17:38:20.592521 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m17:38:20.592521 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m17:38:20.592521 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m17:38:20.592521 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m17:38:20.609193 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m17:38:20.609193 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 17:38:20.592521 => 2023-05-29 17:38:20.609193
[0m17:38:20.609193 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m17:38:20.624849 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:38:20.624849 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m17:38:21.991229 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m17:38:21.991229 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m17:38:21.991229 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a4bf6678-51eb-4d62-b3fe-b84a62482007
[0m17:38:23.766212 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:38:25.099057 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m17:38:25.130191 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:38:25.145815 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m17:38:25.150283 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m17:38:25.150283 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m17:38:25.150283 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:38:25.151358 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:38:25.151358 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m17:38:25.151358 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m17:38:25.151358 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m17:38:25.151358 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m17:38:27.306971 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685381905383, 'CompletedOn': 1685381905803}, 'ResponseMetadata': {'RequestId': '60060637-f964-4cb2-b04a-8bfaa6a062ef', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 17:38:27 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': '60060637-f964-4cb2-b04a-8bfaa6a062ef'}, 'RetryAttempts': 0}}
[0m17:38:27.306971 [debug] [Thread-1  ]: Glue adapter: status = error
[0m17:38:27.322545 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:38:27.322545 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:38:27.322545 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:38:27.322545 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m17:38:27.322545 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m17:38:27.322545 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m17:38:27.322545 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m17:38:27.322545 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 17:38:20.609193 => 2023-05-29 17:38:27.322545
[0m17:38:27.329948 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:38:27.329948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4b2ac58-0f1d-4f99-bb4b-01b76a62b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439D519A0>]}
[0m17:38:27.329948 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.74s]
[0m17:38:27.329948 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m17:38:27.329948 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:38:27.329948 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:27.329948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:27.329948 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m17:38:28.611593 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m17:38:28.627178 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m17:38:28.627178 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-a4bf6678-51eb-4d62-b3fe-b84a62482007
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:38:30.141187 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:38:30.141187 [debug] [MainThread]: On master: Close
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m17:38:30.141187 [debug] [MainThread]: Glue adapter: cleanup called
[0m17:38:30.602591 [info ] [MainThread]: 
[0m17:38:30.602591 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 40.91 seconds (40.91s).
[0m17:38:30.618309 [debug] [MainThread]: Command end result
[0m17:38:30.633854 [info ] [MainThread]: 
[0m17:38:30.633854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:30.633854 [info ] [MainThread]: 
[0m17:38:30.633854 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m17:38:30.633854 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m17:38:30.633854 [error] [MainThread]:   
[0m17:38:30.633854 [error] [MainThread]:     
[0m17:38:30.633854 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m17:38:30.633854 [error] [MainThread]:     using PARQUET
[0m17:38:30.633854 [error] [MainThread]:   	
[0m17:38:30.633854 [error] [MainThread]:   	
[0m17:38:30.633854 [error] [MainThread]:   	
[0m17:38:30.633854 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m17:38:30.633854 [error] [MainThread]:   	
[0m17:38:30.633854 [error] [MainThread]:   	as
[0m17:38:30.649554 [error] [MainThread]:   	with org as (
[0m17:38:30.649554 [error] [MainThread]:   select 
[0m17:38:30.649554 [error] [MainThread]:   name, classification
[0m17:38:30.649554 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m17:38:30.649554 [error] [MainThread]:   )
[0m17:38:30.649554 [error] [MainThread]:   select name, classification
[0m17:38:30.649554 [error] [MainThread]:   from org
[0m17:38:30.649554 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m17:38:30.649554 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m17:38:30.649554 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m17:38:30.649554 [error] [MainThread]:      +- 'SubqueryAlias org
[0m17:38:30.649554 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m17:38:30.649554 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m17:38:30.649554 [error] [MainThread]:   
[0m17:38:30.649554 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:38:30.649554 [info ] [MainThread]: 
[0m17:38:30.649554 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:38:30.666189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024439C05880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244365DD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244365DD580>]}
[0m17:38:30.666700 [debug] [MainThread]: Flushing usage events
[0m17:38:31.953621 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:53:14.235974 | 6614ef60-fb03-4ad1-9433-86eedab3001e ==============================
[0m17:53:14.235974 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:53:14.236975 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:53:14.236975 [debug] [MainThread]: Tracking: tracking
[0m17:53:14.264897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF8BB3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF8BB3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF8BB38B0>]}
[0m17:53:14.284944 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:53:15.035353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:15.050978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:15.050978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6614ef60-fb03-4ad1-9433-86eedab3001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF5660DC0>]}
[0m17:53:15.050978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6614ef60-fb03-4ad1-9433-86eedab3001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF8C41B80>]}
[0m17:53:15.050978 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:53:15.050978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6614ef60-fb03-4ad1-9433-86eedab3001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF8C41E20>]}
[0m17:53:15.050978 [info ] [MainThread]: 
[0m17:53:15.050978 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:53:15.050978 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m17:53:15.050978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:15.050978 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:53:15.050978 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m17:53:15.050978 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m17:53:37.803884 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:53:37.804919 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bc05d812-7a23-47bd-8403-4c8128014c89
[0m17:53:46.686853 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:53:48.429827 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m17:53:48.429827 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:53:48.433845 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m17:53:48.434759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:48.434759 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:53:49.792481 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m17:53:49.793480 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:53:49.793480 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bc05d812-7a23-47bd-8403-4c8128014c89
[0m17:53:51.414776 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:53:52.758162 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m17:53:52.758162 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:53:52.760147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6614ef60-fb03-4ad1-9433-86eedab3001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF5667250>]}
[0m17:53:52.760147 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:53:52.761172 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:53:52.762163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:52.763089 [info ] [MainThread]: 
[0m17:53:52.773189 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m17:53:52.773189 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m17:53:52.774518 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m17:53:52.775521 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m17:53:52.782522 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m17:53:52.783522 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 17:53:52.775521 => 2023-05-29 17:53:52.783522
[0m17:53:52.784606 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m17:53:52.801544 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:53:52.801544 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m17:53:54.136475 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m17:53:54.136475 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m17:53:54.136475 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bc05d812-7a23-47bd-8403-4c8128014c89
[0m17:53:55.667621 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:53:57.014015 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m17:53:57.074557 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:53:57.090192 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m17:53:57.091447 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m17:53:57.091447 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m17:53:57.091946 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:53:57.091946 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m17:53:57.091946 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m17:53:57.091946 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m17:53:57.091946 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m17:53:57.091946 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m17:53:59.253256 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685382837273, 'CompletedOn': 1685382837834}, 'ResponseMetadata': {'RequestId': '1a9a48fe-c2be-4107-b5c9-876a4d5f0fa4', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 17:53:59 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': '1a9a48fe-c2be-4107-b5c9-876a4d5f0fa4'}, 'RetryAttempts': 0}}
[0m17:53:59.253256 [debug] [Thread-1  ]: Glue adapter: status = error
[0m17:53:59.254201 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:53:59.255391 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m17:53:59.256461 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m17:53:59.257463 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m17:53:59.258462 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m17:53:59.258462 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m17:53:59.259387 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m17:53:59.260388 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 17:53:52.784962 => 2023-05-29 17:53:59.259387
[0m17:53:59.328113 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:53:59.329148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6614ef60-fb03-4ad1-9433-86eedab3001e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF5645DC0>]}
[0m17:53:59.329148 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.55s]
[0m17:53:59.332194 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m17:53:59.335188 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:53:59.335188 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:59.336192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:59.336192 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m17:54:00.684168 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m17:54:00.684168 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m17:54:00.684168 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bc05d812-7a23-47bd-8403-4c8128014c89
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:54:02.552571 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m17:54:02.552571 [debug] [MainThread]: On master: Close
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m17:54:02.552571 [debug] [MainThread]: Glue adapter: cleanup called
[0m17:54:03.067330 [info ] [MainThread]: 
[0m17:54:03.067330 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 48.02 seconds (48.02s).
[0m17:54:03.067330 [debug] [MainThread]: Command end result
[0m17:54:03.085079 [info ] [MainThread]: 
[0m17:54:03.085079 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:03.085079 [info ] [MainThread]: 
[0m17:54:03.085079 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m17:54:03.085079 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m17:54:03.085079 [error] [MainThread]:   
[0m17:54:03.085079 [error] [MainThread]:     
[0m17:54:03.098799 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m17:54:03.098799 [error] [MainThread]:     using PARQUET
[0m17:54:03.099824 [error] [MainThread]:   	
[0m17:54:03.099824 [error] [MainThread]:   	
[0m17:54:03.100816 [error] [MainThread]:   	
[0m17:54:03.101239 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m17:54:03.101239 [error] [MainThread]:   	
[0m17:54:03.101239 [error] [MainThread]:   	as
[0m17:54:03.101239 [error] [MainThread]:   	with org as (
[0m17:54:03.101239 [error] [MainThread]:   select 
[0m17:54:03.101239 [error] [MainThread]:   name, classification
[0m17:54:03.101239 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m17:54:03.101239 [error] [MainThread]:   )
[0m17:54:03.101239 [error] [MainThread]:   select name, classification
[0m17:54:03.101239 [error] [MainThread]:   from org
[0m17:54:03.101239 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m17:54:03.101239 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m17:54:03.101239 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m17:54:03.101239 [error] [MainThread]:      +- 'SubqueryAlias org
[0m17:54:03.101239 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m17:54:03.101239 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m17:54:03.101239 [error] [MainThread]:   
[0m17:54:03.101239 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m17:54:03.101239 [info ] [MainThread]: 
[0m17:54:03.101239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:03.101239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF948E700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF9B6CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF9B6CEE0>]}
[0m17:54:03.101239 [debug] [MainThread]: Flushing usage events
[0m17:54:04.443610 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 17:59:24.370615 | 51f661b5-b72e-4cdd-bd9c-d05c994ff9dc ==============================
[0m17:59:24.370615 [info ] [MainThread]: Running with dbt=1.4.6
[0m17:59:24.370615 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:24.370615 [debug] [MainThread]: Tracking: tracking
[0m17:59:24.401875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96D1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96D1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96D17F0>]}
[0m17:59:24.417497 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m17:59:25.034476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:25.034476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:25.050030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51f661b5-b72e-4cdd-bd9c-d05c994ff9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E6181D00>]}
[0m17:59:25.050030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51f661b5-b72e-4cdd-bd9c-d05c994ff9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96F78E0>]}
[0m17:59:25.050030 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:59:25.050030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f661b5-b72e-4cdd-bd9c-d05c994ff9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96F7D60>]}
[0m17:59:25.050030 [info ] [MainThread]: 
[0m17:59:25.050030 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m17:59:25.050030 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m17:59:25.065722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:25.065722 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:59:25.065722 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m17:59:25.065722 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m17:59:43.323583 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:59:43.323583 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-7bf1243f-0807-4e89-bb7d-265aafbf7a9d
[0m17:59:51.887842 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:59:53.292837 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m17:59:53.292837 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:59:53.292837 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m17:59:53.292837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:53.292837 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m17:59:54.744939 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m17:59:54.744939 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m17:59:54.744939 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-7bf1243f-0807-4e89-bb7d-265aafbf7a9d
[0m17:59:56.505614 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m17:59:57.810744 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m17:59:57.810744 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m17:59:57.810744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f661b5-b72e-4cdd-bd9c-d05c994ff9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E96D1A30>]}
[0m17:59:57.810744 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m17:59:57.810744 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m17:59:57.810744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:57.810744 [info ] [MainThread]: 
[0m17:59:57.826344 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m17:59:57.826344 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m17:59:57.826344 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m17:59:57.826344 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m17:59:57.841960 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m17:59:57.841960 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 17:59:57.826344 => 2023-05-29 17:59:57.841960
[0m17:59:57.841960 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m17:59:57.841960 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:59:57.841960 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m17:59:59.345818 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m17:59:59.345818 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m17:59:59.345818 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-7bf1243f-0807-4e89-bb7d-265aafbf7a9d
[0m18:00:00.884484 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:00:02.234735 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m18:00:02.250357 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:00:02.265982 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m18:00:02.265982 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m18:00:02.265982 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m18:00:02.265982 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685383202520, 'CompletedOn': 1685383203094}, 'ResponseMetadata': {'RequestId': 'c27996ad-0462-49c6-b32c-372cd5655a31', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 18:00:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': 'c27996ad-0462-49c6-b32c-372cd5655a31'}, 'RetryAttempts': 0}}
[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: status = error
[0m18:00:04.540309 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m18:00:04.540309 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m18:00:04.540309 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m18:00:04.540309 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m18:00:04.540309 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 17:59:57.841960 => 2023-05-29 18:00:04.540309
[0m18:00:04.610050 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:00:04.610050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51f661b5-b72e-4cdd-bd9c-d05c994ff9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EA03BBB0>]}
[0m18:00:04.610050 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.78s]
[0m18:00:04.610050 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m18:00:04.610050 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m18:00:04.610050 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:04.610050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:04.610050 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m18:00:05.961161 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m18:00:05.961161 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m18:00:05.961161 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-7bf1243f-0807-4e89-bb7d-265aafbf7a9d
[0m18:00:07.489691 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:00:07.489691 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m18:00:07.489691 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m18:00:07.489691 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:07.489691 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:00:07.489691 [debug] [MainThread]: On master: Close
[0m18:00:07.489691 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m18:00:07.505401 [debug] [MainThread]: Glue adapter: cleanup called
[0m18:00:07.989595 [info ] [MainThread]: 
[0m18:00:08.005227 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 42.94 seconds (42.94s).
[0m18:00:08.005227 [debug] [MainThread]: Command end result
[0m18:00:08.005227 [info ] [MainThread]: 
[0m18:00:08.005227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:08.005227 [info ] [MainThread]: 
[0m18:00:08.005227 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m18:00:08.005227 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m18:00:08.005227 [error] [MainThread]:   
[0m18:00:08.005227 [error] [MainThread]:     
[0m18:00:08.005227 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m18:00:08.005227 [error] [MainThread]:     using PARQUET
[0m18:00:08.005227 [error] [MainThread]:   	
[0m18:00:08.005227 [error] [MainThread]:   	
[0m18:00:08.005227 [error] [MainThread]:   	
[0m18:00:08.005227 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m18:00:08.005227 [error] [MainThread]:   	
[0m18:00:08.005227 [error] [MainThread]:   	as
[0m18:00:08.020847 [error] [MainThread]:   	with org as (
[0m18:00:08.020847 [error] [MainThread]:   select 
[0m18:00:08.020847 [error] [MainThread]:   name, classification
[0m18:00:08.020847 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m18:00:08.020847 [error] [MainThread]:   )
[0m18:00:08.020847 [error] [MainThread]:   select name, classification
[0m18:00:08.020847 [error] [MainThread]:   from org
[0m18:00:08.020847 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m18:00:08.020847 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m18:00:08.020847 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m18:00:08.020847 [error] [MainThread]:      +- 'SubqueryAlias org
[0m18:00:08.020847 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m18:00:08.020847 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m18:00:08.020847 [error] [MainThread]:   
[0m18:00:08.020847 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:00:08.020847 [info ] [MainThread]: 
[0m18:00:08.020847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:08.020847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E9FAE130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EA69CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EA69CC70>]}
[0m18:00:08.020847 [debug] [MainThread]: Flushing usage events
[0m18:00:09.291400 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 18:36:45.196316 | c75c27d8-b88d-4c92-9212-419a70ec7fed ==============================
[0m18:36:45.196316 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:36:45.196316 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:36:45.196316 [debug] [MainThread]: Tracking: tracking
[0m18:36:45.243115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB34BC25B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB34BC2C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB34BC2850>]}
[0m18:36:45.258731 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:36:45.844987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:36:45.844987 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m18:36:45.860612 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m18:36:45.882661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c75c27d8-b88d-4c92-9212-419a70ec7fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB31705760>]}
[0m18:36:45.882661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c75c27d8-b88d-4c92-9212-419a70ec7fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB34B71AC0>]}
[0m18:36:45.882661 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:36:45.882661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75c27d8-b88d-4c92-9212-419a70ec7fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB34B71580>]}
[0m18:36:45.882661 [info ] [MainThread]: 
[0m18:36:45.898359 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m18:36:45.898359 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m18:36:45.898359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:45.898359 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m18:36:45.898359 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m18:36:45.898359 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m18:37:21.189230 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m18:37:21.189230 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-155c9a99-3134-4a61-a948-6201db86fd3b
[0m18:37:29.247832 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m18:37:30.305519 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m18:37:30.305519 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m18:37:30.305519 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m18:37:30.305519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:30.305519 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m18:37:31.291258 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m18:37:31.291258 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m18:37:31.291258 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-155c9a99-3134-4a61-a948-6201db86fd3b
[0m18:37:32.595293 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m18:37:33.561078 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m18:37:33.561078 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m18:37:33.561078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75c27d8-b88d-4c92-9212-419a70ec7fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB31655E20>]}
[0m18:37:33.561078 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m18:37:33.561078 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m18:37:33.561078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:33.561078 [info ] [MainThread]: 
[0m18:37:33.576592 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m18:37:33.576592 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m18:37:33.576592 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m18:37:33.576592 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m18:37:33.576592 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m18:37:33.576592 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 18:37:33.576592 => 2023-05-29 18:37:33.576592
[0m18:37:33.576592 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m18:37:33.592218 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:37:33.592218 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m18:37:34.621493 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m18:37:34.621493 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m18:37:34.637775 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-155c9a99-3134-4a61-a948-6201db86fd3b
[0m18:37:35.879653 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:37:37.003328 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:37:37.066146 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m18:37:37.066146 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m18:37:37.066146 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m18:37:37.066146 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  ''')
[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom data_source.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: data_source.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [data_source, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [data_source, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685385457284, 'CompletedOn': 1685385457866}, 'ResponseMetadata': {'RequestId': '8813dec9-0844-473d-b169-5564db8beee0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 18:37:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1958', 'connection': 'keep-alive', 'x-amzn-requestid': '8813dec9-0844-473d-b169-5564db8beee0'}, 'RetryAttempts': 0}}
[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: status = error
[0m18:37:39.087295 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [data_source, organizations], [], false

[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [data_source, organizations], [], false

[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  
[0m18:37:39.087295 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m18:37:39.087295 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m18:37:39.087295 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m18:37:39.087295 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 18:37:33.576592 => 2023-05-29 18:37:39.087295
[0m18:37:39.156278 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from data_source.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [data_source, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:37:39.156278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75c27d8-b88d-4c92-9212-419a70ec7fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB359E46D0>]}
[0m18:37:39.156278 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.58s]
[0m18:37:39.156278 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m18:37:39.156278 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m18:37:39.156278 [debug] [MainThread]: On master: ROLLBACK
[0m18:37:39.156278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:37:39.156278 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m18:37:40.190004 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m18:37:40.190004 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m18:37:40.190004 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-155c9a99-3134-4a61-a948-6201db86fd3b
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m18:37:41.564466 [debug] [MainThread]: On master: ROLLBACK
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:37:41.564466 [debug] [MainThread]: On master: Close
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m18:37:41.564466 [debug] [MainThread]: Glue adapter: cleanup called
[0m18:37:41.950354 [info ] [MainThread]: 
[0m18:37:41.950354 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 56.07 seconds (56.07s).
[0m18:37:41.950354 [debug] [MainThread]: Command end result
[0m18:37:41.966041 [info ] [MainThread]: 
[0m18:37:41.981624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:37:41.981624 [info ] [MainThread]: 
[0m18:37:41.981624 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m18:37:41.981624 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m18:37:41.981624 [error] [MainThread]:   
[0m18:37:41.981624 [error] [MainThread]:     
[0m18:37:41.981624 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m18:37:41.981624 [error] [MainThread]:     using PARQUET
[0m18:37:41.981624 [error] [MainThread]:   	
[0m18:37:41.981624 [error] [MainThread]:   	
[0m18:37:41.981624 [error] [MainThread]:   	
[0m18:37:41.981624 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m18:37:41.981624 [error] [MainThread]:   	
[0m18:37:41.981624 [error] [MainThread]:   	as
[0m18:37:41.981624 [error] [MainThread]:   	with org as (
[0m18:37:41.981624 [error] [MainThread]:   select 
[0m18:37:41.981624 [error] [MainThread]:   name, classification
[0m18:37:41.981624 [error] [MainThread]:   from data_source.organizations
[0m18:37:41.981624 [error] [MainThread]:   )
[0m18:37:41.981624 [error] [MainThread]:   select name, classification
[0m18:37:41.997207 [error] [MainThread]:   from org
[0m18:37:41.997207 [error] [MainThread]:     '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
[0m18:37:41.997207 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m18:37:41.997207 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m18:37:41.997207 [error] [MainThread]:      +- 'SubqueryAlias org
[0m18:37:41.997207 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m18:37:41.997207 [error] [MainThread]:            +- 'UnresolvedRelation [data_source, organizations], [], false
[0m18:37:41.997207 [error] [MainThread]:   
[0m18:37:41.997207 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:37:41.997207 [info ] [MainThread]: 
[0m18:37:41.997207 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:37:41.997207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB33737370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB35AFC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB32BF67C0>]}
[0m18:37:41.997207 [debug] [MainThread]: Flushing usage events
[0m18:37:42.985268 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-29 18:38:53.094328 | 9dd5d7be-3e9d-404d-9a9e-902f553f8ecc ==============================
[0m18:38:53.094328 [info ] [MainThread]: Running with dbt=1.4.6
[0m18:38:53.094328 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:38:53.094328 [debug] [MainThread]: Tracking: tracking
[0m18:38:53.125572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220929F1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220929F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220929F1910>]}
[0m18:38:53.141204 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m18:38:53.194741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:53.194741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:53.194741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dd5d7be-3e9d-404d-9a9e-902f553f8ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002208F4A1E50>]}
[0m18:38:53.210589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dd5d7be-3e9d-404d-9a9e-902f553f8ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022092A55A30>]}
[0m18:38:53.210589 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:38:53.210589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd5d7be-3e9d-404d-9a9e-902f553f8ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022092A55EB0>]}
[0m18:38:53.210589 [info ] [MainThread]: 
[0m18:38:53.210589 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m18:38:53.210589 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m18:38:53.210589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:53.210589 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m18:38:53.210589 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m18:38:53.210589 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m18:39:10.453013 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m18:39:10.453013 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-13429578-9e9b-4381-9d5b-aafe30364562
[0m18:39:18.639098 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m18:39:19.728818 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m18:39:19.728818 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m18:39:19.728818 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m18:39:19.728818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:19.728818 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m18:39:20.963451 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m18:39:20.963451 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m18:39:20.963451 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-13429578-9e9b-4381-9d5b-aafe30364562
[0m18:39:22.300113 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m18:39:23.404978 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m18:39:23.404978 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m18:39:23.404978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd5d7be-3e9d-404d-9a9e-902f553f8ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022092A55CD0>]}
[0m18:39:23.404978 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m18:39:23.404978 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m18:39:23.404978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:23.404978 [info ] [MainThread]: 
[0m18:39:23.420532 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m18:39:23.420532 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m18:39:23.420532 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m18:39:23.420532 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m18:39:23.427116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m18:39:23.427116 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-29 18:39:23.420532 => 2023-05-29 18:39:23.427116
[0m18:39:23.427116 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m18:39:23.427116 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:39:23.427116 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m18:39:24.662762 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m18:39:24.662762 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m18:39:24.662762 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-13429578-9e9b-4381-9d5b-aafe30364562
[0m18:39:26.153165 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:39:27.220198 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m18:39:27.242421 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:39:27.258138 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m18:39:27.258138 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m18:39:27.258138 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m18:39:27.258138 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  ''')
[0m18:39:29.266039 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom data_source.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: data_source.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [data_source, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [data_source, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685385567485, 'CompletedOn': 1685385568030}, 'ResponseMetadata': {'RequestId': 'f8fe74da-1c26-440a-bce5-33f92a824f7a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Mon, 29 May 2023 18:39:29 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1958', 'connection': 'keep-alive', 'x-amzn-requestid': 'f8fe74da-1c26-440a-bce5-33f92a824f7a'}, 'RetryAttempts': 0}}
[0m18:39:29.266039 [debug] [Thread-1  ]: Glue adapter: status = error
[0m18:39:29.266039 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [data_source, organizations], [], false

[0m18:39:29.266039 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [data_source, organizations], [], false

[0m18:39:29.266039 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from data_source.organizations
)
select name, classification
from org
  
[0m18:39:29.266039 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m18:39:29.266039 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m18:39:29.281617 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m18:39:29.281617 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m18:39:29.281617 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-29 18:39:23.427116 => 2023-05-29 18:39:29.281617
[0m18:39:29.281617 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from data_source.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [data_source, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:39:29.281617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd5d7be-3e9d-404d-9a9e-902f553f8ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002209335BD60>]}
[0m18:39:29.281617 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.86s]
[0m18:39:29.281617 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m18:39:29.281617 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m18:39:29.281617 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:29.281617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:29.281617 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m18:39:30.255258 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m18:39:30.255258 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m18:39:30.255258 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-13429578-9e9b-4381-9d5b-aafe30364562
[0m18:39:31.475245 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:39:31.475245 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m18:39:31.475245 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m18:39:31.490738 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:31.490738 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m18:39:31.490738 [debug] [MainThread]: On master: Close
[0m18:39:31.490738 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m18:39:31.490738 [debug] [MainThread]: Glue adapter: cleanup called
[0m18:39:31.908475 [info ] [MainThread]: 
[0m18:39:31.908475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.70 seconds (38.70s).
[0m18:39:31.908475 [debug] [MainThread]: Command end result
[0m18:39:31.908475 [info ] [MainThread]: 
[0m18:39:31.908475 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:31.908475 [info ] [MainThread]: 
[0m18:39:31.908475 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m18:39:31.908475 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m18:39:31.908475 [error] [MainThread]:   
[0m18:39:31.908475 [error] [MainThread]:     
[0m18:39:31.908475 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m18:39:31.908475 [error] [MainThread]:     using PARQUET
[0m18:39:31.908475 [error] [MainThread]:   	
[0m18:39:31.908475 [error] [MainThread]:   	
[0m18:39:31.908475 [error] [MainThread]:   	
[0m18:39:31.924095 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m18:39:31.924095 [error] [MainThread]:   	
[0m18:39:31.924095 [error] [MainThread]:   	as
[0m18:39:31.924095 [error] [MainThread]:   	with org as (
[0m18:39:31.924095 [error] [MainThread]:   select 
[0m18:39:31.924095 [error] [MainThread]:   name, classification
[0m18:39:31.924095 [error] [MainThread]:   from data_source.organizations
[0m18:39:31.924095 [error] [MainThread]:   )
[0m18:39:31.924095 [error] [MainThread]:   select name, classification
[0m18:39:31.924095 [error] [MainThread]:   from org
[0m18:39:31.924095 [error] [MainThread]:     '''), AnalysisException: Table or view not found: data_source.organizations; line 15 pos 5;
[0m18:39:31.924095 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m18:39:31.924095 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m18:39:31.924095 [error] [MainThread]:      +- 'SubqueryAlias org
[0m18:39:31.924095 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m18:39:31.924095 [error] [MainThread]:            +- 'UnresolvedRelation [data_source, organizations], [], false
[0m18:39:31.924095 [error] [MainThread]:   
[0m18:39:31.924095 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m18:39:31.924095 [info ] [MainThread]: 
[0m18:39:31.924095 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:39:31.924095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220932CE430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220939ABF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220939ABD00>]}
[0m18:39:31.924095 [debug] [MainThread]: Flushing usage events
[0m18:39:32.880875 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 05:53:29.771153 | 54982604-3bf4-44b7-8017-fa0c2540a824 ==============================
[0m05:53:29.771153 [info ] [MainThread]: Running with dbt=1.4.6
[0m05:53:29.771153 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:53:29.771153 [debug] [MainThread]: Tracking: tracking
[0m05:53:29.802719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA317C24F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA317C2C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA317C27F0>]}
[0m05:53:29.832256 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m05:53:30.456873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:53:30.456873 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m05:53:30.472492 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m05:53:30.503738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54982604-3bf4-44b7-8017-fa0c2540a824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E304760>]}
[0m05:53:30.503738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54982604-3bf4-44b7-8017-fa0c2540a824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3176FA00>]}
[0m05:53:30.503738 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m05:53:30.503738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54982604-3bf4-44b7-8017-fa0c2540a824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA3176FAC0>]}
[0m05:53:30.503738 [info ] [MainThread]: 
[0m05:53:30.503738 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m05:53:30.519362 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m05:53:30.519362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:30.519362 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m05:53:30.519362 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m05:53:30.519362 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m05:53:53.914864 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m05:53:53.914864 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eaf19cee-1016-4823-8534-e4625d5bd762
[0m05:54:02.476420 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m05:54:03.748372 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m05:54:03.748372 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m05:54:03.748372 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m05:54:03.748372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:03.748372 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m05:54:04.897775 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m05:54:04.897775 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m05:54:04.897775 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eaf19cee-1016-4823-8534-e4625d5bd762
[0m05:54:06.379600 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m05:54:07.577702 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m05:54:07.577702 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m05:54:07.577702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54982604-3bf4-44b7-8017-fa0c2540a824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E255F10>]}
[0m05:54:07.577702 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m05:54:07.577702 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m05:54:07.577702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:03:43.473907 [info ] [MainThread]: 
[0m06:03:43.491419 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:03:43.491761 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:03:43.492497 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:03:43.492698 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:03:43.495405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:03:43.495915 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 06:03:43.493022 => 2023-05-30 06:03:43.495915
[0m06:03:43.496527 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:03:43.497028 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:03:43.497028 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:03:44.776263 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:03:44.776263 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:03:44.776263 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eaf19cee-1016-4823-8534-e4625d5bd762
[0m06:03:46.278437 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:03:47.433039 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:03:47.455382 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:03:47.455382 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:03:47.455382 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:03:47.455382 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:03:49.598371 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685426627586, 'CompletedOn': 1685426628226}, 'ResponseMetadata': {'RequestId': 'b716942f-bd51-406a-9e98-b3561e159b41', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:03:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': 'b716942f-bd51-406a-9e98-b3561e159b41'}, 'RetryAttempts': 0}}
[0m06:03:49.598371 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:03:49.598371 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:03:56.319139 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:03:56.319139 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:03:56.319139 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:03:56.319139 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:03:56.319139 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:03:56.323511 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:03:56.324074 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 06:03:43.496527 => 2023-05-30 06:03:56.323570
[0m06:03:56.388168 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:03:56.388168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54982604-3bf4-44b7-8017-fa0c2540a824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E255F10>]}
[0m06:03:56.388168 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 12.90s]
[0m06:03:56.388168 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:03:56.388168 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:03:56.388168 [debug] [MainThread]: On master: ROLLBACK
[0m06:03:56.388168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:56.388168 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:03:57.559817 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:03:57.559817 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:03:57.559817 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eaf19cee-1016-4823-8534-e4625d5bd762
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:03:59.039162 [debug] [MainThread]: On master: ROLLBACK
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:03:59.039162 [debug] [MainThread]: On master: Close
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:03:59.039162 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:03:59.514611 [info ] [MainThread]: 
[0m06:03:59.514611 [info ] [MainThread]: Finished running 1 table model in 0 hours 10 minutes and 29.01 seconds (629.01s).
[0m06:03:59.529489 [debug] [MainThread]: Command end result
[0m06:03:59.530526 [info ] [MainThread]: 
[0m06:03:59.530526 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:03:59.530526 [info ] [MainThread]: 
[0m06:03:59.530526 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:03:59.530526 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:03:59.530526 [error] [MainThread]:   
[0m06:03:59.530526 [error] [MainThread]:     
[0m06:03:59.530526 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:03:59.530526 [error] [MainThread]:     using PARQUET
[0m06:03:59.530526 [error] [MainThread]:   	
[0m06:03:59.530526 [error] [MainThread]:   	
[0m06:03:59.530526 [error] [MainThread]:   	
[0m06:03:59.530526 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m06:03:59.530526 [error] [MainThread]:   	
[0m06:03:59.530526 [error] [MainThread]:   	as
[0m06:03:59.530526 [error] [MainThread]:   	with org as (
[0m06:03:59.530526 [error] [MainThread]:   select 
[0m06:03:59.530526 [error] [MainThread]:   name, classification
[0m06:03:59.530526 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:03:59.530526 [error] [MainThread]:   )
[0m06:03:59.530526 [error] [MainThread]:   select name, classification
[0m06:03:59.530526 [error] [MainThread]:   from org
[0m06:03:59.530526 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:03:59.530526 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:03:59.530526 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m06:03:59.546166 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:03:59.546166 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:03:59.550674 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:03:59.550674 [error] [MainThread]:   
[0m06:03:59.550674 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:03:59.550674 [info ] [MainThread]: 
[0m06:03:59.550674 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:03:59.550674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F7F67C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA30307940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA303073D0>]}
[0m06:03:59.550674 [debug] [MainThread]: Flushing usage events
[0m06:04:00.504061 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 06:04:17.113506 | 3ce82044-fb26-4f73-a715-3c2b6e356e0a ==============================
[0m06:04:17.113506 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:04:17.113506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m06:04:17.113506 [debug] [MainThread]: Tracking: tracking
[0m06:04:17.154219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC5EBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC6707C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC670340>]}
[0m06:04:17.154219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC5EBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC6708E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AC670490>]}
[0m06:04:17.154219 [debug] [MainThread]: Flushing usage events


============================== 2023-05-30 06:04:32.748107 | ec728a47-4b2d-411a-acf9-f32295423dac ==============================
[0m06:04:32.748107 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:04:32.748107 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:04:32.748107 [debug] [MainThread]: Tracking: tracking
[0m06:04:32.763726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E8225E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E822CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E8228B0>]}
[0m06:04:32.795260 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:04:32.795260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:04:32.795260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E7C7040>]}
[0m06:04:33.958680 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m06:04:34.010636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E9CE8B0>]}
[0m06:04:34.018755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E91F7C0>]}
[0m06:04:34.018755 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:04:34.018755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E7C7190>]}
[0m06:04:34.018755 [info ] [MainThread]: 
[0m06:04:34.018755 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:04:34.018755 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:04:34.018755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:04:34.018755 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:04:34.018755 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:04:34.018755 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:04:51.868013 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:04:51.868013 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-92b94c6a-a87a-40b8-8ee3-080873360f7b
[0m06:04:58.946253 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:05:00.235172 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:05:00.235172 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:05:00.235172 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:05:00.235172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:00.235172 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:05:01.401938 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:05:01.401938 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:05:01.401938 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-92b94c6a-a87a-40b8-8ee3-080873360f7b
[0m06:05:03.061543 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:05:04.227542 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:05:04.227542 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:05:04.227542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E9CE790>]}
[0m06:05:04.227542 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:05:04.227542 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:05:04.227542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:04.227542 [info ] [MainThread]: 
[0m06:05:04.243076 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:05:04.243076 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:05:04.249588 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:05:04.249588 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:05:04.249588 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:05:04.258115 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 06:05:04.249588 => 2023-05-30 06:05:04.258115
[0m06:05:04.258115 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:05:04.258115 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:05:04.258115 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:05:05.416792 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:05:05.416792 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:05:05.416792 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-92b94c6a-a87a-40b8-8ee3-080873360f7b
[0m06:05:06.874867 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:05:08.011976 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:05:08.043229 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:05:08.043229 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:05:08.056093 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:05:08.056093 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:05:08.056093 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  ''')
[0m06:05:10.134980 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\twith org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect name, classification\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project ['name, 'classification]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685426708233, 'CompletedOn': 1685426708659}, 'ResponseMetadata': {'RequestId': '3d8cb99b-4423-4499-877e-449d5d6ff43b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:05:09 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2028', 'connection': 'keep-alive', 'x-amzn-requestid': '3d8cb99b-4423-4499-877e-449d5d6ff43b'}, 'RetryAttempts': 0}}
[0m06:05:10.150597 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:05:10.150597 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:05:10.150597 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project ['name, 'classification]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:05:10.150597 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	with org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select name, classification
from org
  
[0m06:05:10.150597 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:05:10.150597 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:05:10.150597 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:05:10.150597 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:05:10.150597 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 06:05:04.258115 => 2023-05-30 06:05:10.150597
[0m06:05:10.150597 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	with org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select name, classification
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project ['name, 'classification]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:05:10.150597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec728a47-4b2d-411a-acf9-f32295423dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608F036F70>]}
[0m06:05:10.150597 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.91s]
[0m06:05:10.150597 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:05:10.150597 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:05:10.150597 [debug] [MainThread]: On master: ROLLBACK
[0m06:05:10.150597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:10.150597 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:05:11.303483 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:05:11.303483 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:05:11.303483 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-92b94c6a-a87a-40b8-8ee3-080873360f7b
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:05:12.689155 [debug] [MainThread]: On master: ROLLBACK
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:05:12.689155 [debug] [MainThread]: On master: Close
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:05:12.689155 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:05:13.151945 [info ] [MainThread]: 
[0m06:05:13.167568 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.13 seconds (39.13s).
[0m06:05:13.167568 [debug] [MainThread]: Command end result
[0m06:05:13.174167 [info ] [MainThread]: 
[0m06:05:13.174167 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:05:13.174167 [info ] [MainThread]: 
[0m06:05:13.174167 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:05:13.174167 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:05:13.174167 [error] [MainThread]:   
[0m06:05:13.174167 [error] [MainThread]:     
[0m06:05:13.174167 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:05:13.174167 [error] [MainThread]:     using PARQUET
[0m06:05:13.174167 [error] [MainThread]:   	
[0m06:05:13.174167 [error] [MainThread]:   	
[0m06:05:13.174167 [error] [MainThread]:   	
[0m06:05:13.174167 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m06:05:13.174167 [error] [MainThread]:   	
[0m06:05:13.174167 [error] [MainThread]:   	as
[0m06:05:13.174167 [error] [MainThread]:   	with org as (
[0m06:05:13.174167 [error] [MainThread]:   select 
[0m06:05:13.174167 [error] [MainThread]:   name, classification
[0m06:05:13.174167 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:05:13.174167 [error] [MainThread]:   )
[0m06:05:13.174167 [error] [MainThread]:   select name, classification
[0m06:05:13.174167 [error] [MainThread]:   from org
[0m06:05:13.189802 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:05:13.189802 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:05:13.189802 [error] [MainThread]:   +- 'Project ['name, 'classification]
[0m06:05:13.189802 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:05:13.189802 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:05:13.189802 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:05:13.189802 [error] [MainThread]:   
[0m06:05:13.189802 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:05:13.189802 [info ] [MainThread]: 
[0m06:05:13.189802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:05:13.189802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608E880EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608B25E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608B25E580>]}
[0m06:05:13.189802 [debug] [MainThread]: Flushing usage events
[0m06:05:14.063858 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 06:22:06.251866 | d6bb0085-09b8-492b-837e-808adc6c5f72 ==============================
[0m06:22:06.251866 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:22:06.251866 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m06:22:06.251866 [debug] [MainThread]: Tracking: tracking
[0m06:22:06.297142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23F6CBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2407217F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D240721340>]}
[0m06:22:06.297142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23F6CBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D240721910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D240721520>]}
[0m06:22:06.297142 [debug] [MainThread]: Flushing usage events


============================== 2023-05-30 06:22:11.895855 | fb3f419a-8957-439a-b9bc-ae86f3c36f4c ==============================
[0m06:22:11.895855 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:22:11.895855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:22:11.895855 [debug] [MainThread]: Tracking: tracking
[0m06:22:11.912711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355DE24F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355DE2C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355DE2820>]}
[0m06:22:11.945141 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:22:11.945141 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:22:11.945141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355D87160>]}
[0m06:22:13.114449 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m06:22:13.171239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355F7D850>]}
[0m06:22:13.180556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355EDF760>]}
[0m06:22:13.180556 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:22:13.181556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355D87130>]}
[0m06:22:13.184566 [info ] [MainThread]: 
[0m06:22:13.186567 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:22:13.189557 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:22:13.189557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:13.189557 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:22:13.189557 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:22:13.189557 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:22:35.801769 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:22:35.802698 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-dcc3819b-4d50-49a6-85bf-372cd7c7359e
[0m06:22:45.819888 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:22:47.083972 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:22:47.083972 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:22:47.087250 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:22:47.088259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:47.088259 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:22:48.279647 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:22:48.279647 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:22:48.279647 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-dcc3819b-4d50-49a6-85bf-372cd7c7359e
[0m06:22:49.820527 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:22:50.993925 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:22:50.994945 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:22:50.996928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355F7D910>]}
[0m06:22:50.996928 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:22:50.997999 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:22:50.999006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:22:50.999928 [info ] [MainThread]: 
[0m06:22:51.010534 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:22:51.011557 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:22:51.012556 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:22:51.012556 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:22:51.018637 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:22:51.024899 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 06:22:51.012556 => 2023-05-30 06:22:51.024899
[0m06:22:51.025899 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:22:51.045971 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:22:51.046900 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:22:52.274040 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:22:52.274040 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:22:52.274040 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-dcc3819b-4d50-49a6-85bf-372cd7c7359e
[0m06:22:53.776970 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:22:55.063378 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:22:55.078998 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:22:55.094621 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:22:55.094621 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:22:55.094621 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:22:55.094621 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  ''')
[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect *\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685427775225, 'CompletedOn': 1685427775864}, 'ResponseMetadata': {'RequestId': '22aab5a8-89c7-4bd7-9384-6f920f0ae8aa', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:22:56 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1967', 'connection': 'keep-alive', 'x-amzn-requestid': '22aab5a8-89c7-4bd7-9384-6f920f0ae8aa'}, 'RetryAttempts': 0}}
[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:22:57.216295 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:22:57.216295 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:22:57.216295 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:22:57.216295 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:22:57.216295 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 06:22:51.026899 => 2023-05-30 06:22:57.216295
[0m06:22:57.285336 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select *
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:22:57.285336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb3f419a-8957-439a-b9bc-ae86f3c36f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355E77C10>]}
[0m06:22:57.285336 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 6.27s]
[0m06:22:57.285336 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:22:57.285336 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:22:57.285336 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:57.285336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:57.285336 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:22:58.472737 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:22:58.472737 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:22:58.472737 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-dcc3819b-4d50-49a6-85bf-372cd7c7359e
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:22:59.921685 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:22:59.921685 [debug] [MainThread]: On master: Close
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:22:59.921685 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:23:00.375438 [info ] [MainThread]: 
[0m06:23:00.375438 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.19 seconds (47.19s).
[0m06:23:00.375438 [debug] [MainThread]: Command end result
[0m06:23:00.394866 [info ] [MainThread]: 
[0m06:23:00.394866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:23:00.394866 [info ] [MainThread]: 
[0m06:23:00.394866 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:23:00.394866 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:23:00.394866 [error] [MainThread]:   
[0m06:23:00.394866 [error] [MainThread]:     
[0m06:23:00.394866 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:23:00.394866 [error] [MainThread]:     using PARQUET
[0m06:23:00.394866 [error] [MainThread]:   	
[0m06:23:00.394866 [error] [MainThread]:   	
[0m06:23:00.394866 [error] [MainThread]:   	
[0m06:23:00.394866 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m06:23:00.394866 [error] [MainThread]:   	
[0m06:23:00.394866 [error] [MainThread]:   	as
[0m06:23:00.394866 [error] [MainThread]:   	WITH org as (
[0m06:23:00.394866 [error] [MainThread]:   select 
[0m06:23:00.394866 [error] [MainThread]:   name, classification
[0m06:23:00.394866 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:23:00.394866 [error] [MainThread]:   )
[0m06:23:00.394866 [error] [MainThread]:   select *
[0m06:23:00.394866 [error] [MainThread]:   from org
[0m06:23:00.394866 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:23:00.394866 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:23:00.394866 [error] [MainThread]:   +- 'Project [*]
[0m06:23:00.394866 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:23:00.394866 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:23:00.394866 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:23:00.394866 [error] [MainThread]:   
[0m06:23:00.394866 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:23:00.410641 [info ] [MainThread]: 
[0m06:23:00.410641 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:23:00.410641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355E9EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002035281DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002035281DE50>]}
[0m06:23:00.410641 [debug] [MainThread]: Flushing usage events
[0m06:23:01.293102 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 06:28:16.668669 | d5468a98-7f2d-4e31-89d0-3e33206eab0e ==============================
[0m06:28:16.668669 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:28:16.668669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m06:28:16.668669 [debug] [MainThread]: Tracking: tracking
[0m06:28:16.705271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1161BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B116A2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B116A2400>]}
[0m06:28:16.723531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1161BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B116A2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B116A2520>]}
[0m06:28:16.723531 [debug] [MainThread]: Flushing usage events


============================== 2023-05-30 06:28:22.684378 | 159e4e32-4792-4e4e-8ad1-b43f70a6fcab ==============================
[0m06:28:22.684378 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:28:22.684378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:28:22.684378 [debug] [MainThread]: Tracking: tracking
[0m06:28:22.721563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147CD3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147CD3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147CD37C0>]}
[0m06:28:22.736589 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:28:22.736589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:28:22.736589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147C77160>]}
[0m06:28:24.605444 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m06:28:24.668488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147E41610>]}
[0m06:28:24.668488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147DCE760>]}
[0m06:28:24.668488 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:28:24.668488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147C77220>]}
[0m06:28:24.668488 [info ] [MainThread]: 
[0m06:28:24.668488 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:28:24.668488 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:28:24.668488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:24.684166 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:28:24.684166 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:28:24.684166 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:28:48.094531 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:28:48.094531 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bdb68dea-9e90-4525-b719-92a8df37b9f4
[0m06:28:56.824581 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:28:58.146419 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:28:58.146419 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:28:58.149389 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:28:58.150394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:58.150394 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:28:59.276721 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:28:59.276721 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:28:59.277945 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bdb68dea-9e90-4525-b719-92a8df37b9f4
[0m06:29:00.713995 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:29:01.833897 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:29:01.833897 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:29:01.835642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147E414F0>]}
[0m06:29:01.835642 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:29:01.835642 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:29:01.835642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:29:01.836817 [info ] [MainThread]: 
[0m06:29:01.845255 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:29:01.846289 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:29:01.847293 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:29:01.847293 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:29:01.850383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:29:01.853581 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 06:29:01.847293 => 2023-05-30 06:29:01.853581
[0m06:29:01.853581 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:29:01.860219 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:29:01.860219 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:29:02.991174 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:29:02.991174 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:29:02.991174 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bdb68dea-9e90-4525-b719-92a8df37b9f4
[0m06:29:04.377642 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:29:05.539207 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:29:05.571697 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:29:05.575776 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:29:05.577383 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:29:05.577889 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:29:05.578388 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:29:05.578388 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:29:05.578388 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:29:05.578388 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:29:05.578388 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:29:05.578388 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  ''')
[0m06:29:07.664132 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect *\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 6, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685428145681, 'CompletedOn': 1685428146218}, 'ResponseMetadata': {'RequestId': 'af0b58b6-086d-4b91-93bb-679721bfdd2c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:29:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1967', 'connection': 'keep-alive', 'x-amzn-requestid': 'af0b58b6-086d-4b91-93bb-679721bfdd2c'}, 'RetryAttempts': 0}}
[0m06:29:07.664132 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:29:07.673699 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:29:07.673699 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:29:07.673699 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:29:07.673699 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:29:07.673699 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:29:07.673699 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:29:07.673699 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:29:07.673699 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 06:29:01.854764 => 2023-05-30 06:29:07.673699
[0m06:29:07.736001 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select *
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:29:07.736001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159e4e32-4792-4e4e-8ad1-b43f70a6fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714781ED30>]}
[0m06:29:07.736925 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 5.89s]
[0m06:29:07.737927 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:29:07.738926 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:29:07.740008 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:07.740008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:07.740008 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:29:08.959719 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:29:08.959719 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:29:08.959719 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-bdb68dea-9e90-4525-b719-92a8df37b9f4
[0m06:29:10.374121 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:29:10.383913 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:29:10.383913 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:29:10.383913 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:10.383913 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:29:10.383913 [debug] [MainThread]: On master: Close
[0m06:29:10.383913 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:29:10.383913 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:29:10.835500 [info ] [MainThread]: 
[0m06:29:10.835500 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 46.17 seconds (46.17s).
[0m06:29:10.837464 [debug] [MainThread]: Command end result
[0m06:29:10.843457 [info ] [MainThread]: 
[0m06:29:10.844610 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:29:10.844610 [info ] [MainThread]: 
[0m06:29:10.845610 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:29:10.845610 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:29:10.846313 [error] [MainThread]:   
[0m06:29:10.846683 [error] [MainThread]:     
[0m06:29:10.847103 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:29:10.847103 [error] [MainThread]:     using PARQUET
[0m06:29:10.847103 [error] [MainThread]:   	
[0m06:29:10.848105 [error] [MainThread]:   	
[0m06:29:10.848105 [error] [MainThread]:   	
[0m06:29:10.848105 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m06:29:10.849104 [error] [MainThread]:   	
[0m06:29:10.849104 [error] [MainThread]:   	as
[0m06:29:10.849104 [error] [MainThread]:   	WITH org as (
[0m06:29:10.850105 [error] [MainThread]:   select 
[0m06:29:10.850105 [error] [MainThread]:   name, classification
[0m06:29:10.850105 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:29:10.851104 [error] [MainThread]:   )
[0m06:29:10.851104 [error] [MainThread]:   select *
[0m06:29:10.851104 [error] [MainThread]:   from org
[0m06:29:10.852104 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:29:10.852104 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:29:10.852104 [error] [MainThread]:   +- 'Project [*]
[0m06:29:10.853104 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:29:10.853104 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:29:10.853104 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:29:10.854104 [error] [MainThread]:   
[0m06:29:10.854104 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:29:10.854104 [info ] [MainThread]: 
[0m06:29:10.855236 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:29:10.855236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027147D8D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714470ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714470EEB0>]}
[0m06:29:10.855236 [debug] [MainThread]: Flushing usage events
[0m06:29:11.865343 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 06:49:05.260983 | 4eb0be29-a38a-4fd7-af07-09b4014671b3 ==============================
[0m06:49:05.260983 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:49:05.261982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:49:05.261982 [debug] [MainThread]: Tracking: tracking
[0m06:49:05.304715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA03D0AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0447430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA0447E20>]}
[0m06:49:05.541185 [debug] [MainThread]: Executing "git --help"
[0m06:49:05.580904 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:49:05.580904 [debug] [MainThread]: STDERR: "b''"
[0m06:49:05.600318 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m06:49:05.601330 [debug] [MainThread]: Using glue connection "debug"
[0m06:49:05.601330 [debug] [MainThread]: On debug: select 1 as id
[0m06:49:05.601330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:05.601330 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:49:05.601330 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m06:49:05.601330 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m06:49:23.709826 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:49:23.710822 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-ffaed731-94b1-4d56-a196-2c33ca7efe1c
[0m06:49:33.477447 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m06:49:33.478446 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m06:49:33.478446 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m06:49:33.479445 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:49:33.479445 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m06:49:40.855567 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685429373581, 'CompletedOn': 1685429379431}, 'ResponseMetadata': {'RequestId': 'cad50485-7b67-4e7f-8a5c-096d0d64b99c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:49:40 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': 'cad50485-7b67-4e7f-8a5c-096d0d64b99c'}, 'RetryAttempts': 0}}
[0m06:49:40.855567 [debug] [MainThread]: Glue adapter: status = ok
[0m06:49:40.855567 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m06:49:40.855567 [debug] [MainThread]: SQL status: OK in 35 seconds
[0m06:49:40.856566 [debug] [MainThread]: On debug: Close
[0m06:49:40.856566 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:49:40.858568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA18D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA1E9EA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EA1E9E790>]}
[0m06:49:40.859497 [debug] [MainThread]: Flushing usage events
[0m06:49:41.903104 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 06:49:58.360628 | c4d492d0-8ea9-46fd-81d8-aa46479b89ef ==============================
[0m06:49:58.360628 [info ] [MainThread]: Running with dbt=1.4.6
[0m06:49:58.362626 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:49:58.362626 [debug] [MainThread]: Tracking: tracking
[0m06:49:58.393173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A88F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A88FD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744A88F910>]}
[0m06:49:58.415253 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m06:49:59.445468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:49:59.446469 [debug] [MainThread]: Partial parsing: updated file: dbt_spark://macros\materializations\table.sql
[0m06:49:59.510381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d492d0-8ea9-46fd-81d8-aa46479b89ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744738ADC0>]}
[0m06:49:59.516660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d492d0-8ea9-46fd-81d8-aa46479b89ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744732E550>]}
[0m06:49:59.516660 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m06:49:59.516660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d492d0-8ea9-46fd-81d8-aa46479b89ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744732E640>]}
[0m06:49:59.517666 [info ] [MainThread]: 
[0m06:49:59.519669 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:49:59.521667 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m06:49:59.521667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:49:59.522668 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:49:59.522668 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m06:49:59.522668 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m06:50:16.906500 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:50:16.906500 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5ea1802a-3bbd-47a9-8535-2e0284d6764d
[0m06:50:23.815587 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:50:25.100616 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m06:50:25.101617 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:50:25.104616 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m06:50:25.104616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:25.105616 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m06:50:26.213389 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m06:50:26.214390 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m06:50:26.214390 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5ea1802a-3bbd-47a9-8535-2e0284d6764d
[0m06:50:27.612994 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m06:50:28.787692 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m06:50:28.788619 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m06:50:28.789618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d492d0-8ea9-46fd-81d8-aa46479b89ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744732E310>]}
[0m06:50:28.790691 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:50:28.790691 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:50:28.791689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:50:28.791689 [info ] [MainThread]: 
[0m06:50:28.802634 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m06:50:28.802634 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m06:50:28.803634 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m06:50:28.803634 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m06:50:28.805634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m06:50:28.806634 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 06:50:28.803634 => 2023-05-30 06:50:28.806634
[0m06:50:28.807634 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m06:50:28.820984 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:50:28.820984 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m06:50:29.997416 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m06:50:29.998417 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m06:50:29.998417 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5ea1802a-3bbd-47a9-8535-2e0284d6764d
[0m06:50:31.458212 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:50:32.602331 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:50:32.618331 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:50:33.759417 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m06:50:33.760417 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:50:33.760417 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test
[0m06:50:33.761417 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:50:33.761417 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:50:33.761417 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:50:33.761417 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:50:33.761417 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test''')
[0m06:50:38.583613 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685429433847, 'CompletedOn': 1685429437599}, 'ResponseMetadata': {'RequestId': 'fc24988e-087c-46e1-b67f-b06b133e79b5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:50:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'fc24988e-087c-46e1-b67f-b06b133e79b5'}, 'RetryAttempts': 0}}
[0m06:50:38.584652 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m06:50:38.584652 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m06:50:38.584652 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685429433847, 'CompletedOn': 1685429437599}, 'ResponseMetadata': {'RequestId': 'fc24988e-087c-46e1-b67f-b06b133e79b5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:50:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'fc24988e-087c-46e1-b67f-b06b133e79b5'}, 'RetryAttempts': 0}}
[0m06:50:38.584652 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m06:50:38.584652 [debug] [Thread-1  ]: SQL status: OK in 5 seconds
[0m06:50:38.606074 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:50:38.610132 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m06:50:38.611137 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m06:50:38.611137 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m06:50:38.611137 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:50:38.612070 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m06:50:38.612070 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m06:50:38.612070 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m06:50:38.612070 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m06:50:38.612070 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  ''')
[0m06:50:40.710499 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 7, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect *\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 7, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685429438726, 'CompletedOn': 1685429439240}, 'ResponseMetadata': {'RequestId': '372e14b7-a896-46d4-a350-18e0007df68c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 06:50:40 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1967', 'connection': 'keep-alive', 'x-amzn-requestid': '372e14b7-a896-46d4-a350-18e0007df68c'}, 'RetryAttempts': 0}}
[0m06:50:40.710499 [debug] [Thread-1  ]: Glue adapter: status = error
[0m06:50:40.711495 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:50:40.711495 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m06:50:40.712423 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m06:50:40.712423 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m06:50:40.712423 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m06:50:40.712423 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m06:50:40.712423 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m06:50:40.712423 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 06:50:28.807634 => 2023-05-30 06:50:40.712423
[0m06:50:40.736140 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select *
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:50:40.736140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d492d0-8ea9-46fd-81d8-aa46479b89ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744B615AF0>]}
[0m06:50:40.737147 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 11.93s]
[0m06:50:40.738295 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m06:50:40.739834 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m06:50:40.739834 [debug] [MainThread]: On master: ROLLBACK
[0m06:50:40.740342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:50:40.740342 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m06:50:41.889278 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m06:50:41.889278 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m06:50:41.889278 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-5ea1802a-3bbd-47a9-8535-2e0284d6764d
[0m06:50:43.308161 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:50:43.309283 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m06:50:43.309283 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m06:50:43.309283 [debug] [MainThread]: On master: ROLLBACK
[0m06:50:43.310327 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m06:50:43.310543 [debug] [MainThread]: On master: Close
[0m06:50:43.310543 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m06:50:43.310543 [debug] [MainThread]: Glue adapter: cleanup called
[0m06:50:43.728666 [info ] [MainThread]: 
[0m06:50:43.728666 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 44.21 seconds (44.21s).
[0m06:50:43.732662 [debug] [MainThread]: Command end result
[0m06:50:43.738666 [info ] [MainThread]: 
[0m06:50:43.739668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:50:43.740661 [info ] [MainThread]: 
[0m06:50:43.740661 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m06:50:43.740661 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m06:50:43.741662 [error] [MainThread]:   
[0m06:50:43.741662 [error] [MainThread]:     
[0m06:50:43.742661 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m06:50:43.742661 [error] [MainThread]:     using PARQUET
[0m06:50:43.742661 [error] [MainThread]:   	
[0m06:50:43.743661 [error] [MainThread]:   	
[0m06:50:43.743661 [error] [MainThread]:   	
[0m06:50:43.743661 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt/poc_curated_dbt/spark_sql_test/'
[0m06:50:43.744661 [error] [MainThread]:   	
[0m06:50:43.744661 [error] [MainThread]:   	as
[0m06:50:43.745661 [error] [MainThread]:   	WITH org as (
[0m06:50:43.745661 [error] [MainThread]:   select 
[0m06:50:43.745661 [error] [MainThread]:   name, classification
[0m06:50:43.746661 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m06:50:43.746661 [error] [MainThread]:   )
[0m06:50:43.746661 [error] [MainThread]:   select *
[0m06:50:43.748300 [error] [MainThread]:   from org
[0m06:50:43.753328 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m06:50:43.754318 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m06:50:43.755319 [error] [MainThread]:   +- 'Project [*]
[0m06:50:43.755319 [error] [MainThread]:      +- 'SubqueryAlias org
[0m06:50:43.755319 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m06:50:43.756318 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m06:50:43.756318 [error] [MainThread]:   
[0m06:50:43.756318 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m06:50:43.756318 [info ] [MainThread]: 
[0m06:50:43.757317 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:50:43.757317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744B693070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744B778220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744B778E50>]}
[0m06:50:43.757317 [debug] [MainThread]: Flushing usage events
[0m06:50:44.727647 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 07:29:21.950180 | 6fab4006-c2a5-41ac-af76-9ba3b819bf44 ==============================
[0m07:29:21.950180 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:29:21.950180 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:29:21.950180 [debug] [MainThread]: Tracking: tracking
[0m07:29:21.992951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C1D2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C1D2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C1D27C0>]}
[0m07:29:22.009133 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m07:29:22.024760 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:29:22.024760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C1D28E0>]}
[0m07:29:23.246905 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m07:29:23.295919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908D13F10>]}
[0m07:29:23.306288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C1842B0>]}
[0m07:29:23.306288 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m07:29:23.306288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908CF1520>]}
[0m07:29:23.306288 [info ] [MainThread]: 
[0m07:29:23.306288 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:29:23.306288 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m07:29:23.314308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:23.314308 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:29:23.314308 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m07:29:23.314308 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m07:29:58.508693 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:29:58.508693 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-08ebda3e-fcfa-4fa3-af4f-c74187f8d2c8
[0m07:30:07.112202 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:30:08.340419 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:30:08.340419 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:30:08.345355 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:30:08.346352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:08.346352 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:30:09.467083 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:30:09.467083 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:30:09.467083 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-08ebda3e-fcfa-4fa3-af4f-c74187f8d2c8
[0m07:30:10.941644 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:30:12.142425 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:30:12.142425 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:30:12.144726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C507580>]}
[0m07:30:12.144726 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:30:12.144726 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:30:12.144726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:12.144726 [info ] [MainThread]: 
[0m07:30:12.161249 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:30:12.161249 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:30:12.161249 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:30:12.161249 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:30:12.161249 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:30:12.161249 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 07:30:12.161249 => 2023-05-30 07:30:12.161249
[0m07:30:12.161249 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:30:12.193279 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:30:12.194175 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m07:30:13.336877 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m07:30:13.337877 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m07:30:13.338877 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-08ebda3e-fcfa-4fa3-af4f-c74187f8d2c8
[0m07:30:14.856304 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:30:16.147005 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:30:16.176813 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:30:17.447665 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:30:17.448651 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:30:17.448651 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test
[0m07:30:17.449734 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:30:17.449734 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:30:17.449734 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:30:17.449734 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:30:17.449734 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test''')
[0m07:30:22.171473 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685431817552, 'CompletedOn': 1685431821340}, 'ResponseMetadata': {'RequestId': 'bf3a305f-4fa9-4856-84d0-8f75edc247c9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:30:21 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'bf3a305f-4fa9-4856-84d0-8f75edc247c9'}, 'RetryAttempts': 0}}
[0m07:30:22.172543 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m07:30:22.172543 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m07:30:22.173542 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685431817552, 'CompletedOn': 1685431821340}, 'ResponseMetadata': {'RequestId': 'bf3a305f-4fa9-4856-84d0-8f75edc247c9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:30:21 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'bf3a305f-4fa9-4856-84d0-8f75edc247c9'}, 'RetryAttempts': 0}}
[0m07:30:22.173542 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m07:30:22.174546 [debug] [Thread-1  ]: SQL status: OK in 5 seconds
[0m07:30:22.241516 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:30:22.249524 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:30:22.250514 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m07:30:22.251442 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:30:22.251442 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m07:30:22.251442 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:30:22.252585 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:30:22.252585 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:30:22.253597 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:30:22.253597 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  ''')
[0m07:30:24.320576 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 7, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_normalized_legislator.organizations\n)\nselect *\nfrom org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 7, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685431822348, 'CompletedOn': 1685431822898}, 'ResponseMetadata': {'RequestId': '4049a0e0-5cb6-49b4-943a-5c884f26c773', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:30:24 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1968', 'connection': 'keep-alive', 'x-amzn-requestid': '4049a0e0-5cb6-49b4-943a-5c884f26c773'}, 'RetryAttempts': 0}}
[0m07:30:24.321621 [debug] [Thread-1  ]: Glue adapter: status = error
[0m07:30:24.322617 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:30:24.323545 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false

[0m07:30:24.324585 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_normalized_legislator.organizations
)
select *
from org
  
[0m07:30:24.324585 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:30:24.325613 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m07:30:24.325613 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:30:24.325613 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m07:30:24.326629 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 07:30:12.174562 => 2023-05-30 07:30:24.326629
[0m07:30:24.394881 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_normalized_legislator.organizations
  )
  select *
  from org
    '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:30:24.394881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fab4006-c2a5-41ac-af76-9ba3b819bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090C25A640>]}
[0m07:30:24.395954 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 12.23s]
[0m07:30:24.396882 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:30:24.398881 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:30:24.398881 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:24.399959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:24.399959 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:30:25.578206 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:30:25.585179 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:30:25.585679 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-08ebda3e-fcfa-4fa3-af4f-c74187f8d2c8
[0m07:30:26.973313 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:30:26.973313 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:30:26.973313 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:30:26.975332 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:26.975332 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:30:26.975332 [debug] [MainThread]: On master: Close
[0m07:30:26.975332 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:30:26.975332 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:30:27.423998 [info ] [MainThread]: 
[0m07:30:27.423998 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 4.12 seconds (64.12s).
[0m07:30:27.440702 [debug] [MainThread]: Command end result
[0m07:30:27.440702 [info ] [MainThread]: 
[0m07:30:27.440702 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:30:27.440702 [info ] [MainThread]: 
[0m07:30:27.440702 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:30:27.440702 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:30:27.440702 [error] [MainThread]:   
[0m07:30:27.440702 [error] [MainThread]:     
[0m07:30:27.440702 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:30:27.456722 [error] [MainThread]:     using PARQUET
[0m07:30:27.456722 [error] [MainThread]:   	
[0m07:30:27.456722 [error] [MainThread]:   	
[0m07:30:27.456722 [error] [MainThread]:   	
[0m07:30:27.456722 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
[0m07:30:27.456722 [error] [MainThread]:   	
[0m07:30:27.456722 [error] [MainThread]:   	as
[0m07:30:27.456722 [error] [MainThread]:   	WITH org as (
[0m07:30:27.456722 [error] [MainThread]:   select 
[0m07:30:27.456722 [error] [MainThread]:   name, classification
[0m07:30:27.456722 [error] [MainThread]:   from poc_normalized_legislator.organizations
[0m07:30:27.456722 [error] [MainThread]:   )
[0m07:30:27.456722 [error] [MainThread]:   select *
[0m07:30:27.456722 [error] [MainThread]:   from org
[0m07:30:27.456722 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_normalized_legislator.organizations; line 15 pos 5;
[0m07:30:27.456722 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:30:27.456722 [error] [MainThread]:   +- 'Project [*]
[0m07:30:27.456722 [error] [MainThread]:      +- 'SubqueryAlias org
[0m07:30:27.456722 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m07:30:27.456722 [error] [MainThread]:            +- 'UnresolvedRelation [poc_normalized_legislator, organizations], [], false
[0m07:30:27.456722 [error] [MainThread]:   
[0m07:30:27.456722 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:30:27.456722 [info ] [MainThread]: 
[0m07:30:27.456722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:30:27.456722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908C88D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CAE2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CAE2D90>]}
[0m07:30:27.456722 [debug] [MainThread]: Flushing usage events
[0m07:30:28.441953 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 07:33:54.707601 | 479f2780-4767-4afc-8751-49e97e9cc859 ==============================
[0m07:33:54.707601 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:33:54.707601 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:33:54.707601 [debug] [MainThread]: Tracking: tracking
[0m07:33:54.745361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0455F6EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0455F6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0455F6AC0>]}
[0m07:33:54.923799 [debug] [MainThread]: Executing "git --help"
[0m07:33:54.955886 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:33:54.955886 [debug] [MainThread]: STDERR: "b''"
[0m07:33:54.971620 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m07:33:54.971620 [debug] [MainThread]: Using glue connection "debug"
[0m07:33:54.971620 [debug] [MainThread]: On debug: select 1 as id
[0m07:33:54.971620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:54.971620 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:33:54.971620 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m07:33:54.971620 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m07:34:18.019585 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:34:18.019585 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-077d14fb-d24b-4f77-b18f-0b31cc959947
[0m07:34:27.857824 [debug] [MainThread]: Glue adapter: GlueConnection cursor called
[0m07:34:27.857824 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m07:34:27.857824 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m07:34:27.873330 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:34:27.873330 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m07:34:34.148525 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685432067966, 'CompletedOn': 1685432072992}, 'ResponseMetadata': {'RequestId': '2547328a-ff1a-4ea1-8afd-ba9f0849f2dc', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:34:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '398', 'connection': 'keep-alive', 'x-amzn-requestid': '2547328a-ff1a-4ea1-8afd-ba9f0849f2dc'}, 'RetryAttempts': 0}}
[0m07:34:34.148525 [debug] [MainThread]: Glue adapter: status = ok
[0m07:34:34.148525 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m07:34:34.148525 [debug] [MainThread]: SQL status: OK in 39 seconds
[0m07:34:34.164157 [debug] [MainThread]: On debug: Close
[0m07:34:34.164157 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:34:34.164157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045A51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D046080D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D046080B80>]}
[0m07:34:34.164157 [debug] [MainThread]: Flushing usage events
[0m07:34:35.068117 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 07:34:46.852115 | b6b8bb93-a836-43b8-92f0-cb2d4828c000 ==============================
[0m07:34:46.852115 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:34:46.852115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:34:46.852115 [debug] [MainThread]: Tracking: tracking
[0m07:34:46.883724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AE90F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AE90FCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AE90F850>]}
[0m07:34:46.899453 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m07:34:46.967888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:34:46.967888 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\source_tables.yml
[0m07:34:46.967888 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\schema.yml
[0m07:34:46.967888 [debug] [MainThread]: Partial parsing: updated file: dbtgluepoc://models\gold_metrics\spark_sql_test.sql
[0m07:34:46.983423 [debug] [MainThread]: 1699: static parser successfully parsed gold_metrics\spark_sql_test.sql
[0m07:34:47.014671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b8bb93-a836-43b8-92f0-cb2d4828c000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AB4549D0>]}
[0m07:34:47.014671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b8bb93-a836-43b8-92f0-cb2d4828c000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AE8BFA60>]}
[0m07:34:47.014671 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m07:34:47.014671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b8bb93-a836-43b8-92f0-cb2d4828c000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AE8BFB20>]}
[0m07:34:47.014671 [info ] [MainThread]: 
[0m07:34:47.030367 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:34:47.030367 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m07:34:47.030367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:47.030367 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:34:47.030367 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m07:34:47.030367 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m07:35:15.089059 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:35:15.089059 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-997d4f04-7fb7-4764-8984-e16ed86bea51
[0m07:35:23.416048 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:35:24.701411 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:35:24.701411 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:35:24.701411 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:35:24.701411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:24.701411 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:35:25.869911 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:35:25.871020 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:35:25.871020 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-997d4f04-7fb7-4764-8984-e16ed86bea51
[0m07:35:27.453443 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:35:28.682501 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:35:28.682501 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:35:28.683572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b8bb93-a836-43b8-92f0-cb2d4828c000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AB3A4FD0>]}
[0m07:35:28.683572 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:35:28.684578 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:35:28.684578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:53.763608 [info ] [MainThread]: 
[0m07:35:53.773079 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:35:53.773289 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:35:53.774211 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:35:53.774562 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:35:53.775261 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:35:53.775261 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 07:35:53.774562 => 2023-05-30 07:35:53.775261
[0m07:35:53.775261 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:35:53.782318 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:35:53.782318 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m07:35:54.963035 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m07:35:54.963035 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m07:35:54.963035 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-997d4f04-7fb7-4764-8984-e16ed86bea51
[0m07:35:56.497917 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:35:57.634172 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:35:57.672164 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:35:58.892218 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:35:58.892218 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:35:58.892218 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test''')
[0m07:36:02.376281 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685432159016, 'CompletedOn': 1685432161803}, 'ResponseMetadata': {'RequestId': '28b6db95-4992-4465-a2b1-a8eead4bf2d8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:36:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': '28b6db95-4992-4465-a2b1-a8eead4bf2d8'}, 'RetryAttempts': 0}}
[0m07:36:02.376281 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m07:36:02.377284 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m07:36:02.377284 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685432159016, 'CompletedOn': 1685432161803}, 'ResponseMetadata': {'RequestId': '28b6db95-4992-4465-a2b1-a8eead4bf2d8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:36:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': '28b6db95-4992-4465-a2b1-a8eead4bf2d8'}, 'RetryAttempts': 0}}
[0m07:36:02.377284 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m07:36:02.377284 [debug] [Thread-1  ]: SQL status: OK in 3 seconds
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:36:02.429493 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m07:36:02.429493 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:36:02.429493 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:36:02.429493 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  ''')
[0m07:36:04.512569 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 7, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_test.organizations\n)\nselect * from org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 7, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_test.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_test, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_test, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685432162544, 'CompletedOn': 1685432163035}, 'ResponseMetadata': {'RequestId': 'b314f4de-be9a-4b51-a3b7-afed61d715bb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:36:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1882', 'connection': 'keep-alive', 'x-amzn-requestid': 'b314f4de-be9a-4b51-a3b7-afed61d715bb'}, 'RetryAttempts': 0}}
[0m07:36:04.512569 [debug] [Thread-1  ]: Glue adapter: status = error
[0m07:36:04.512569 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_test, organizations], [], false

[0m07:36:04.528154 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_test, organizations], [], false

[0m07:36:04.528154 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  
[0m07:36:04.528154 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:36:04.528154 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m07:36:04.528154 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:36:04.528154 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m07:36:04.528154 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 07:35:53.775261 => 2023-05-30 07:36:04.528154
[0m07:36:04.528154 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_test.organizations
  )
  select * from org
    '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_test, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:36:04.528154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b8bb93-a836-43b8-92f0-cb2d4828c000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AB3ADBE0>]}
[0m07:36:04.528154 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 10.75s]
[0m07:36:04.528154 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:36:04.541479 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:36:04.541479 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:04.541479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:04.541479 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:36:05.767310 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:36:05.767310 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:36:05.767310 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-997d4f04-7fb7-4764-8984-e16ed86bea51
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:36:07.236230 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:36:07.236230 [debug] [MainThread]: On master: Close
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:36:07.236230 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:36:07.705169 [info ] [MainThread]: 
[0m07:36:07.705169 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 20.67 seconds (80.67s).
[0m07:36:07.720698 [debug] [MainThread]: Command end result
[0m07:36:07.720698 [info ] [MainThread]: 
[0m07:36:07.720698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:36:07.736319 [info ] [MainThread]: 
[0m07:36:07.736319 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:36:07.736319 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:36:07.736319 [error] [MainThread]:   
[0m07:36:07.736319 [error] [MainThread]:     
[0m07:36:07.736319 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:36:07.736319 [error] [MainThread]:     using PARQUET
[0m07:36:07.736319 [error] [MainThread]:   	
[0m07:36:07.736319 [error] [MainThread]:   	
[0m07:36:07.736319 [error] [MainThread]:   	
[0m07:36:07.736319 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
[0m07:36:07.736319 [error] [MainThread]:   	
[0m07:36:07.736319 [error] [MainThread]:   	as
[0m07:36:07.736319 [error] [MainThread]:   	WITH org as (
[0m07:36:07.736319 [error] [MainThread]:   select 
[0m07:36:07.736319 [error] [MainThread]:   name, classification
[0m07:36:07.736319 [error] [MainThread]:   from poc_test.organizations
[0m07:36:07.736319 [error] [MainThread]:   )
[0m07:36:07.736319 [error] [MainThread]:   select * from org
[0m07:36:07.736319 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
[0m07:36:07.736319 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:36:07.736319 [error] [MainThread]:   +- 'Project [*]
[0m07:36:07.736319 [error] [MainThread]:      +- 'SubqueryAlias org
[0m07:36:07.736319 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m07:36:07.736319 [error] [MainThread]:            +- 'UnresolvedRelation [poc_test, organizations], [], false
[0m07:36:07.736319 [error] [MainThread]:   
[0m07:36:07.736319 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:36:07.751944 [info ] [MainThread]: 
[0m07:36:07.751944 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:36:07.751944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AB3C1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AF7B56A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AF7B5E20>]}
[0m07:36:07.751944 [debug] [MainThread]: Flushing usage events
[0m07:36:08.724077 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 07:40:34.256591 | c56f29d9-432c-496c-9035-d7c5b0f01b06 ==============================
[0m07:40:34.256591 [info ] [MainThread]: Running with dbt=1.4.6
[0m07:40:34.256591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\dbtgluepoc\\profile', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:40:34.256591 [debug] [MainThread]: Tracking: tracking
[0m07:40:34.279240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC0F25B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC0F2D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC0F2880>]}
[0m07:40:34.296448 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m07:40:34.343346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:40:34.343346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:40:34.343346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c56f29d9-432c-496c-9035-d7c5b0f01b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAC8BA0EB0>]}
[0m07:40:34.359032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c56f29d9-432c-496c-9035-d7c5b0f01b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC14EC70>]}
[0m07:40:34.359032 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 365 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m07:40:34.359032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c56f29d9-432c-496c-9035-d7c5b0f01b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC14EF10>]}
[0m07:40:34.359032 [info ] [MainThread]: 
[0m07:40:34.359032 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:40:34.359032 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt'
[0m07:40:34.359032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:40:34.359032 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:40:34.359032 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m07:40:34.359032 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m07:40:52.206207 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:40:52.206207 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1566a854-5753-46dd-8718-60b2df415b82
[0m07:41:01.998862 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:41:03.254309 [debug] [ThreadPool]: On list_poc_curated_dbt: Close
[0m07:41:03.254309 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:41:03.254309 [debug] [ThreadPool]: Acquiring new glue connection 'list_poc_curated_dbt_poc_curated_dbt'
[0m07:41:03.254309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:03.254309 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m07:41:04.397805 [debug] [ThreadPool]: Glue adapter: Existing session with status : READY
[0m07:41:04.397805 [debug] [ThreadPool]: Glue adapter: GlueConnection _init_session called
[0m07:41:04.397805 [debug] [ThreadPool]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1566a854-5753-46dd-8718-60b2df415b82
[0m07:41:05.862112 [debug] [ThreadPool]: Glue adapter: GlueConnection cursor called
[0m07:41:07.001515 [debug] [ThreadPool]: On list_poc_curated_dbt_poc_curated_dbt: Close
[0m07:41:07.001515 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m07:41:07.001515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c56f29d9-432c-496c-9035-d7c5b0f01b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAC8BA0FA0>]}
[0m07:41:07.001515 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:41:07.001515 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:41:07.001515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:41:07.001515 [info ] [MainThread]: 
[0m07:41:07.001515 [debug] [Thread-1  ]: Began running node model.dbtgluepoc.spark_sql_test
[0m07:41:07.001515 [info ] [Thread-1  ]: 1 of 1 START sql table model poc_curated_dbt.spark_sql_test .................... [RUN]
[0m07:41:07.017267 [debug] [Thread-1  ]: Acquiring new glue connection 'model.dbtgluepoc.spark_sql_test'
[0m07:41:07.017267 [debug] [Thread-1  ]: Began compiling node model.dbtgluepoc.spark_sql_test
[0m07:41:07.017267 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluepoc.spark_sql_test"
[0m07:41:07.017267 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (compile): 2023-05-30 07:41:07.017267 => 2023-05-30 07:41:07.017267
[0m07:41:07.017267 [debug] [Thread-1  ]: Began executing node model.dbtgluepoc.spark_sql_test
[0m07:41:07.017267 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:41:07.017267 [debug] [Thread-1  ]: Glue adapter: GlueConnection connect called
[0m07:41:08.236596 [debug] [Thread-1  ]: Glue adapter: Existing session with status : READY
[0m07:41:08.236596 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m07:41:08.236596 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1566a854-5753-46dd-8718-60b2df415b82
[0m07:41:09.709080 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:41:10.858851 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:41:10.874389 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:41:12.111003 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Table spark_sql_test not found.
[0m07:41:12.112025 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:41:12.112025 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test
[0m07:41:12.113003 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:41:12.113003 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:41:12.113003 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:41:12.113003 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:41:12.113003 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
drop table if exists poc_curated_dbt.spark_sql_test''')
[0m07:41:16.942405 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685432472192, 'CompletedOn': 1685432475915}, 'ResponseMetadata': {'RequestId': 'edfa1494-5d5e-45b0-a7c0-8b75f033eea5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:41:16 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'edfa1494-5d5e-45b0-a7c0-8b75f033eea5'}, 'RetryAttempts': 0}}
[0m07:41:16.942405 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m07:41:16.942405 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m07:41:16.943415 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 6, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\ndrop table if exists poc_curated_dbt.spark_sql_test\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.4.6\\", \\"profile_name\\": \\"dbtgluepoc\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluepoc.spark_sql_test\\"} */\\ndrop table if exists poc_curated_dbt.spark_sql_test", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 6, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1685432472192, 'CompletedOn': 1685432475915}, 'ResponseMetadata': {'RequestId': 'edfa1494-5d5e-45b0-a7c0-8b75f033eea5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:41:16 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '842', 'connection': 'keep-alive', 'x-amzn-requestid': 'edfa1494-5d5e-45b0-a7c0-8b75f033eea5'}, 'RetryAttempts': 0}}
[0m07:41:16.943415 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m07:41:16.943415 [debug] [Thread-1  ]: SQL status: OK in 5 seconds
[0m07:41:16.957121 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:41:16.957121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluepoc.spark_sql_test"
[0m07:41:16.971340 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m07:41:16.971340 [debug] [Thread-1  ]: Using glue connection "model.dbtgluepoc.spark_sql_test"
[0m07:41:16.972340 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: /* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  
[0m07:41:16.972340 [debug] [Thread-1  ]: Glue adapter: GlueConnection cursor called
[0m07:41:16.972340 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m07:41:16.972340 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m07:41:16.972340 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m07:41:16.972340 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  ''')
[0m07:41:19.077871 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 7, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */\n\n  \n    create table poc_curated_dbt.spark_sql_test\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/\'\n\t\n\tas\n\tWITH org as (\nselect \nname, classification\nfrom poc_test.organizations\n)\nselect * from org\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 7, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: poc_test.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_test, organizations], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 723, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 117, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;\n'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias org\n      +- 'Project ['name, 'classification]\n         +- 'UnresolvedRelation [poc_test, organizations], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1685432477062, 'CompletedOn': 1685432477604}, 'ResponseMetadata': {'RequestId': 'a08b12b6-cd36-4fc2-9fee-26f5de85dcb6', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 30 May 2023 07:41:18 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1882', 'connection': 'keep-alive', 'x-amzn-requestid': 'a08b12b6-cd36-4fc2-9fee-26f5de85dcb6'}, 'RetryAttempts': 0}}
[0m07:41:19.078885 [debug] [Thread-1  ]: Glue adapter: status = error
[0m07:41:19.079885 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_test, organizations], [], false

[0m07:41:19.081873 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias org
      +- 'Project ['name, 'classification]
         +- 'UnresolvedRelation [poc_test, organizations], [], false

[0m07:41:19.082915 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */

  
    create table poc_curated_dbt.spark_sql_test
  using PARQUET
	
	
	
	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
	
	as
	WITH org as (
select 
name, classification
from poc_test.organizations
)
select * from org
  
[0m07:41:19.082915 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: ROLLBACK
[0m07:41:19.082915 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m07:41:19.083893 [debug] [Thread-1  ]: On model.dbtgluepoc.spark_sql_test: Close
[0m07:41:19.083893 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m07:41:19.084885 [debug] [Thread-1  ]: Timing info for model.dbtgluepoc.spark_sql_test (execute): 2023-05-30 07:41:07.017267 => 2023-05-30 07:41:19.083893
[0m07:41:19.142156 [debug] [Thread-1  ]: Database Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
  
    
      create table poc_curated_dbt.spark_sql_test
    using PARQUET
  	
  	
  	
  	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
  	
  	as
  	WITH org as (
  select 
  name, classification
  from poc_test.organizations
  )
  select * from org
    '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
  'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias org
        +- 'Project ['name, 'classification]
           +- 'UnresolvedRelation [poc_test, organizations], [], false
  
  compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:41:19.142156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c56f29d9-432c-496c-9035-d7c5b0f01b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC14E040>]}
[0m07:41:19.142156 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model poc_curated_dbt.spark_sql_test ........... [[31mERROR[0m in 12.14s]
[0m07:41:19.143293 [debug] [Thread-1  ]: Finished running node model.dbtgluepoc.spark_sql_test
[0m07:41:19.144720 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m07:41:19.144720 [debug] [MainThread]: On master: ROLLBACK
[0m07:41:19.145796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:19.145796 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m07:41:20.309186 [debug] [MainThread]: Glue adapter: Existing session with status : READY
[0m07:41:20.310435 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m07:41:20.310435 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-1566a854-5753-46dd-8718-60b2df415b82
[0m07:41:21.774354 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:41:21.774853 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m07:41:21.774853 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m07:41:21.775528 [debug] [MainThread]: On master: ROLLBACK
[0m07:41:21.775528 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m07:41:21.775528 [debug] [MainThread]: On master: Close
[0m07:41:21.775528 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m07:41:21.775528 [debug] [MainThread]: Glue adapter: cleanup called
[0m07:41:22.241064 [info ] [MainThread]: 
[0m07:41:22.241995 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.88 seconds (47.88s).
[0m07:41:22.243326 [debug] [MainThread]: Command end result
[0m07:41:22.251747 [info ] [MainThread]: 
[0m07:41:22.251747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:41:22.252747 [info ] [MainThread]: 
[0m07:41:22.252747 [error] [MainThread]: [33mDatabase Error in model spark_sql_test (models\gold_metrics\spark_sql_test.sql)[0m
[0m07:41:22.253784 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.4.6", "profile_name": "dbtgluepoc", "target_name": "dev", "node_id": "model.dbtgluepoc.spark_sql_test"} */
[0m07:41:22.253784 [error] [MainThread]:   
[0m07:41:22.254749 [error] [MainThread]:     
[0m07:41:22.254749 [error] [MainThread]:       create table poc_curated_dbt.spark_sql_test
[0m07:41:22.255749 [error] [MainThread]:     using PARQUET
[0m07:41:22.255749 [error] [MainThread]:   	
[0m07:41:22.255749 [error] [MainThread]:   	
[0m07:41:22.256748 [error] [MainThread]:   	
[0m07:41:22.257196 [error] [MainThread]:   	LOCATION 's3://poc-curated-legislator-dbt//poc_curated_dbt/spark_sql_test/'
[0m07:41:22.257516 [error] [MainThread]:   	
[0m07:41:22.257516 [error] [MainThread]:   	as
[0m07:41:22.257516 [error] [MainThread]:   	WITH org as (
[0m07:41:22.258518 [error] [MainThread]:   select 
[0m07:41:22.258518 [error] [MainThread]:   name, classification
[0m07:41:22.258518 [error] [MainThread]:   from poc_test.organizations
[0m07:41:22.259518 [error] [MainThread]:   )
[0m07:41:22.259518 [error] [MainThread]:   select * from org
[0m07:41:22.260126 [error] [MainThread]:     '''), AnalysisException: Table or view not found: poc_test.organizations; line 15 pos 5;
[0m07:41:22.260126 [error] [MainThread]:   'CreateTable `poc_curated_dbt`.`spark_sql_test`, ErrorIfExists
[0m07:41:22.260126 [error] [MainThread]:   +- 'Project [*]
[0m07:41:22.261128 [error] [MainThread]:      +- 'SubqueryAlias org
[0m07:41:22.261128 [error] [MainThread]:         +- 'Project ['name, 'classification]
[0m07:41:22.261128 [error] [MainThread]:            +- 'UnresolvedRelation [poc_test, organizations], [], false
[0m07:41:22.262127 [error] [MainThread]:   
[0m07:41:22.262127 [error] [MainThread]:   compiled Code at target\run\dbtgluepoc\models\gold_metrics\spark_sql_test.sql
[0m07:41:22.262127 [info ] [MainThread]: 
[0m07:41:22.263128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:41:22.263128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC9CE100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC9DFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BACC9B36A0>]}
[0m07:41:22.263128 [debug] [MainThread]: Flushing usage events
[0m07:41:23.149325 [debug] [MainThread]: Glue adapter: cleanup called


============================== 2023-05-30 08:18:38.896749 | 78752c68-984b-4631-a460-f91fdab6ec6c ==============================
[0m08:18:38.896749 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:18:38.896749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\003JZ8744\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m08:18:38.896749 [debug] [MainThread]: Tracking: tracking
[0m08:18:38.943618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A901C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A993760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A9932E0>]}
[0m08:18:38.950352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A901C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A993880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3A993430>]}
[0m08:18:38.950352 [debug] [MainThread]: Flushing usage events
